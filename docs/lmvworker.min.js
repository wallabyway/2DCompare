// LMV v6.1.0
//
// Copyright 2018 Autodesk, Inc.
// All rights reserved.
// 
// This computer source code and related instructions and comments are the
// unpublished confidential and proprietary information of Autodesk, Inc.
// and are protected under Federal copyright and state trade secret law.
// They may not be disclosed to, copied or used by any third party without
// the prior written consent of Autodesk, Inc.
// 
// Autodesk Forge Viewer Usage Limitations:
// 
// The Autodesk Forge viewer can only be used to view files generated by
// Autodesk Forge services. The Autodesk Forge Viewer JavaScript must be
// delivered from an Autodesk hosted URL.
var LMV=function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){"use strict";function d(a){self.postMessage({debug:1,message:a})}var e=c(1);self.addEventListener("message",function(a){var b=a.data;b.worker=self,e.workerMain.dispatch(b)},!1),self.raiseError=function(a,b,c){self.postMessage({error:{code:a,msg:b,args:c}})},self.debug=d},function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0}),b.workerMain=b.WorkerMain=void 0;var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=c(2),g=c(5),h=b.WorkerMain=function(){function a(){d(this,a),this._workers={}}return e(a,[{key:"dispatch",value:function(a){if(a.hasOwnProperty("operation")){a.endpoint&&g.endpoint.setEndpointAndApi(a.endpoint,a.api);var b=this._workers[a.operation];if(b){if(a.basePath="",a.url){var c=a.url.lastIndexOf("/");-1!=c&&(a.basePath=a.url.substr(0,c+1))}a.raiseError=function(){a.worker.raiseError.apply(a.worker,arguments)},a.onFailureCallback=f.ViewingService.defaultFailureCallback.bind(a),b.doOperation(a)}}}},{key:"register",value:function(a,b){this._workers[a]=b}},{key:"unregister",value:function(a){delete this._workers[a]}}]),a}(),i=b.workerMain=new h;c(25).register(i),c(45).register(i),c(49).register(i),c(52).register(i),c(56).register(i),c(57).register(i),c(60).register(i),c(64).register(i),c(69).register(i),c(71).register(i),c(73).register(i),c(76).register(i)},function(a,b,c){"use strict";function d(a){var b=a.split("/");if(0==b.length)return a;for(var c=[],d=0;d<b.length;++d){var e=b[d];"."!==e&&(".."===e&&c.length?c.pop():c.push(e))}return 0==c.length?"":c.join("/")}function e(a){if(-1!==a.indexOf("://")||0===a.indexOf("urn:"))return a;if("undefined"==typeof window)return a;var b=window.location.pathname,c=b.lastIndexOf("/");return b=b.substr(0,c+1),window.location.protocol+"//"+window.location.host+b+a}function f(a,b){for(var c=a.length-b,d=new ArrayBuffer(c),e=new Uint8Array(d,0),f=0,g=b;f<c;f++,g++)e[f]=255&a.charCodeAt(g);return e}function g(a,b){return-1===b.indexOf("file://")&&(-1!==b.indexOf("://")||(!!a||void 0))}function h(a,b){b.hasOwnProperty("asynchronous")?b.asynchronous||i.logger.warn("LMV: Sync XHR used. Performance warning."):b.asynchronous=!0,b.hasOwnProperty("responseType")||(b.responseType="arraybuffer"),b.hasOwnProperty("withCredentials")||(b.withCredentials=!!a.auth),b.headers=a.headers,b.queryParams=a.queryParams,b.endpoint=a.endpoint}Object.defineProperty(b,"__esModule",{value:!0}),b.ViewingService=void 0,b.pathToURL=e,b.textToArrayBuffer=f;var i=c(3),j=c(6),k=c(7),l=c(5),m=c(4),n=c(8),o=b.ViewingService={},p=!1;o.simplifyPath=d,o.OSS_PREFIX="urn:adsk.objects:os.object:",o.generateUrl=function(a,b,c){if(c=c||"",(0,m.isNodeJS)()&&!g(a,c))return c;c=d(c);var e=c.indexOf("urn:"),f=c.indexOf("?");if(c=-1!=e?-1!==f?c.slice(0,e)+encodeURIComponent(c.slice(e,f))+c.slice(f):c.slice(0,e)+encodeURIComponent(c.slice(e)):encodeURI(c),!b||0!==decodeURIComponent(c).indexOf("urn:"))return g(null,c)?c:a+c;switch("items"!==b&&(c=c.substr(6)),b){case"items":return l.endpoint.getItemApi(a,c);case"bubbles":return l.endpoint.getManifestApi(a,c);case"thumbnails":return l.endpoint.getThumbnailApi(a,c)}},(0,m.isNodeJS)()?function(){function a(a,b,c,f){function g(a){if("json"===f.responseType)try{return JSON.parse(a.toString("utf8"))}catch(a){c(a)}return a}0===a.indexOf("file://")&&(a=a.substr(7)),d.readFile(a,function(d,h){d?c(0,0,{httpStatusText:d,url:a}):31===h[0]&&139===h[1]?e.gunzip(h,null,function(d,e){d?c(0,0,{httpStatusText:d,url:a}):(e=g(e),f.ondata&&f.ondata(e),b(e))}):(h=g(h),f.ondata&&f.ondata(h),b(h))})}function b(a,b){return"gzip"===a.headers["content-encoding"]||(!!b.endsWith(".json.gz")||(!!b.endsWith("FragmentList.pack")||(!!b.endsWith("LightList.bin")||(!!b.endsWith("CameraList.bin")||(!!b.endsWith("CameraDefinitions.bin")||!!b.endsWith("LightDefinitions.bin"))))))}var d=c(24),e=c(24),f=c(24),h=c(24),k=c(24),l=new f.Agent({maxSockets:10});o.rawGet=function(c,d,m,n,p,q){if(q=q||{},m=o.generateUrl(c,d,m),!g(c,m))return void a(m,n,p,q);if(q.queryParams){var r=-1===m.indexOf("?")?"?":"&";m=m+r+q.queryParams}var s=k.parse(m),t={host:s.hostname,port:s.port,method:q.method||"GET",path:s.path,headers:{},retryCount:0};if(t.host.endsWith(".api.autodesk.com")&&(t.path.startsWith("/derivativeservice")||t.path.startsWith("/modelderivative"))&&(t.agent=l),q.headers)for(var u in q.headers)t.headers[u]=q.headers[u];t.headers["accept-encoding"]||(t.headers["accept-encoding"]="gzip, deflate"),q.range&&(t.headers.Range="bytes="+q.range.min+"-"+q.range.max),(q.ondata||q.onprogress)&&(q.responseType="arraybuffer");var v=("https:"===s.protocol?f:h).request(t,function(a){var c=!(a.statusCode>=200&&a.statusCode<400),d=a;c||!b(a,s.pathname)||q.skipDecompress||(d=a.pipe(e.createGunzip())),"json"!==q.responseType&&"text"!==q.responseType&&q.responseType||d.setEncoding("utf8");var f,g=[];d.on("data",function(a){if(q.onprogress)return f=f?Buffer.concat([f,a]):a,void q.onprogress(f);g.push(a),q.ondata&&q.ondata(a)}),d.on("end",function(){if(a.statusCode>=200&&a.statusCode<400){if("json"===q.responseType){var b=JSON.parse(g.join(""));return void n(b)}if("text"===q.responseType||""===q.responseType){var c=g.join("");return void n(c)}var d=q.onprogress?f:Buffer.concat(g);if(!q.skipDecompress&&31===d[0]&&139===d[1]){i.logger.warn("An LMV resource ("+m+") was double compressed, or Content-Encoding header missing");try{d=e.gunzipSync(d)}catch(a){p(j.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:m,exception:a.toString(),stack:a.stack})}}n(d)}else p&&p(a.statusCode,a.statusMessage,{url:m})})});v.on("error",function(a){p&&p(a.code,a.message,{url:m})}),q.postData&&v.write(q.postData),v.end()}}():o.rawGet=function(a,b,c,d,e,g){function h(a){e&&e(r.status,r.statusText,{url:c})}function l(a){if("json"===g.responseType)try{if(a instanceof Uint8Array)return(0,k.blobToJson)(a);if("string"==typeof a)return JSON.parse(a)}catch(a){}return a}function m(a){if(200===r.status||206===r.status)if(r.response&&r.response instanceof ArrayBuffer){var b=new Uint8Array(r.response);if(!g.skipDecompress&&31===b[0]&&139===b[1]){p||(p=!0,i.logger.warn("An LMV resource ("+c+") was not uncompressed by the browser. This hurts performance. Check the Content-Encoding header returned by the server and check whether you're getting double-compressed streams. The warning prints only once but it's likely the problem affects multiple resources."));try{b=n.ungzip(b)}catch(a){e(j.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:c,exception:a.toString(),stack:a.stack})}}d&&d(l(b))}else{var f=r.response;f||g.responseType&&"text"!==g.responseType||(f=r.responseText),d&&d(l(f))}else h(a)}if(g=g||{},c=o.generateUrl(a,b,c),g.queryParams){var q=-1===c.indexOf("?")?"?":"&";c=c+q+g.queryParams}var r=new XMLHttpRequest;try{var s=!g.hasOwnProperty("asynchronous")||g.asynchronous;if(r.open(g.method||(g.noBody?"HEAD":"GET"),c,s),g.hasOwnProperty("responseType")&&(r.responseType=g.responseType),r.withCredentials=!0,g.hasOwnProperty("withCredentials")&&(r.withCredentials=g.withCredentials),g.range&&r.setRequestHeader("Range","bytes="+g.range.min+"-"+g.range.max),g.headers)for(var t in g.headers)r.setRequestHeader(t,g.headers[t]),"authorization"===t.toLocaleLowerCase()&&(r.withCredentials=!1);s&&(r.onload=m,r.onerror=h,r.ontimeout=h,(g.ondata||g.onprogress)&&(r.overrideMimeType("text/plain; charset=x-user-defined"),g._dlProgress={streamOffset:0},r.onreadystatechange=function(){if(r.readyState>2&&200===r.status)if(g.ondata){var a=r.responseText;if(g._dlProgress.streamOffset>=a.length)return;var b=f(a,g._dlProgress.streamOffset);g._dlProgress.streamOffset=a.length,g.ondata(b)}else g.onprogress&&g.onprogress(r.responseText)})),r.send(g.postData),s||m()}catch(a){e(r.status,r.statusText,{url:c,exception:a})}},o.defaultFailureCallback=function(a,b,c){403==a?this.raiseError(j.ErrorCodes.NETWORK_ACCESS_DENIED,"Access denied to remote resource",{url:c.url,httpStatus:a,httpStatusText:b}):404==a?this.raiseError(j.ErrorCodes.NETWORK_FILE_NOT_FOUND,"Remote resource not found",{url:c.url,httpStatus:a,httpStatusText:b}):a>=500&&a<600?this.raiseError(j.ErrorCodes.NETWORK_SERVER_ERROR,"Server error when accessing resource",{url:c.url,httpStatus:a,httpStatusText:b}):c.exception?this.raiseError(j.ErrorCodes.NETWORK_FAILURE,"Network failure",{url:c.url,exception:c.exception.toString(),stack:c.exception.stack}):this.raiseError(j.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE,"Unhandled response code from server",{url:c.url,httpStatus:a,httpStatusText:b,data:c})},o.getItem=function(a,b,c,d,e){e=e||{},h(a,e),o.rawGet(a.endpoint,"items",b,c,d,e)},o.getManifest=function(a,b,c,d,e){e=e||{},e.hasOwnProperty("responseType")||(e.responseType="json"),h(a,e),o.rawGet(a.endpoint,"bubbles",b,c,d,e)},o.getThumbnail=function(a,b,c,d,e){e=e||{},h(a,e);var f=e.queryParams||"",g=[];if(-1===f.indexOf("guid=")&&g.push("guid="+encodeURIComponent(e.guid)),-1===f.indexOf("role=")){var i=e.role||"rendered";g.push("role="+i)}if(-1===f.indexOf("width=")){var j=e.size||400;g.push("width="+j)}if(-1===f.indexOf("height=")){var j=e.size||400;g.push("height="+j)}-1===f.indexOf("acmsession=")&&e.acmsession&&g.push("acmsession="+e.acmsession);var k=g.join("&");e.queryParams?e.queryParams=e.queryParams+"&"+k:e.queryParams=k,o.rawGet(a.endpoint,"thumbnails",b,c,d,e)},o.getACMSession=function(a,b,c,d){var e,f={};for(var g in b)"oauth2AccessToken"===g?e=b[g]:-1!==g.indexOf("x-ads-acm")&&(f[g]=b[g]);f.application="autodesk";var h=new XMLHttpRequest;h.open("POST",a+"/oss-ext/v2/acmsessions",!0),h.setRequestHeader("Content-Type","application/json"),h.setRequestHeader("Authorization","Bearer "+e),h.responseType="json",h.onload=function(){if(200===h.status&&h.response){var a="string"==typeof h.response?JSON.parse(h.response):h.response;a&&a.acmsession?c(a.acmsession):d(h.status,"Can't get acm session from response.")}else d(h.status)},h.onerror=d,h.ontimeout=d,h.send(JSON.stringify(f)),delete f.application}},function(a,b,c){"use strict";function d(){this.adp=null,this.runtimeStats={},this.level=-1,this.setLevel(j.ERROR)}function e(){return"undefined"!=typeof window?encodeURI(window.location.href):""}function f(a){b.logger=k=a}Object.defineProperty(b,"__esModule",{value:!0}),b.logger=b.LogLevels=void 0,b.Logger=d,b.setLogger=f;var g=c(4),h=c(5),i=(0,g.getGlobal)(),j=b.LogLevels={DEBUG:5,LOG:4,INFO:3,WARNING:2,ERROR:1,NONE:0};d.prototype.initialize=function(a){if(a.eventCallback&&(this.callback=a.eventCallback),this.sessionId=a.sessionId,!this.sessionId){var b=Date.now()+"";this.sessionId=parseFloat((1e4*Math.random()|0)+""+b.substring(4))}var c=a.logLevel||a.loglevel;"number"==typeof c&&this.level!==c&&this.setLevel(c),this.environmentInfo={touch:(0,g.isTouchDevice)(),env:(0,h.getEnv)(),referer:e(),version:i.LMV_VIEWER_VERSION,patch:i.LMV_VIEWER_PATCH,build_type:i.LMV_BUILD_TYPE};var d={category:"viewer_start",touch:this.environmentInfo.touch,env:this.environmentInfo.env,referer:this.environmentInfo.referer,version:this.environmentInfo.version,patch:this.environmentInfo.patch,build_type:this.environmentInfo.build_type};this.track(d);var f=this;this.interval=setInterval(function(){f.reportRuntimeStats()},6e4)},d.prototype.shutdown=function(){clearInterval(this.interval),this.interval=void 0},d.prototype.track=function(a){if(this.updateRuntimeStats(a),!(0,h.isOffline)()&&this.sessionId){a.timestamp=Date.now(),a.sessionId=this.sessionId;var b=this.logToADP(a);this.callback&&this.callback(a,{adp:b})}},d.prototype.logToADP=function(a){if(!this.adp)return!1;var b="",c="";switch(a.category){case"tool_changed":case"pref_changed":b="CLICK_OPERATION",c=a.category+"/"+a.name;break;case"screen_mode":b="CLICK_OPERATION",c="pref_changed/"+a.category;break;case"metadata_load_stats":b="DOCUMENT_START",c="stats",a.full_url=e();break;case"model_load_stats":b="DOCUMENT_FULL",c="stats";break;case"tool_used":b="BACKGROUND_CALL",c=a.category+"/"+a.name;break;case"settingOptionsStatus":b="BACKGROUND_CALL",c=a.category+"/"+a.list;break;case"node_selected":case"search_node":b="CLICK_OPERATION",c=a.category+"/"+a.name;break;case"loaded_extensions":b="BACKGROUND_CALL",c=a.category;break;case"error":b="BACKGROUND_CALL",c="error"}return!!b&&(this.adp.trackEvent(b,{operation:{id:a.sessionId,type:c,stage:"",status:"C",meta:a}}),!0)},d.prototype.updateRuntimeStats=function(a){if(a.hasOwnProperty("aggregate"))switch(a.aggregate){case"count":this.runtimeStats[a.name]>0?this.runtimeStats[a.name]++:this.runtimeStats[a.name]=1,this.runtimeStats._nonempty=!0;break;case"last":this.runtimeStats[a.name]=a.value,this.runtimeStats._nonempty=!0;break;default:this.warn("unknown log aggregate type")}},d.prototype.reportRuntimeStats=function(){this.runtimeStats._nonempty&&(delete this.runtimeStats._nonempty,this.adp&&this.adp.trackEvent("BACKGROUND_CALL",{operation:{id:this.sessionId,type:"stats",stage:"",status:"C",meta:this.runtimeStats}}),this.runtimeStats.category="misc_stats",this.track(this.runtimeStats),this.runtimeStats={})},d.prototype.setLevel=function(a){if(this.level!==a){this.level=a;var b=function(){},c=j,d=this,e=function(){if(d.callback){var a=Array.prototype.slice.call(arguments).join(" ");d.callback({category:"error",message:a},{adp:!1})}console.error.apply(console,arguments)};this.debug=a>=c.DEBUG?console.log.bind(console):b,this.log=a>=c.LOG?console.log.bind(console):b,this.info=a>=c.INFO?console.info.bind(console):b,this.warn=a>=c.WARNING?console.warn.bind(console):b,this.error=a>=c.ERROR?e:b}};var k=b.logger=new d},function(a,b){(function(a){"use strict";function c(){return"undefined"!=typeof window&&null!==window?window:"undefined"!=typeof self&&null!==self?self:a}function d(a,b){a.requestFullscreen?a.requestFullscreen(b):a.mozRequestFullScreen?a.mozRequestFullScreen(b):a.webkitRequestFullscreen?a.webkitRequestFullscreen(b):a.msRequestFullscreen&&a.msRequestFullscreen(b)}function e(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}function f(){return"webkitIsFullScreen"in document?!!document.webkitIsFullScreen:"fullscreenElement"in document?!!document.fullscreenElement:"mozFullScreenElement"in document?!!document.mozFullScreenElement:"msFullscreenElement"in document?!!document.msFullscreenElement:!!document.querySelector(".viewer-fill-browser")}function g(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function h(a){return a.requestFullscreen||a.mozRequestFullScreen||a.webkitRequestFullscreen||a.msRequestFullscreen}function i(a){a=a||navigator.userAgent;var b=a.match(/Android\s([0-9\.]*)/);return!!b&&b[1]}function j(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0)}function k(){return!!x&&/ip(ad|hone|od)/.test(navigator.userAgent.toLowerCase())}function l(){return!!x&&-1!==navigator.userAgent.toLowerCase().indexOf("android")}function m(){return!!x&&(k()||l())}function n(){if(!x)return!1;var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("safari")&&-1===a.indexOf("chrome")}function o(){return!!x&&-1!==navigator.userAgent.toLowerCase().indexOf("firefox")}function p(){return!!x&&-1!==navigator.userAgent.toLowerCase().indexOf("chrome")}function q(){return!!x&&-1!==navigator.userAgent.toLowerCase().indexOf("mac os")}function r(){if(!x)return!1;var a=navigator.userAgent.toLowerCase();return-1!==a.indexOf("win32")||-1!==a.indexOf("windows")}function s(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function t(a){var b=window.hasOwnProperty("pageXOffset")?window.pageXOffset:document.documentElement.scrollLeft,c=window.hasOwnProperty("pageYOffset")?window.pageYOffset:document.documentElement.scrollTop,d=void 0===a.pageX?a.changedTouches[0].pageX:a.pageX,e=void 0===a.pageY?a.changedTouches[0].pageY:a.pageY,f=document.elementFromPoint(d-b,e-c);return!f||"CANVAS"!==f.nodeName||(!!f.getAttribute(!0)||(a.preventDefault(),!1))}function u(){m()&&n()&&(document.documentElement.addEventListener("touchstart",t,!0),document.documentElement.addEventListener("touchmove",t,!0),document.documentElement.addEventListener("touchcanceled",t,!0),document.documentElement.addEventListener("touchend",t,!0))}function v(){m()&&n()&&(document.documentElement.removeEventListener("touchstart",t,!0),document.documentElement.removeEventListener("touchmove",t,!0),document.documentElement.removeEventListener("touchcanceled",t,!0),document.documentElement.removeEventListener("touchend",t,!0))}function w(a){a.target.className.indexOf("fullscreen")>-1||a.target.className.indexOf("webvr")>-1||(a.preventDefault(),a.stopPropagation(),a.target.click())}Object.defineProperty(b,"__esModule",{value:!0}),b.getGlobal=c,b.launchFullscreen=d,b.exitFullscreen=e,b.inFullscreen=f,b.fullscreenElement=g,b.isFullscreenAvailable=h,b.getAndroidVersion=i,b.isTouchDevice=j,b.isIOSDevice=k,b.isAndroidDevice=l,b.isMobileDevice=m,b.isSafari=n,b.isFirefox=o,b.isChrome=p,b.isMac=q,b.isWindows=r,b.ObjectAssign=s,b.disableDocumentTouchSafari=u,b.enableDocumentTouchSafari=v,b.touchStartToClick=w;var x=(b.isNodeJS=function(){return"undefined"==typeof navigator},b.isBrowser="undefined"!=typeof navigator),y=b.isIE11=x&&!!navigator.userAgent.match(/Edge|Trident\/7\./);"undefined"!=typeof window&&y&&function(){function a(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}a.prototype=window.CustomEvent.prototype,window.CustomEvent=a}(),ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(a,b){if(!b||b>this.byteLength?b=this.byteLength:b<0&&(b=this.byteLength+b)<0&&(b=0),a<0&&(a=this.byteLength+a)<0&&(a=0),b<=a)return new ArrayBuffer;for(var c=b-a,d=new Uint8Array(this,a,c),e=new Uint8Array(c),f=0;f<c;f++)e[f]=d[f];return e.buffer}),function(){Math.log2=Math.log2||function(a){return Math.log(a)/Math.LN2}}(),"undefined"!=typeof window&&(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder),function(){var a=c();a.performance||(a.performance=Date)}(),Number.isInteger=Number.isInteger||function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a},String.prototype.repeat=String.prototype.repeat||function(a){if(a<1)return"";for(var b="",c=this.valueOf();a>1;)1&a&&(b+=c),a>>=1,c+=c;return b+c},Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{enumerable:!1,value:function(a,b,c){b=void 0===b?0:b,c=void 0===c?this.length:c;for(var d=b;d<c;++d)this[d]=a}}),Int32Array.prototype.lastIndexOf=Int32Array.prototype.lastIndexOf||function(a,b){return Array.prototype.lastIndexOf.call(this,a,b)},Array.prototype.find||Object.defineProperty(Array.prototype,"find",{enumerable:!1,value:function(a,b){for(var c=this.length,d=0;d<c;++d){var e=this[d];if(a.call(b,e,d,this))return e}}}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(a,b){if(null==a)throw new TypeError("Cannot convert undefined or null to object");for(var c=Object(a),d=1;d<arguments.length;d++){var e=arguments[d];if(null!=e)for(var f in e)Object.prototype.hasOwnProperty.call(e,f)&&(c[f]=e[f])}return c},writable:!0,configurable:!0}),"undefined"==typeof window||!y&&!k()||HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(a,b,c){var d=this;setTimeout(function(){for(var e=atob(d.toDataURL(b,c).split(",")[1]),f=e.length,g=new Uint8Array(f),h=0;h<f;h++)g[h]=e.charCodeAt(h);a(new Blob([g],{type:b||"image/png"}))})}})}).call(b,function(){return this}())},function(a,b,c){"use strict";function d(){return q}function e(a){q=a}function f(){return r}function g(a){r=a}function h(a){s=a}function i(){return s}Object.defineProperty(b,"__esModule",{value:!0}),b.initLoadContext=b.endpoint=void 0,b.getEnv=d,b.setEnv=e,b.isOffline=f,b.setOffline=g,b.setOfflineResourcePrefix=h,b.getOfflineResourcePrefix=i;var j=c(4),k={},l=null;k.ENDPOINT_API_DERIVATIVE_SERVICE_V2="derivativeV2",k.ENDPOINT_API_MODEL_DERIVATIVE_V2="modelDerivativeV2",k.ENDPOINT_API_FLUENT="fluent";var m={derivativeV2:{baseURL:"/derivativeservice/v2",itemURL:"/derivativeservice/v2/derivatives/:derivativeurn",manifestURL:"/derivativeservice/v2/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/thumbnails/:urn"},derivativeV2_EU:{baseURL:"/derivativeservice/v2/regions/eu",itemURL:"/derivativeservice/v2/regions/eu/derivatives/:derivativeurn",manifestURL:"/derivativeservice/v2/regions/eu/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/regions/eu/thumbnails/:urn"},modelDerivativeV2:{baseURL:"/modelderivative/v2/",itemURL:"/modelderivative/v2/designdata/:urn/manifest/:derivativeurn",manifestURL:"/modelderivative/v2/designdata/:urn/manifest",thumbnailsURL:"/modelderivative/v2/designdata/:urn/thumbnail"},fluent:{baseURL:"/modeldata",itemURL:"/modeldata/file/:derivativeurn",manifestURL:"/modeldata/manifest/:urn",thumbnailsURL:"/derivativeservice/v2/thumbnails/:urn",cdnURL:"/cdn",cdnWS:"/cdnws",cdnRedirectURL:"/cdnurl"}},n="",o=k.ENDPOINT_API_DERIVATIVE_SERVICE_V2,p=!1;k.HTTP_REQUEST_HEADERS={},k.setEndpointAndApi=function(a,b){n=a,b&&(o=b)},k.getEndpointAndApi=function(){return n+m[o].baseURL},k.getApiEndpoint=function(){return n},k.getApiFlavor=function(){return o},k.getCdnUrl=function(){return l||(n?n+m[o].cdnURL:void 0)},k.getCdnWebSocketEndpoint=function(){return n+(m[o].cdnWS||"")},k.setCdnUrl=function(a){l=a},k.getCdnRedirectUrl=function(){var a=m[o].cdnRedirectURL;return a?n+a:null},k.getManifestApi=function(a,b,c){var d=a||n;return c=c||o,d+=m[c].manifestURL,b=b||"",d=d.replace(":urn",b)},k.getItemApi=function(a,b,c){var d=c||o,e=(a||n)+m[d].itemURL;b=b||"";var f=decodeURIComponent(b);if(-1!==e.indexOf(":urn")){var g=f.split("/"),h=g[0]||"";h=h.split(":"),h=h[h.length-1]||"",e=e.replace(":urn",h)}return d===k.ENDPOINT_API_MODEL_DERIVATIVE_V2&&(b=encodeURIComponent(f)),e=e.replace(":derivativeurn",b)},k.getThumbnailApi=function(a,b,c){return((a||n)+m[c||o].thumbnailsURL).replace(":urn",b||"")},k.getUseCredentials=function(){return p},k.pathRequiresCredentials=function(a){var b=-1===a.indexOf("://"),c=0===a.indexOf(this.getEndpointAndApi()),d=0===a.indexOf(n);return b||c||d},k.getDomainParam=function(){return this.getUseCredentials()&&!(0,j.isNodeJS)()?"domain="+encodeURIComponent(window.location.origin):""},k.setUseCredentials=function(a){p=a},k.initLoadContext=function(a){a=a||{},a.auth=this.getUseCredentials(),a.endpoint||(a.endpoint=this.getApiEndpoint()),a.api||(a.api=this.getApiFlavor()),a.headers||(a.headers={});for(var b in this.HTTP_REQUEST_HEADERS)a.headers[b]=this.HTTP_REQUEST_HEADERS[b];var c=this.getDomainParam();return c&&(a.queryParams?a.queryParams+="&"+c:a.queryParams=c),a.otg_cdn=l||this.getCdnUrl(),a.otg_ws=this.getCdnWebSocketEndpoint(),a};var q,r=!1,s="";b.endpoint=k,b.initLoadContext=k.initLoadContext.bind(k)},function(a,b){"use strict";function c(a){return"ErrorCode:"+a+"."}function d(a){return 403===a||401===a?e.NETWORK_ACCESS_DENIED:404===a?e.NETWORK_FILE_NOT_FOUND:a>=500?e.NETWORK_SERVER_ERROR:e.NETWORK_UNHANDLED_RESPONSE_CODE}Object.defineProperty(b,"__esModule",{value:!0}),b.errorCodeString=c,b.getErrorCode=d;var e=b.ErrorCodes={UNKNOWN_FAILURE:1,BAD_DATA:2,NETWORK_FAILURE:3,NETWORK_ACCESS_DENIED:4,NETWORK_FILE_NOT_FOUND:5,NETWORK_SERVER_ERROR:6,NETWORK_UNHANDLED_RESPONSE_CODE:7,BROWSER_WEBGL_NOT_SUPPORTED:8,BAD_DATA_NO_VIEWABLE_CONTENT:9,BROWSER_WEBGL_DISABLED:10,BAD_DATA_MODEL_IS_EMPTY:11,RTC_ERROR:12,UNSUPORTED_FILE_EXTENSION:13,VIEWER_INTERNAL_ERROR:14,WEBGL_LOST_CONTEXT:15}},function(a,b){"use strict";function c(a,b,c){var d,e,f,g,h,i;for(d="",f=c,e=0;e<f;)switch((g=a[b+e++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:d+=String.fromCharCode(g);break;case 12:case 13:h=a[b+e++],d+=String.fromCharCode((31&g)<<6|63&h);break;case 14:h=a[b+e++],i=a[b+e++],d+=String.fromCharCode((15&g)<<12|(63&h)<<6|(63&i)<<0)}return d}function d(a,b,c){var d,e,f,g,h,i,j,k;for(d="",h=[],f=c,i=0,e=0;e<f;){switch((g=a[b+e++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:h.push(String.fromCharCode(g));break;case 12:case 13:j=a[b+e++],h.push(String.fromCharCode((31&g)<<6|63&j));break;case 14:j=a[b+e++],k=a[b+e++],h.push(String.fromCharCode((15&g)<<12|(63&j)<<6|(63&k)<<0))}(++i>=32768||e>=f)&&(d+=h.join(""),h.length=0,i=0)}return d}function e(a,b,c){var d,e,f,g=c||0;if(e=a.length,b)for(d=0;d<e;d++)f=a.charCodeAt(d),f>=1&&f<=127?b[g++]=f:f>2047?(b[g++]=224|f>>12&15,b[g++]=128|f>>6&63,b[g++]=128|f>>0&63):(b[g++]=192|f>>6&31,b[g++]=128|f>>0&63);else for(d=0;d<e;d++)f=a.charCodeAt(d),f>=1&&f<=127?g++:g+=f>2047?3:2;return g-(c||0)}function f(a,b,e){if(void 0===b&&(b=0),void 0===e&&(e=a.length),m)return e>n?d(a,b,e):c(a,b,e);for(var f="",g=b,h=b+e;g<h;g++)f+=String.fromCharCode(a[g]);return decodeURIComponent(escape(f))}function g(a){var b=f(a,0,a.length);return JSON.parse(b)}function h(a,b){if(void 0===b)return"";for(var c=b;c<a.length-1;){var d=a[c];if(44==d&&(10==a[c+1]||13==a[c+1]))break;if(10==d||13==d)break;c++}var e=f(a,b,c-b);try{return JSON.parse(e)}catch(a){return console.error("Error parsing property blob to JSON : "+e),e}}function i(a,b){var c=0,d=b;for(34==a[d]&&d++;d<a.length-1;){var e=a[d];if(44==e&&(10==a[d+1]||13==a[d+1]))break;if(10==e||13==e||34==e)break;e>=48&&e<=57&&(c=10*c+(e-48)),d++}return c}function j(a,b){for(var c=0,d=0,e=a.length;d<e;d++)44==a[d]&&c++;c++;var f=new Uint32Array(c+(b?1:0));d=0;for(var g=a.length;91!=a[d]&&d<g;)d++;if(d==a.length)return null;d++;var h=!1;c=0;for(var i=0;d<g;){var j=a[d];j>=48&&j<=57?(i=10*i+(j-48),h=!0):44==j||93==j?h&&(f[c++]=i,h=!1,i=0):(h=!1,i=0),d++}return f}function k(a){for(var b=0,c=a.length-1,d=0;d<c;d++)44!=a[d]||10!=a[d+1]&&13!=a[d+1]||b++;if(!b)return null;b++;var e=new Uint32Array(b);for(d=0,b=0;91!=a[d]&&d<c;)d++;d++,e[b++]=d;for(var f=!1;d<c;)10==a[d]||13==a[d]?f=!0:f&&(f=!1,e[b++]=d),d++;return e}function l(a,b,c){for(var d=[],e=0;e<c;e++){var f=a[b+e],g=o[f];d.push(g)}return d.join("")}Object.defineProperty(b,"__esModule",{value:!0}),b.utf8BlobToStr=c,b.safeUtf8BlobToStr=d,b.utf16to8=e,b.utf8ArrayToString=f,b.blobToJson=g,b.subBlobToJson=h,b.subBlobToJsonInt=i,b.parseIntArray=j,b.findValueOffsets=k,b.getHexString=l;for(var m=!0,n=1048576,o=new Array(256),p=0;p<256;p++){var q=p.toString(16);1===q.length&&(q="0"+q),o[p]=q}},function(a,b,c){"use strict";var d=c(9).assign,e=c(10),f=c(18),g=c(22),h={};d(h,e,f,g),a.exports=h},function(a,b){"use strict";function c(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var d="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;b.assign=function(a){for(var b=Array.prototype.slice.call(arguments,1);b.length;){var d=b.shift();if(d){if("object"!=typeof d)throw new TypeError(d+"must be non-object");for(var e in d)c(d,e)&&(a[e]=d[e])}}return a},b.shrinkBuf=function(a,b){return a.length===b?a:a.subarray?a.subarray(0,b):(a.length=b,a)};var e={arraySet:function(a,b,c,d,e){if(b.subarray&&a.subarray)return void a.set(b.subarray(c,c+d),e);for(var f=0;f<d;f++)a[e+f]=b[c+f]},flattenChunks:function(a){var b,c,d,e,f,g;for(d=0,b=0,c=a.length;b<c;b++)d+=a[b].length;for(g=new Uint8Array(d),e=0,b=0,c=a.length;b<c;b++)f=a[b],g.set(f,e),e+=f.length;return g}},f={arraySet:function(a,b,c,d,e){for(var f=0;f<d;f++)a[e+f]=b[c+f]},flattenChunks:function(a){return[].concat.apply([],a)}};b.setTyped=function(a){a?(b.Buf8=Uint8Array,b.Buf16=Uint16Array,b.Buf32=Int32Array,b.assign(b,e)):(b.Buf8=Array,b.Buf16=Array,b.Buf32=Array,b.assign(b,f))},b.setTyped(d)},function(a,b,c){"use strict";function d(a){if(!(this instanceof d))return new d(a);this.options=i.assign({level:o,method:q,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},a||{});var b=this.options;b.raw&&b.windowBits>0?b.windowBits=-b.windowBits:b.gzip&&b.windowBits>0&&b.windowBits<16&&(b.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var c=h.deflateInit2(this.strm,b.level,b.method,b.windowBits,b.memLevel,b.strategy);if(c!==n)throw new Error(k[c]);if(b.header&&h.deflateSetHeader(this.strm,b.header),b.dictionary){var e;if(e="string"==typeof b.dictionary?j.string2buf(b.dictionary):"[object ArrayBuffer]"===m.call(b.dictionary)?new Uint8Array(b.dictionary):b.dictionary,(c=h.deflateSetDictionary(this.strm,e))!==n)throw new Error(k[c]);this._dict_set=!0}}function e(a,b){var c=new d(b);if(c.push(a,!0),c.err)throw c.msg||k[c.err];return c.result}function f(a,b){return b=b||{},b.raw=!0,e(a,b)}function g(a,b){return b=b||{},b.gzip=!0,e(a,b)}var h=c(11),i=c(9),j=c(16),k=c(15),l=c(17),m=Object.prototype.toString,n=0,o=-1,p=0,q=8;d.prototype.push=function(a,b){var c,d,e=this.strm,f=this.options.chunkSize;if(this.ended)return!1;d=b===~~b?b:!0===b?4:0,"string"==typeof a?e.input=j.string2buf(a):"[object ArrayBuffer]"===m.call(a)?e.input=new Uint8Array(a):e.input=a,e.next_in=0,e.avail_in=e.input.length;do{if(0===e.avail_out&&(e.output=new i.Buf8(f),e.next_out=0,e.avail_out=f),1!==(c=h.deflate(e,d))&&c!==n)return this.onEnd(c),this.ended=!0,!1;0!==e.avail_out&&(0!==e.avail_in||4!==d&&2!==d)||("string"===this.options.to?this.onData(j.buf2binstring(i.shrinkBuf(e.output,e.next_out))):this.onData(i.shrinkBuf(e.output,e.next_out)))}while((e.avail_in>0||0===e.avail_out)&&1!==c);return 4===d?(c=h.deflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===n):2!==d||(this.onEnd(n),e.avail_out=0,!0)},d.prototype.onData=function(a){this.chunks.push(a)},d.prototype.onEnd=function(a){a===n&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg},b.Deflate=d,b.deflate=e,b.deflateRaw=f,b.gzip=g},function(a,b,c){"use strict";function d(a,b){return a.msg=I[b],b}function e(a){return(a<<1)-(a>4?9:0)}function f(a){for(var b=a.length;--b>=0;)a[b]=0}function g(a){var b=a.state,c=b.pending;c>a.avail_out&&(c=a.avail_out),0!==c&&(E.arraySet(a.output,b.pending_buf,b.pending_out,c,a.next_out),a.next_out+=c,b.pending_out+=c,a.total_out+=c,a.avail_out-=c,b.pending-=c,0===b.pending&&(b.pending_out=0))}function h(a,b){F._tr_flush_block(a,a.block_start>=0?a.block_start:-1,a.strstart-a.block_start,b),a.block_start=a.strstart,g(a.strm)}function i(a,b){a.pending_buf[a.pending++]=b}function j(a,b){a.pending_buf[a.pending++]=b>>>8&255,a.pending_buf[a.pending++]=255&b}function k(a,b,c,d){var e=a.avail_in;return e>d&&(e=d),0===e?0:(a.avail_in-=e,E.arraySet(b,a.input,a.next_in,e,c),1===a.state.wrap?a.adler=G(a.adler,b,e,c):2===a.state.wrap&&(a.adler=H(a.adler,b,e,c)),a.next_in+=e,a.total_in+=e,e)}function l(a,b){var c,d,e=a.max_chain_length,f=a.strstart,g=a.prev_length,h=a.nice_match,i=a.strstart>a.w_size-ja?a.strstart-(a.w_size-ja):0,j=a.window,k=a.w_mask,l=a.prev,m=a.strstart+ia,n=j[f+g-1],o=j[f+g];a.prev_length>=a.good_match&&(e>>=2),h>a.lookahead&&(h=a.lookahead);do{if(c=b,j[c+g]===o&&j[c+g-1]===n&&j[c]===j[f]&&j[++c]===j[f+1]){f+=2,c++;do{}while(j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&j[++f]===j[++c]&&f<m);if(d=ia-(m-f),f=m-ia,d>g){if(a.match_start=b,g=d,d>=h)break;n=j[f+g-1],o=j[f+g]}}}while((b=l[b&k])>i&&0!=--e);return g<=a.lookahead?g:a.lookahead}function m(a){var b,c,d,e,f,g=a.w_size;do{if(e=a.window_size-a.lookahead-a.strstart,
a.strstart>=g+(g-ja)){E.arraySet(a.window,a.window,g,g,0),a.match_start-=g,a.strstart-=g,a.block_start-=g,c=a.hash_size,b=c;do{d=a.head[--b],a.head[b]=d>=g?d-g:0}while(--c);c=g,b=c;do{d=a.prev[--b],a.prev[b]=d>=g?d-g:0}while(--c);e+=g}if(0===a.strm.avail_in)break;if(c=k(a.strm,a.window,a.strstart+a.lookahead,e),a.lookahead+=c,a.lookahead+a.insert>=ha)for(f=a.strstart-a.insert,a.ins_h=a.window[f],a.ins_h=(a.ins_h<<a.hash_shift^a.window[f+1])&a.hash_mask;a.insert&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[f+ha-1])&a.hash_mask,a.prev[f&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=f,f++,a.insert--,!(a.lookahead+a.insert<ha)););}while(a.lookahead<ja&&0!==a.strm.avail_in)}function n(a,b){var c=65535;for(c>a.pending_buf_size-5&&(c=a.pending_buf_size-5);;){if(a.lookahead<=1){if(m(a),0===a.lookahead&&b===J)return sa;if(0===a.lookahead)break}a.strstart+=a.lookahead,a.lookahead=0;var d=a.block_start+c;if((0===a.strstart||a.strstart>=d)&&(a.lookahead=a.strstart-d,a.strstart=d,h(a,!1),0===a.strm.avail_out))return sa;if(a.strstart-a.block_start>=a.w_size-ja&&(h(a,!1),0===a.strm.avail_out))return sa}return a.insert=0,b===M?(h(a,!0),0===a.strm.avail_out?ua:va):(a.strstart>a.block_start&&(h(a,!1),a.strm.avail_out),sa)}function o(a,b){for(var c,d;;){if(a.lookahead<ja){if(m(a),a.lookahead<ja&&b===J)return sa;if(0===a.lookahead)break}if(c=0,a.lookahead>=ha&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+ha-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),0!==c&&a.strstart-c<=a.w_size-ja&&(a.match_length=l(a,c)),a.match_length>=ha)if(d=F._tr_tally(a,a.strstart-a.match_start,a.match_length-ha),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&a.lookahead>=ha){a.match_length--;do{a.strstart++,a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+ha-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart}while(0!=--a.match_length);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+1])&a.hash_mask;else d=F._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(d&&(h(a,!1),0===a.strm.avail_out))return sa}return a.insert=a.strstart<ha-1?a.strstart:ha-1,b===M?(h(a,!0),0===a.strm.avail_out?ua:va):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?sa:ta}function p(a,b){for(var c,d,e;;){if(a.lookahead<ja){if(m(a),a.lookahead<ja&&b===J)return sa;if(0===a.lookahead)break}if(c=0,a.lookahead>=ha&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+ha-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=ha-1,0!==c&&a.prev_length<a.max_lazy_match&&a.strstart-c<=a.w_size-ja&&(a.match_length=l(a,c),a.match_length<=5&&(a.strategy===U||a.match_length===ha&&a.strstart-a.match_start>4096)&&(a.match_length=ha-1)),a.prev_length>=ha&&a.match_length<=a.prev_length){e=a.strstart+a.lookahead-ha,d=F._tr_tally(a,a.strstart-1-a.prev_match,a.prev_length-ha),a.lookahead-=a.prev_length-1,a.prev_length-=2;do{++a.strstart<=e&&(a.ins_h=(a.ins_h<<a.hash_shift^a.window[a.strstart+ha-1])&a.hash_mask,c=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart)}while(0!=--a.prev_length);if(a.match_available=0,a.match_length=ha-1,a.strstart++,d&&(h(a,!1),0===a.strm.avail_out))return sa}else if(a.match_available){if(d=F._tr_tally(a,0,a.window[a.strstart-1]),d&&h(a,!1),a.strstart++,a.lookahead--,0===a.strm.avail_out)return sa}else a.match_available=1,a.strstart++,a.lookahead--}return a.match_available&&(d=F._tr_tally(a,0,a.window[a.strstart-1]),a.match_available=0),a.insert=a.strstart<ha-1?a.strstart:ha-1,b===M?(h(a,!0),0===a.strm.avail_out?ua:va):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?sa:ta}function q(a,b){for(var c,d,e,f,g=a.window;;){if(a.lookahead<=ia){if(m(a),a.lookahead<=ia&&b===J)return sa;if(0===a.lookahead)break}if(a.match_length=0,a.lookahead>=ha&&a.strstart>0&&(e=a.strstart-1,(d=g[e])===g[++e]&&d===g[++e]&&d===g[++e])){f=a.strstart+ia;do{}while(d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&d===g[++e]&&e<f);a.match_length=ia-(f-e),a.match_length>a.lookahead&&(a.match_length=a.lookahead)}if(a.match_length>=ha?(c=F._tr_tally(a,1,a.match_length-ha),a.lookahead-=a.match_length,a.strstart+=a.match_length,a.match_length=0):(c=F._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++),c&&(h(a,!1),0===a.strm.avail_out))return sa}return a.insert=0,b===M?(h(a,!0),0===a.strm.avail_out?ua:va):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?sa:ta}function r(a,b){for(var c;;){if(0===a.lookahead&&(m(a),0===a.lookahead)){if(b===J)return sa;break}if(a.match_length=0,c=F._tr_tally(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++,c&&(h(a,!1),0===a.strm.avail_out))return sa}return a.insert=0,b===M?(h(a,!0),0===a.strm.avail_out?ua:va):a.last_lit&&(h(a,!1),0===a.strm.avail_out)?sa:ta}function s(a,b,c,d,e){this.good_length=a,this.max_lazy=b,this.nice_length=c,this.max_chain=d,this.func=e}function t(a){a.window_size=2*a.w_size,f(a.head),a.max_lazy_match=D[a.level].max_lazy,a.good_match=D[a.level].good_length,a.nice_match=D[a.level].nice_length,a.max_chain_length=D[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=ha-1,a.match_available=0,a.ins_h=0}function u(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=$,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new E.Buf16(2*fa),this.dyn_dtree=new E.Buf16(2*(2*da+1)),this.bl_tree=new E.Buf16(2*(2*ea+1)),f(this.dyn_ltree),f(this.dyn_dtree),f(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new E.Buf16(ga+1),this.heap=new E.Buf16(2*ca+1),f(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new E.Buf16(2*ca+1),f(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function v(a){var b;return a&&a.state?(a.total_in=a.total_out=0,a.data_type=Z,b=a.state,b.pending=0,b.pending_out=0,b.wrap<0&&(b.wrap=-b.wrap),b.status=b.wrap?la:qa,a.adler=2===b.wrap?0:1,b.last_flush=J,F._tr_init(b),O):d(a,Q)}function w(a){var b=v(a);return b===O&&t(a.state),b}function x(a,b){return a&&a.state?2!==a.state.wrap?Q:(a.state.gzhead=b,O):Q}function y(a,b,c,e,f,g){if(!a)return Q;var h=1;if(b===T&&(b=6),e<0?(h=0,e=-e):e>15&&(h=2,e-=16),f<1||f>_||c!==$||e<8||e>15||b<0||b>9||g<0||g>X)return d(a,Q);8===e&&(e=9);var i=new u;return a.state=i,i.strm=a,i.wrap=h,i.gzhead=null,i.w_bits=e,i.w_size=1<<i.w_bits,i.w_mask=i.w_size-1,i.hash_bits=f+7,i.hash_size=1<<i.hash_bits,i.hash_mask=i.hash_size-1,i.hash_shift=~~((i.hash_bits+ha-1)/ha),i.window=new E.Buf8(2*i.w_size),i.head=new E.Buf16(i.hash_size),i.prev=new E.Buf16(i.w_size),i.lit_bufsize=1<<f+6,i.pending_buf_size=4*i.lit_bufsize,i.pending_buf=new E.Buf8(i.pending_buf_size),i.d_buf=1*i.lit_bufsize,i.l_buf=3*i.lit_bufsize,i.level=b,i.strategy=g,i.method=c,w(a)}function z(a,b){return y(a,b,$,aa,ba,Y)}function A(a,b){var c,h,k,l;if(!a||!a.state||b>N||b<0)return a?d(a,Q):Q;if(h=a.state,!a.output||!a.input&&0!==a.avail_in||h.status===ra&&b!==M)return d(a,0===a.avail_out?S:Q);if(h.strm=a,c=h.last_flush,h.last_flush=b,h.status===la)if(2===h.wrap)a.adler=0,i(h,31),i(h,139),i(h,8),h.gzhead?(i(h,(h.gzhead.text?1:0)+(h.gzhead.hcrc?2:0)+(h.gzhead.extra?4:0)+(h.gzhead.name?8:0)+(h.gzhead.comment?16:0)),i(h,255&h.gzhead.time),i(h,h.gzhead.time>>8&255),i(h,h.gzhead.time>>16&255),i(h,h.gzhead.time>>24&255),i(h,9===h.level?2:h.strategy>=V||h.level<2?4:0),i(h,255&h.gzhead.os),h.gzhead.extra&&h.gzhead.extra.length&&(i(h,255&h.gzhead.extra.length),i(h,h.gzhead.extra.length>>8&255)),h.gzhead.hcrc&&(a.adler=H(a.adler,h.pending_buf,h.pending,0)),h.gzindex=0,h.status=ma):(i(h,0),i(h,0),i(h,0),i(h,0),i(h,0),i(h,9===h.level?2:h.strategy>=V||h.level<2?4:0),i(h,wa),h.status=qa);else{var m=$+(h.w_bits-8<<4)<<8,n=-1;n=h.strategy>=V||h.level<2?0:h.level<6?1:6===h.level?2:3,m|=n<<6,0!==h.strstart&&(m|=ka),m+=31-m%31,h.status=qa,j(h,m),0!==h.strstart&&(j(h,a.adler>>>16),j(h,65535&a.adler)),a.adler=1}if(h.status===ma)if(h.gzhead.extra){for(k=h.pending;h.gzindex<(65535&h.gzhead.extra.length)&&(h.pending!==h.pending_buf_size||(h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),g(a),k=h.pending,h.pending!==h.pending_buf_size));)i(h,255&h.gzhead.extra[h.gzindex]),h.gzindex++;h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),h.gzindex===h.gzhead.extra.length&&(h.gzindex=0,h.status=na)}else h.status=na;if(h.status===na)if(h.gzhead.name){k=h.pending;do{if(h.pending===h.pending_buf_size&&(h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),g(a),k=h.pending,h.pending===h.pending_buf_size)){l=1;break}l=h.gzindex<h.gzhead.name.length?255&h.gzhead.name.charCodeAt(h.gzindex++):0,i(h,l)}while(0!==l);h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),0===l&&(h.gzindex=0,h.status=oa)}else h.status=oa;if(h.status===oa)if(h.gzhead.comment){k=h.pending;do{if(h.pending===h.pending_buf_size&&(h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),g(a),k=h.pending,h.pending===h.pending_buf_size)){l=1;break}l=h.gzindex<h.gzhead.comment.length?255&h.gzhead.comment.charCodeAt(h.gzindex++):0,i(h,l)}while(0!==l);h.gzhead.hcrc&&h.pending>k&&(a.adler=H(a.adler,h.pending_buf,h.pending-k,k)),0===l&&(h.status=pa)}else h.status=pa;if(h.status===pa&&(h.gzhead.hcrc?(h.pending+2>h.pending_buf_size&&g(a),h.pending+2<=h.pending_buf_size&&(i(h,255&a.adler),i(h,a.adler>>8&255),a.adler=0,h.status=qa)):h.status=qa),0!==h.pending){if(g(a),0===a.avail_out)return h.last_flush=-1,O}else if(0===a.avail_in&&e(b)<=e(c)&&b!==M)return d(a,S);if(h.status===ra&&0!==a.avail_in)return d(a,S);if(0!==a.avail_in||0!==h.lookahead||b!==J&&h.status!==ra){var o=h.strategy===V?r(h,b):h.strategy===W?q(h,b):D[h.level].func(h,b);if(o!==ua&&o!==va||(h.status=ra),o===sa||o===ua)return 0===a.avail_out&&(h.last_flush=-1),O;if(o===ta&&(b===K?F._tr_align(h):b!==N&&(F._tr_stored_block(h,0,0,!1),b===L&&(f(h.head),0===h.lookahead&&(h.strstart=0,h.block_start=0,h.insert=0))),g(a),0===a.avail_out))return h.last_flush=-1,O}return b!==M?O:h.wrap<=0?P:(2===h.wrap?(i(h,255&a.adler),i(h,a.adler>>8&255),i(h,a.adler>>16&255),i(h,a.adler>>24&255),i(h,255&a.total_in),i(h,a.total_in>>8&255),i(h,a.total_in>>16&255),i(h,a.total_in>>24&255)):(j(h,a.adler>>>16),j(h,65535&a.adler)),g(a),h.wrap>0&&(h.wrap=-h.wrap),0!==h.pending?O:P)}function B(a){var b;return a&&a.state?(b=a.state.status)!==la&&b!==ma&&b!==na&&b!==oa&&b!==pa&&b!==qa&&b!==ra?d(a,Q):(a.state=null,b===qa?d(a,R):O):Q}function C(a,b){var c,d,e,g,h,i,j,k,l=b.length;if(!a||!a.state)return Q;if(c=a.state,2===(g=c.wrap)||1===g&&c.status!==la||c.lookahead)return Q;for(1===g&&(a.adler=G(a.adler,b,l,0)),c.wrap=0,l>=c.w_size&&(0===g&&(f(c.head),c.strstart=0,c.block_start=0,c.insert=0),k=new E.Buf8(c.w_size),E.arraySet(k,b,l-c.w_size,c.w_size,0),b=k,l=c.w_size),h=a.avail_in,i=a.next_in,j=a.input,a.avail_in=l,a.next_in=0,a.input=b,m(c);c.lookahead>=ha;){d=c.strstart,e=c.lookahead-(ha-1);do{c.ins_h=(c.ins_h<<c.hash_shift^c.window[d+ha-1])&c.hash_mask,c.prev[d&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=d,d++}while(--e);c.strstart=d,c.lookahead=ha-1,m(c)}return c.strstart+=c.lookahead,c.block_start=c.strstart,c.insert=c.lookahead,c.lookahead=0,c.match_length=c.prev_length=ha-1,c.match_available=0,a.next_in=i,a.input=j,a.avail_in=h,c.wrap=g,O}var D,E=c(9),F=c(12),G=c(13),H=c(14),I=c(15),J=0,K=1,L=3,M=4,N=5,O=0,P=1,Q=-2,R=-3,S=-5,T=-1,U=1,V=2,W=3,X=4,Y=0,Z=2,$=8,_=9,aa=15,ba=8,ca=286,da=30,ea=19,fa=2*ca+1,ga=15,ha=3,ia=258,ja=ia+ha+1,ka=32,la=42,ma=69,na=73,oa=91,pa=103,qa=113,ra=666,sa=1,ta=2,ua=3,va=4,wa=3;D=[new s(0,0,0,0,n),new s(4,4,8,4,o),new s(4,5,16,8,o),new s(4,6,32,32,o),new s(4,4,16,16,p),new s(8,16,32,32,p),new s(8,16,128,128,p),new s(8,32,128,256,p),new s(32,128,258,1024,p),new s(32,258,258,4096,p)],b.deflateInit=z,b.deflateInit2=y,b.deflateReset=w,b.deflateResetKeep=v,b.deflateSetHeader=x,b.deflate=A,b.deflateEnd=B,b.deflateSetDictionary=C,b.deflateInfo="pako deflate (from Nodeca project)"},function(a,b,c){"use strict";function d(a){for(var b=a.length;--b>=0;)a[b]=0}function e(a,b,c,d,e){this.static_tree=a,this.extra_bits=b,this.extra_base=c,this.elems=d,this.max_length=e,this.has_stree=a&&a.length}function f(a,b){this.dyn_tree=a,this.max_code=0,this.stat_desc=b}function g(a){return a<256?fa[a]:fa[256+(a>>>7)]}function h(a,b){a.pending_buf[a.pending++]=255&b,a.pending_buf[a.pending++]=b>>>8&255}function i(a,b,c){a.bi_valid>V-c?(a.bi_buf|=b<<a.bi_valid&65535,h(a,a.bi_buf),a.bi_buf=b>>V-a.bi_valid,a.bi_valid+=c-V):(a.bi_buf|=b<<a.bi_valid&65535,a.bi_valid+=c)}function j(a,b,c){i(a,c[2*b],c[2*b+1])}function k(a,b){var c=0;do{c|=1&a,a>>>=1,c<<=1}while(--b>0);return c>>>1}function l(a){16===a.bi_valid?(h(a,a.bi_buf),a.bi_buf=0,a.bi_valid=0):a.bi_valid>=8&&(a.pending_buf[a.pending++]=255&a.bi_buf,a.bi_buf>>=8,a.bi_valid-=8)}function m(a,b){var c,d,e,f,g,h,i=b.dyn_tree,j=b.max_code,k=b.stat_desc.static_tree,l=b.stat_desc.has_stree,m=b.stat_desc.extra_bits,n=b.stat_desc.extra_base,o=b.stat_desc.max_length,p=0;for(f=0;f<=U;f++)a.bl_count[f]=0;for(i[2*a.heap[a.heap_max]+1]=0,c=a.heap_max+1;c<T;c++)d=a.heap[c],f=i[2*i[2*d+1]+1]+1,f>o&&(f=o,p++),i[2*d+1]=f,d>j||(a.bl_count[f]++,g=0,d>=n&&(g=m[d-n]),h=i[2*d],a.opt_len+=h*(f+g),l&&(a.static_len+=h*(k[2*d+1]+g)));if(0!==p){do{for(f=o-1;0===a.bl_count[f];)f--;a.bl_count[f]--,a.bl_count[f+1]+=2,a.bl_count[o]--,p-=2}while(p>0);for(f=o;0!==f;f--)for(d=a.bl_count[f];0!==d;)(e=a.heap[--c])>j||(i[2*e+1]!==f&&(a.opt_len+=(f-i[2*e+1])*i[2*e],i[2*e+1]=f),d--)}}function n(a,b,c){var d,e,f=new Array(U+1),g=0;for(d=1;d<=U;d++)f[d]=g=g+c[d-1]<<1;for(e=0;e<=b;e++){var h=a[2*e+1];0!==h&&(a[2*e]=k(f[h]++,h))}}function o(){var a,b,c,d,f,g=new Array(U+1);for(c=0,d=0;d<O-1;d++)for(ha[d]=c,a=0;a<1<<_[d];a++)ga[c++]=d;for(ga[c-1]=d,f=0,d=0;d<16;d++)for(ia[d]=f,a=0;a<1<<aa[d];a++)fa[f++]=d;for(f>>=7;d<R;d++)for(ia[d]=f<<7,a=0;a<1<<aa[d]-7;a++)fa[256+f++]=d;for(b=0;b<=U;b++)g[b]=0;for(a=0;a<=143;)da[2*a+1]=8,a++,g[8]++;for(;a<=255;)da[2*a+1]=9,a++,g[9]++;for(;a<=279;)da[2*a+1]=7,a++,g[7]++;for(;a<=287;)da[2*a+1]=8,a++,g[8]++;for(n(da,Q+1,g),a=0;a<R;a++)ea[2*a+1]=5,ea[2*a]=k(a,5);ja=new e(da,_,P+1,Q,U),ka=new e(ea,aa,0,R,U),la=new e(new Array(0),ba,0,S,W)}function p(a){var b;for(b=0;b<Q;b++)a.dyn_ltree[2*b]=0;for(b=0;b<R;b++)a.dyn_dtree[2*b]=0;for(b=0;b<S;b++)a.bl_tree[2*b]=0;a.dyn_ltree[2*X]=1,a.opt_len=a.static_len=0,a.last_lit=a.matches=0}function q(a){a.bi_valid>8?h(a,a.bi_buf):a.bi_valid>0&&(a.pending_buf[a.pending++]=a.bi_buf),a.bi_buf=0,a.bi_valid=0}function r(a,b,c,d){q(a),d&&(h(a,c),h(a,~c)),G.arraySet(a.pending_buf,a.window,b,c,a.pending),a.pending+=c}function s(a,b,c,d){var e=2*b,f=2*c;return a[e]<a[f]||a[e]===a[f]&&d[b]<=d[c]}function t(a,b,c){for(var d=a.heap[c],e=c<<1;e<=a.heap_len&&(e<a.heap_len&&s(b,a.heap[e+1],a.heap[e],a.depth)&&e++,!s(b,d,a.heap[e],a.depth));)a.heap[c]=a.heap[e],c=e,e<<=1;a.heap[c]=d}function u(a,b,c){var d,e,f,h,k=0;if(0!==a.last_lit)do{d=a.pending_buf[a.d_buf+2*k]<<8|a.pending_buf[a.d_buf+2*k+1],e=a.pending_buf[a.l_buf+k],k++,0===d?j(a,e,b):(f=ga[e],j(a,f+P+1,b),h=_[f],0!==h&&(e-=ha[f],i(a,e,h)),d--,f=g(d),j(a,f,c),0!==(h=aa[f])&&(d-=ia[f],i(a,d,h)))}while(k<a.last_lit);j(a,X,b)}function v(a,b){var c,d,e,f=b.dyn_tree,g=b.stat_desc.static_tree,h=b.stat_desc.has_stree,i=b.stat_desc.elems,j=-1;for(a.heap_len=0,a.heap_max=T,c=0;c<i;c++)0!==f[2*c]?(a.heap[++a.heap_len]=j=c,a.depth[c]=0):f[2*c+1]=0;for(;a.heap_len<2;)e=a.heap[++a.heap_len]=j<2?++j:0,f[2*e]=1,a.depth[e]=0,a.opt_len--,h&&(a.static_len-=g[2*e+1]);for(b.max_code=j,c=a.heap_len>>1;c>=1;c--)t(a,f,c);e=i;do{c=a.heap[1],a.heap[1]=a.heap[a.heap_len--],t(a,f,1),d=a.heap[1],a.heap[--a.heap_max]=c,a.heap[--a.heap_max]=d,f[2*e]=f[2*c]+f[2*d],a.depth[e]=(a.depth[c]>=a.depth[d]?a.depth[c]:a.depth[d])+1,f[2*c+1]=f[2*d+1]=e,a.heap[1]=e++,t(a,f,1)}while(a.heap_len>=2);a.heap[--a.heap_max]=a.heap[1],m(a,b),n(f,j,a.bl_count)}function w(a,b,c){var d,e,f=-1,g=b[1],h=0,i=7,j=4;for(0===g&&(i=138,j=3),b[2*(c+1)+1]=65535,d=0;d<=c;d++)e=g,g=b[2*(d+1)+1],++h<i&&e===g||(h<j?a.bl_tree[2*e]+=h:0!==e?(e!==f&&a.bl_tree[2*e]++,a.bl_tree[2*Y]++):h<=10?a.bl_tree[2*Z]++:a.bl_tree[2*$]++,h=0,f=e,0===g?(i=138,j=3):e===g?(i=6,j=3):(i=7,j=4))}function x(a,b,c){var d,e,f=-1,g=b[1],h=0,k=7,l=4;for(0===g&&(k=138,l=3),d=0;d<=c;d++)if(e=g,g=b[2*(d+1)+1],!(++h<k&&e===g)){if(h<l)do{j(a,e,a.bl_tree)}while(0!=--h);else 0!==e?(e!==f&&(j(a,e,a.bl_tree),h--),j(a,Y,a.bl_tree),i(a,h-3,2)):h<=10?(j(a,Z,a.bl_tree),i(a,h-3,3)):(j(a,$,a.bl_tree),i(a,h-11,7));h=0,f=e,0===g?(k=138,l=3):e===g?(k=6,l=3):(k=7,l=4)}}function y(a){var b;for(w(a,a.dyn_ltree,a.l_desc.max_code),w(a,a.dyn_dtree,a.d_desc.max_code),v(a,a.bl_desc),b=S-1;b>=3&&0===a.bl_tree[2*ca[b]+1];b--);return a.opt_len+=3*(b+1)+5+5+4,b}function z(a,b,c,d){var e;for(i(a,b-257,5),i(a,c-1,5),i(a,d-4,4),e=0;e<d;e++)i(a,a.bl_tree[2*ca[e]+1],3);x(a,a.dyn_ltree,b-1),x(a,a.dyn_dtree,c-1)}function A(a){var b,c=4093624447;for(b=0;b<=31;b++,c>>>=1)if(1&c&&0!==a.dyn_ltree[2*b])return I;if(0!==a.dyn_ltree[18]||0!==a.dyn_ltree[20]||0!==a.dyn_ltree[26])return J;for(b=32;b<P;b++)if(0!==a.dyn_ltree[2*b])return J;return I}function B(a){ma||(o(),ma=!0),a.l_desc=new f(a.dyn_ltree,ja),a.d_desc=new f(a.dyn_dtree,ka),a.bl_desc=new f(a.bl_tree,la),a.bi_buf=0,a.bi_valid=0,p(a)}function C(a,b,c,d){i(a,(L<<1)+(d?1:0),3),r(a,b,c,!0)}function D(a){i(a,M<<1,3),j(a,X,da),l(a)}function E(a,b,c,d){var e,f,g=0;a.level>0?(a.strm.data_type===K&&(a.strm.data_type=A(a)),v(a,a.l_desc),v(a,a.d_desc),g=y(a),e=a.opt_len+3+7>>>3,(f=a.static_len+3+7>>>3)<=e&&(e=f)):e=f=c+5,c+4<=e&&-1!==b?C(a,b,c,d):a.strategy===H||f===e?(i(a,(M<<1)+(d?1:0),3),u(a,da,ea)):(i(a,(N<<1)+(d?1:0),3),z(a,a.l_desc.max_code+1,a.d_desc.max_code+1,g+1),u(a,a.dyn_ltree,a.dyn_dtree)),p(a),d&&q(a)}function F(a,b,c){return a.pending_buf[a.d_buf+2*a.last_lit]=b>>>8&255,a.pending_buf[a.d_buf+2*a.last_lit+1]=255&b,a.pending_buf[a.l_buf+a.last_lit]=255&c,a.last_lit++,0===b?a.dyn_ltree[2*c]++:(a.matches++,b--,a.dyn_ltree[2*(ga[c]+P+1)]++,a.dyn_dtree[2*g(b)]++),a.last_lit===a.lit_bufsize-1}var G=c(9),H=4,I=0,J=1,K=2,L=0,M=1,N=2,O=29,P=256,Q=P+1+O,R=30,S=19,T=2*Q+1,U=15,V=16,W=7,X=256,Y=16,Z=17,$=18,_=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],aa=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ba=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ca=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],da=new Array(2*(Q+2));d(da);var ea=new Array(2*R);d(ea);var fa=new Array(512);d(fa);var ga=new Array(256);d(ga);var ha=new Array(O);d(ha);var ia=new Array(R);d(ia);var ja,ka,la,ma=!1;b._tr_init=B,b._tr_stored_block=C,b._tr_flush_block=E,b._tr_tally=F,b._tr_align=D},function(a,b){"use strict";function c(a,b,c,d){for(var e=65535&a|0,f=a>>>16&65535|0,g=0;0!==c;){g=c>2e3?2e3:c,c-=g;do{e=e+b[d++]|0,f=f+e|0}while(--g);e%=65521,f%=65521}return e|f<<16|0}a.exports=c},function(a,b){"use strict";function c(a,b,c,e){var f=d,g=e+c;a^=-1;for(var h=e;h<g;h++)a=a>>>8^f[255&(a^b[h])];return-1^a}var d=function(){for(var a,b=[],c=0;c<256;c++){a=c;for(var d=0;d<8;d++)a=1&a?3988292384^a>>>1:a>>>1;b[c]=a}return b}();a.exports=c},function(a,b){"use strict";a.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(a,b,c){"use strict";function d(a,b){if(b<65537&&(a.subarray&&g||!a.subarray&&f))return String.fromCharCode.apply(null,e.shrinkBuf(a,b));for(var c="",d=0;d<b;d++)c+=String.fromCharCode(a[d]);return c}var e=c(9),f=!0,g=!0;try{String.fromCharCode.apply(null,[0])}catch(a){f=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(a){g=!1}for(var h=new e.Buf8(256),i=0;i<256;i++)h[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;h[254]=h[254]=1,b.string2buf=function(a){var b,c,d,f,g,h=a.length,i=0;for(f=0;f<h;f++)c=a.charCodeAt(f),55296==(64512&c)&&f+1<h&&56320==(64512&(d=a.charCodeAt(f+1)))&&(c=65536+(c-55296<<10)+(d-56320),f++),i+=c<128?1:c<2048?2:c<65536?3:4;for(b=new e.Buf8(i),g=0,f=0;g<i;f++)c=a.charCodeAt(f),55296==(64512&c)&&f+1<h&&56320==(64512&(d=a.charCodeAt(f+1)))&&(c=65536+(c-55296<<10)+(d-56320),f++),c<128?b[g++]=c:c<2048?(b[g++]=192|c>>>6,b[g++]=128|63&c):c<65536?(b[g++]=224|c>>>12,b[g++]=128|c>>>6&63,b[g++]=128|63&c):(b[g++]=240|c>>>18,b[g++]=128|c>>>12&63,b[g++]=128|c>>>6&63,b[g++]=128|63&c);return b},b.buf2binstring=function(a){return d(a,a.length)},b.binstring2buf=function(a){for(var b=new e.Buf8(a.length),c=0,d=b.length;c<d;c++)b[c]=a.charCodeAt(c);return b},b.buf2string=function(a,b){var c,e,f,g,i=b||a.length,j=new Array(2*i);for(e=0,c=0;c<i;)if((f=a[c++])<128)j[e++]=f;else if((g=h[f])>4)j[e++]=65533,c+=g-1;else{for(f&=2===g?31:3===g?15:7;g>1&&c<i;)f=f<<6|63&a[c++],g--;g>1?j[e++]=65533:f<65536?j[e++]=f:(f-=65536,j[e++]=55296|f>>10&1023,j[e++]=56320|1023&f)}return d(j,e)},b.utf8border=function(a,b){var c;for(b=b||a.length,b>a.length&&(b=a.length),c=b-1;c>=0&&128==(192&a[c]);)c--;return c<0?b:0===c?b:c+h[a[c]]>b?c:b}},function(a,b){"use strict";function c(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}a.exports=c},function(a,b,c){"use strict";function d(a){if(!(this instanceof d))return new d(a);this.options=h.assign({chunkSize:16384,windowBits:0,to:""},a||{});var b=this.options;b.raw&&b.windowBits>=0&&b.windowBits<16&&(b.windowBits=-b.windowBits,0===b.windowBits&&(b.windowBits=-15)),!(b.windowBits>=0&&b.windowBits<16)||a&&a.windowBits||(b.windowBits+=32),b.windowBits>15&&b.windowBits<48&&0==(15&b.windowBits)&&(b.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var c=g.inflateInit2(this.strm,b.windowBits);if(c!==j.Z_OK)throw new Error(k[c]);this.header=new m,g.inflateGetHeader(this.strm,this.header)}function e(a,b){var c=new d(b);if(c.push(a,!0),c.err)throw c.msg||k[c.err];return c.result}function f(a,b){return b=b||{},b.raw=!0,e(a,b)}var g=c(19),h=c(9),i=c(16),j=c(22),k=c(15),l=c(17),m=c(23),n=Object.prototype.toString;d.prototype.push=function(a,b){var c,d,e,f,k,l,m=this.strm,o=this.options.chunkSize,p=this.options.dictionary,q=!1;if(this.ended)return!1;d=b===~~b?b:!0===b?j.Z_FINISH:j.Z_NO_FLUSH,"string"==typeof a?m.input=i.binstring2buf(a):"[object ArrayBuffer]"===n.call(a)?m.input=new Uint8Array(a):m.input=a,m.next_in=0,m.avail_in=m.input.length;do{if(0===m.avail_out&&(m.output=new h.Buf8(o),m.next_out=0,m.avail_out=o),c=g.inflate(m,j.Z_NO_FLUSH),c===j.Z_NEED_DICT&&p&&(l="string"==typeof p?i.string2buf(p):"[object ArrayBuffer]"===n.call(p)?new Uint8Array(p):p,c=g.inflateSetDictionary(this.strm,l)),c===j.Z_BUF_ERROR&&!0===q&&(c=j.Z_OK,q=!1),c!==j.Z_STREAM_END&&c!==j.Z_OK)return this.onEnd(c),this.ended=!0,!1;m.next_out&&(0!==m.avail_out&&c!==j.Z_STREAM_END&&(0!==m.avail_in||d!==j.Z_FINISH&&d!==j.Z_SYNC_FLUSH)||("string"===this.options.to?(e=i.utf8border(m.output,m.next_out),f=m.next_out-e,k=i.buf2string(m.output,e),m.next_out=f,m.avail_out=o-f,f&&h.arraySet(m.output,m.output,e,f,0),this.onData(k)):this.onData(h.shrinkBuf(m.output,m.next_out)))),0===m.avail_in&&0===m.avail_out&&(q=!0)}while((m.avail_in>0||0===m.avail_out)&&c!==j.Z_STREAM_END);return c===j.Z_STREAM_END&&(d=j.Z_FINISH),d===j.Z_FINISH?(c=g.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,c===j.Z_OK):d!==j.Z_SYNC_FLUSH||(this.onEnd(j.Z_OK),m.avail_out=0,!0)},d.prototype.onData=function(a){this.chunks.push(a)},d.prototype.onEnd=function(a){a===j.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=h.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg},b.Inflate=d,b.inflate=e,b.inflateRaw=f,b.ungzip=e},function(a,b,c){"use strict";function d(a){return(a>>>24&255)+(a>>>8&65280)+((65280&a)<<8)+((255&a)<<24)}function e(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function f(a){var b;return a&&a.state?(b=a.state,a.total_in=a.total_out=b.total=0,a.msg="",b.wrap&&(a.adler=1&b.wrap),b.mode=L,b.last=0,b.havedict=0,b.dmax=32768,b.head=null,b.hold=0,b.bits=0,b.lencode=b.lendyn=new s.Buf32(pa),b.distcode=b.distdyn=new s.Buf32(qa),b.sane=1,b.back=-1,D):G}function g(a){var b;return a&&a.state?(b=a.state,b.wsize=0,b.whave=0,b.wnext=0,f(a)):G}function h(a,b){var c,d;return a&&a.state?(d=a.state,b<0?(c=0,b=-b):(c=1+(b>>4),b<48&&(b&=15)),b&&(b<8||b>15)?G:(null!==d.window&&d.wbits!==b&&(d.window=null),d.wrap=c,d.wbits=b,g(a))):G}function i(a,b){var c,d;return a?(d=new e,a.state=d,d.window=null,c=h(a,b),c!==D&&(a.state=null),c):G}function j(a){return i(a,ra)}function k(a){if(sa){var b;for(q=new s.Buf32(512),r=new s.Buf32(32),b=0;b<144;)a.lens[b++]=8;for(;b<256;)a.lens[b++]=9;for(;b<280;)a.lens[b++]=7;for(;b<288;)a.lens[b++]=8;for(w(y,a.lens,0,288,q,0,a.work,{bits:9}),b=0;b<32;)a.lens[b++]=5;w(z,a.lens,0,32,r,0,a.work,{bits:5}),sa=!1}a.lencode=q,a.lenbits=9,a.distcode=r,a.distbits=5}function l(a,b,c,d){var e,f=a.state;return null===f.window&&(f.wsize=1<<f.wbits,f.wnext=0,f.whave=0,f.window=new s.Buf8(f.wsize)),d>=f.wsize?(s.arraySet(f.window,b,c-f.wsize,f.wsize,0),f.wnext=0,f.whave=f.wsize):(e=f.wsize-f.wnext,e>d&&(e=d),s.arraySet(f.window,b,c-d,e,f.wnext),d-=e,d?(s.arraySet(f.window,b,c-d,d,0),f.wnext=d,f.whave=f.wsize):(f.wnext+=e,f.wnext===f.wsize&&(f.wnext=0),f.whave<f.wsize&&(f.whave+=e))),0}function m(a,b){var c,e,f,g,h,i,j,m,n,o,p,q,r,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa=0,Ba=new s.Buf8(4),Ca=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!a||!a.state||!a.output||!a.input&&0!==a.avail_in)return G;c=a.state,c.mode===W&&(c.mode=X),h=a.next_out,f=a.output,j=a.avail_out,g=a.next_in,e=a.input,i=a.avail_in,m=c.hold,n=c.bits,o=i,p=j,xa=D;a:for(;;)switch(c.mode){case L:if(0===c.wrap){c.mode=X;break}for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(2&c.wrap&&35615===m){c.check=0,Ba[0]=255&m,Ba[1]=m>>>8&255,c.check=u(c.check,Ba,2,0),m=0,n=0,c.mode=M;break}if(c.flags=0,c.head&&(c.head.done=!1),!(1&c.wrap)||(((255&m)<<8)+(m>>8))%31){a.msg="incorrect header check",c.mode=ma;break}if((15&m)!==K){a.msg="unknown compression method",c.mode=ma;break}if(m>>>=4,n-=4,wa=8+(15&m),0===c.wbits)c.wbits=wa;else if(wa>c.wbits){a.msg="invalid window size",c.mode=ma;break}c.dmax=1<<wa,a.adler=c.check=1,c.mode=512&m?U:W,m=0,n=0;break;case M:for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(c.flags=m,(255&c.flags)!==K){a.msg="unknown compression method",c.mode=ma;break}if(57344&c.flags){a.msg="unknown header flags set",c.mode=ma;break}c.head&&(c.head.text=m>>8&1),512&c.flags&&(Ba[0]=255&m,Ba[1]=m>>>8&255,c.check=u(c.check,Ba,2,0)),m=0,n=0,c.mode=N;case N:for(;n<32;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.head&&(c.head.time=m),512&c.flags&&(Ba[0]=255&m,Ba[1]=m>>>8&255,Ba[2]=m>>>16&255,Ba[3]=m>>>24&255,c.check=u(c.check,Ba,4,0)),m=0,n=0,c.mode=O;case O:for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.head&&(c.head.xflags=255&m,c.head.os=m>>8),512&c.flags&&(Ba[0]=255&m,Ba[1]=m>>>8&255,c.check=u(c.check,Ba,2,0)),m=0,n=0,c.mode=P;case P:if(1024&c.flags){for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.length=m,c.head&&(c.head.extra_len=m),512&c.flags&&(Ba[0]=255&m,Ba[1]=m>>>8&255,c.check=u(c.check,Ba,2,0)),m=0,n=0}else c.head&&(c.head.extra=null);c.mode=Q;case Q:if(1024&c.flags&&(q=c.length,q>i&&(q=i),q&&(c.head&&(wa=c.head.extra_len-c.length,c.head.extra||(c.head.extra=new Array(c.head.extra_len)),s.arraySet(c.head.extra,e,g,q,wa)),512&c.flags&&(c.check=u(c.check,e,q,g)),i-=q,g+=q,c.length-=q),c.length))break a;c.length=0,c.mode=R;case R:if(2048&c.flags){if(0===i)break a;q=0;do{wa=e[g+q++],c.head&&wa&&c.length<65536&&(c.head.name+=String.fromCharCode(wa))}while(wa&&q<i);if(512&c.flags&&(c.check=u(c.check,e,q,g)),i-=q,g+=q,wa)break a}else c.head&&(c.head.name=null);c.length=0,c.mode=S;case S:if(4096&c.flags){if(0===i)break a;q=0;do{wa=e[g+q++],c.head&&wa&&c.length<65536&&(c.head.comment+=String.fromCharCode(wa))}while(wa&&q<i);if(512&c.flags&&(c.check=u(c.check,e,q,g)),i-=q,g+=q,wa)break a}else c.head&&(c.head.comment=null);c.mode=T;case T:if(512&c.flags){for(;n<16;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(m!==(65535&c.check)){a.msg="header crc mismatch",c.mode=ma;break}m=0,n=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0),a.adler=c.check=0,c.mode=W;break;case U:for(;n<32;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}a.adler=c.check=d(m),m=0,n=0,c.mode=V;case V:if(0===c.havedict)return a.next_out=h,a.avail_out=j,a.next_in=g,a.avail_in=i,c.hold=m,c.bits=n,F;a.adler=c.check=1,c.mode=W;case W:if(b===B||b===C)break a;case X:if(c.last){m>>>=7&n,n-=7&n,c.mode=ja;break}for(;n<3;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}switch(c.last=1&m,m>>>=1,n-=1,3&m){case 0:c.mode=Y;break;case 1:if(k(c),c.mode=ca,b===C){m>>>=2,n-=2;break a}break;case 2:c.mode=_;break;case 3:a.msg="invalid block type",c.mode=ma}m>>>=2,n-=2;break;case Y:for(m>>>=7&n,n-=7&n;n<32;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if((65535&m)!=(m>>>16^65535)){a.msg="invalid stored block lengths",c.mode=ma;break}if(c.length=65535&m,m=0,n=0,c.mode=Z,b===C)break a;case Z:c.mode=$;case $:if(q=c.length){if(q>i&&(q=i),q>j&&(q=j),0===q)break a;s.arraySet(f,e,g,q,h),i-=q,g+=q,j-=q,h+=q,c.length-=q;break}c.mode=W;break;case _:for(;n<14;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(c.nlen=257+(31&m),m>>>=5,n-=5,c.ndist=1+(31&m),m>>>=5,n-=5,c.ncode=4+(15&m),m>>>=4,n-=4,c.nlen>286||c.ndist>30){a.msg="too many length or distance symbols",c.mode=ma;break}c.have=0,c.mode=aa;case aa:for(;c.have<c.ncode;){for(;n<3;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.lens[Ca[c.have++]]=7&m,m>>>=3,n-=3}for(;c.have<19;)c.lens[Ca[c.have++]]=0;if(c.lencode=c.lendyn,c.lenbits=7,ya={bits:c.lenbits},xa=w(x,c.lens,0,19,c.lencode,0,c.work,ya),c.lenbits=ya.bits,xa){a.msg="invalid code lengths set",c.mode=ma;break}c.have=0,c.mode=ba;case ba:for(;c.have<c.nlen+c.ndist;){for(;Aa=c.lencode[m&(1<<c.lenbits)-1],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(sa<16)m>>>=qa,n-=qa,c.lens[c.have++]=sa;else{if(16===sa){for(za=qa+2;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(m>>>=qa,n-=qa,0===c.have){a.msg="invalid bit length repeat",c.mode=ma;break}wa=c.lens[c.have-1],q=3+(3&m),m>>>=2,n-=2}else if(17===sa){for(za=qa+3;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=qa,n-=qa,wa=0,q=3+(7&m),m>>>=3,n-=3}else{for(za=qa+7;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=qa,n-=qa,wa=0,q=11+(127&m),m>>>=7,n-=7}if(c.have+q>c.nlen+c.ndist){a.msg="invalid bit length repeat",c.mode=ma;break}for(;q--;)c.lens[c.have++]=wa}}if(c.mode===ma)break;if(0===c.lens[256]){a.msg="invalid code -- missing end-of-block",c.mode=ma;break}if(c.lenbits=9,ya={bits:c.lenbits},xa=w(y,c.lens,0,c.nlen,c.lencode,0,c.work,ya),c.lenbits=ya.bits,xa){a.msg="invalid literal/lengths set",c.mode=ma;break}if(c.distbits=6,
c.distcode=c.distdyn,ya={bits:c.distbits},xa=w(z,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,ya),c.distbits=ya.bits,xa){a.msg="invalid distances set",c.mode=ma;break}if(c.mode=ca,b===C)break a;case ca:c.mode=da;case da:if(i>=6&&j>=258){a.next_out=h,a.avail_out=j,a.next_in=g,a.avail_in=i,c.hold=m,c.bits=n,v(a,p),h=a.next_out,f=a.output,j=a.avail_out,g=a.next_in,e=a.input,i=a.avail_in,m=c.hold,n=c.bits,c.mode===W&&(c.back=-1);break}for(c.back=0;Aa=c.lencode[m&(1<<c.lenbits)-1],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(ra&&0==(240&ra)){for(ta=qa,ua=ra,va=sa;Aa=c.lencode[va+((m&(1<<ta+ua)-1)>>ta)],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(ta+qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=ta,n-=ta,c.back+=ta}if(m>>>=qa,n-=qa,c.back+=qa,c.length=sa,0===ra){c.mode=ia;break}if(32&ra){c.back=-1,c.mode=W;break}if(64&ra){a.msg="invalid literal/length code",c.mode=ma;break}c.extra=15&ra,c.mode=ea;case ea:if(c.extra){for(za=c.extra;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.length+=m&(1<<c.extra)-1,m>>>=c.extra,n-=c.extra,c.back+=c.extra}c.was=c.length,c.mode=fa;case fa:for(;Aa=c.distcode[m&(1<<c.distbits)-1],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(0==(240&ra)){for(ta=qa,ua=ra,va=sa;Aa=c.distcode[va+((m&(1<<ta+ua)-1)>>ta)],qa=Aa>>>24,ra=Aa>>>16&255,sa=65535&Aa,!(ta+qa<=n);){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}m>>>=ta,n-=ta,c.back+=ta}if(m>>>=qa,n-=qa,c.back+=qa,64&ra){a.msg="invalid distance code",c.mode=ma;break}c.offset=sa,c.extra=15&ra,c.mode=ga;case ga:if(c.extra){for(za=c.extra;n<za;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}c.offset+=m&(1<<c.extra)-1,m>>>=c.extra,n-=c.extra,c.back+=c.extra}if(c.offset>c.dmax){a.msg="invalid distance too far back",c.mode=ma;break}c.mode=ha;case ha:if(0===j)break a;if(q=p-j,c.offset>q){if((q=c.offset-q)>c.whave&&c.sane){a.msg="invalid distance too far back",c.mode=ma;break}q>c.wnext?(q-=c.wnext,r=c.wsize-q):r=c.wnext-q,q>c.length&&(q=c.length),pa=c.window}else pa=f,r=h-c.offset,q=c.length;q>j&&(q=j),j-=q,c.length-=q;do{f[h++]=pa[r++]}while(--q);0===c.length&&(c.mode=da);break;case ia:if(0===j)break a;f[h++]=c.length,j--,c.mode=da;break;case ja:if(c.wrap){for(;n<32;){if(0===i)break a;i--,m|=e[g++]<<n,n+=8}if(p-=j,a.total_out+=p,c.total+=p,p&&(a.adler=c.check=c.flags?u(c.check,f,p,h-p):t(c.check,f,p,h-p)),p=j,(c.flags?m:d(m))!==c.check){a.msg="incorrect data check",c.mode=ma;break}m=0,n=0}c.mode=ka;case ka:if(c.wrap&&c.flags){for(;n<32;){if(0===i)break a;i--,m+=e[g++]<<n,n+=8}if(m!==(4294967295&c.total)){a.msg="incorrect length check",c.mode=ma;break}m=0,n=0}c.mode=la;case la:xa=E;break a;case ma:xa=H;break a;case na:return I;case oa:default:return G}return a.next_out=h,a.avail_out=j,a.next_in=g,a.avail_in=i,c.hold=m,c.bits=n,(c.wsize||p!==a.avail_out&&c.mode<ma&&(c.mode<ja||b!==A))&&l(a,a.output,a.next_out,p-a.avail_out)?(c.mode=na,I):(o-=a.avail_in,p-=a.avail_out,a.total_in+=o,a.total_out+=p,c.total+=p,c.wrap&&p&&(a.adler=c.check=c.flags?u(c.check,f,p,a.next_out-p):t(c.check,f,p,a.next_out-p)),a.data_type=c.bits+(c.last?64:0)+(c.mode===W?128:0)+(c.mode===ca||c.mode===Z?256:0),(0===o&&0===p||b===A)&&xa===D&&(xa=J),xa)}function n(a){if(!a||!a.state)return G;var b=a.state;return b.window&&(b.window=null),a.state=null,D}function o(a,b){var c;return a&&a.state?(c=a.state,0==(2&c.wrap)?G:(c.head=b,b.done=!1,D)):G}function p(a,b){var c,d,e=b.length;return a&&a.state?(c=a.state,0!==c.wrap&&c.mode!==V?G:c.mode===V&&(d=1,(d=t(d,b,e,0))!==c.check)?H:l(a,b,e,e)?(c.mode=na,I):(c.havedict=1,D)):G}var q,r,s=c(9),t=c(13),u=c(14),v=c(20),w=c(21),x=0,y=1,z=2,A=4,B=5,C=6,D=0,E=1,F=2,G=-2,H=-3,I=-4,J=-5,K=8,L=1,M=2,N=3,O=4,P=5,Q=6,R=7,S=8,T=9,U=10,V=11,W=12,X=13,Y=14,Z=15,$=16,_=17,aa=18,ba=19,ca=20,da=21,ea=22,fa=23,ga=24,ha=25,ia=26,ja=27,ka=28,la=29,ma=30,na=31,oa=32,pa=852,qa=592,ra=15,sa=!0;b.inflateReset=g,b.inflateReset2=h,b.inflateResetKeep=f,b.inflateInit=j,b.inflateInit2=i,b.inflate=m,b.inflateEnd=n,b.inflateGetHeader=o,b.inflateSetDictionary=p,b.inflateInfo="pako inflate (from Nodeca project)"},function(a,b){"use strict";a.exports=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;c=a.state,d=a.next_in,z=a.input,e=d+(a.avail_in-5),f=a.next_out,A=a.output,g=f-(b-a.avail_out),h=f+(a.avail_out-257),i=c.dmax,j=c.wsize,k=c.whave,l=c.wnext,m=c.window,n=c.hold,o=c.bits,p=c.lencode,q=c.distcode,r=(1<<c.lenbits)-1,s=(1<<c.distbits)-1;a:do{o<15&&(n+=z[d++]<<o,o+=8,n+=z[d++]<<o,o+=8),t=p[n&r];b:for(;;){if(u=t>>>24,n>>>=u,o-=u,0===(u=t>>>16&255))A[f++]=65535&t;else{if(!(16&u)){if(0==(64&u)){t=p[(65535&t)+(n&(1<<u)-1)];continue b}if(32&u){c.mode=12;break a}a.msg="invalid literal/length code",c.mode=30;break a}v=65535&t,u&=15,u&&(o<u&&(n+=z[d++]<<o,o+=8),v+=n&(1<<u)-1,n>>>=u,o-=u),o<15&&(n+=z[d++]<<o,o+=8,n+=z[d++]<<o,o+=8),t=q[n&s];c:for(;;){if(u=t>>>24,n>>>=u,o-=u,!(16&(u=t>>>16&255))){if(0==(64&u)){t=q[(65535&t)+(n&(1<<u)-1)];continue c}a.msg="invalid distance code",c.mode=30;break a}if(w=65535&t,u&=15,o<u&&(n+=z[d++]<<o,(o+=8)<u&&(n+=z[d++]<<o,o+=8)),(w+=n&(1<<u)-1)>i){a.msg="invalid distance too far back",c.mode=30;break a}if(n>>>=u,o-=u,u=f-g,w>u){if((u=w-u)>k&&c.sane){a.msg="invalid distance too far back",c.mode=30;break a}if(x=0,y=m,0===l){if(x+=j-u,u<v){v-=u;do{A[f++]=m[x++]}while(--u);x=f-w,y=A}}else if(l<u){if(x+=j+l-u,(u-=l)<v){v-=u;do{A[f++]=m[x++]}while(--u);if(x=0,l<v){u=l,v-=u;do{A[f++]=m[x++]}while(--u);x=f-w,y=A}}}else if(x+=l-u,u<v){v-=u;do{A[f++]=m[x++]}while(--u);x=f-w,y=A}for(;v>2;)A[f++]=y[x++],A[f++]=y[x++],A[f++]=y[x++],v-=3;v&&(A[f++]=y[x++],v>1&&(A[f++]=y[x++]))}else{x=f-w;do{A[f++]=A[x++],A[f++]=A[x++],A[f++]=A[x++],v-=3}while(v>2);v&&(A[f++]=A[x++],v>1&&(A[f++]=A[x++]))}break}}break}}while(d<e&&f<h);v=o>>3,d-=v,o-=v<<3,n&=(1<<o)-1,a.next_in=d,a.next_out=f,a.avail_in=d<e?e-d+5:5-(d-e),a.avail_out=f<h?h-f+257:257-(f-h),c.hold=n,c.bits=o}},function(a,b,c){"use strict";var d=c(9),e=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],f=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],g=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];a.exports=function(a,b,c,i,j,k,l,m){var n,o,p,q,r,s,t,u,v,w=m.bits,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=null,I=0,J=new d.Buf16(16),K=new d.Buf16(16),L=null,M=0;for(x=0;x<=15;x++)J[x]=0;for(y=0;y<i;y++)J[b[c+y]]++;for(B=w,A=15;A>=1&&0===J[A];A--);if(B>A&&(B=A),0===A)return j[k++]=20971520,j[k++]=20971520,m.bits=1,0;for(z=1;z<A&&0===J[z];z++);for(B<z&&(B=z),E=1,x=1;x<=15;x++)if(E<<=1,(E-=J[x])<0)return-1;if(E>0&&(0===a||1!==A))return-1;for(K[1]=0,x=1;x<15;x++)K[x+1]=K[x]+J[x];for(y=0;y<i;y++)0!==b[c+y]&&(l[K[b[c+y]]++]=y);if(0===a?(H=L=l,s=19):1===a?(H=e,I-=257,L=f,M-=257,s=256):(H=g,L=h,s=-1),G=0,y=0,x=z,r=k,C=B,D=0,p=-1,F=1<<B,q=F-1,1===a&&F>852||2===a&&F>592)return 1;for(;;){t=x-D,l[y]<s?(u=0,v=l[y]):l[y]>s?(u=L[M+l[y]],v=H[I+l[y]]):(u=96,v=0),n=1<<x-D,o=1<<C,z=o;do{o-=n,j[r+(G>>D)+o]=t<<24|u<<16|v|0}while(0!==o);for(n=1<<x-1;G&n;)n>>=1;if(0!==n?(G&=n-1,G+=n):G=0,y++,0==--J[x]){if(x===A)break;x=b[c+l[y]]}if(x>B&&(G&q)!==p){for(0===D&&(D=B),r+=z,C=x-D,E=1<<C;C+D<A&&!((E-=J[C+D])<=0);)C++,E<<=1;if(F+=1<<C,1===a&&F>852||2===a&&F>592)return 1;p=G&q,j[p]=B<<24|C<<16|r-k|0}}return 0!==G&&(j[r+G]=x-D<<24|64<<16|0),m.bits=B,0}},function(a,b){"use strict";a.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(a,b){"use strict";function c(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}a.exports=c},function(a,b){},function(a,b,c){"use strict";function d(a,b){try{b()}catch(b){a.worker.raiseError(n.ErrorCodes.BAD_DATA,"Unhandled exception while loading SVF",{url:a.url,exception:b.toString(),stack:b.stack}),a.worker.postMessage(null)}}function e(a){var b=a.worker;d(a,function(){function c(c,e){if("svf"==c){var f,g,h=d.fragments,i=[h.transforms.buffer,h.packIds.buffer,h.entityIndexes.buffer,h.fragId2dbId.buffer,h.visibilityFlags.buffer];d.bvh?(g={nodes:d.bvh.nodes.getRawData(),primitives:d.bvh.primitives,useLeanNodes:32==d.bvh.nodes.bytes_per_node},i.push(g.nodes),i.push(g.primitives.buffer),i.push(h.boxes.buffer),i.push(h.polygonCounts.buffer),i.push(h.materials.buffer),f={svf:d,bvh:g,progress:1}):f={svf:d,progress:.8},b.postMessage(f,i)}else if("bvh"==c)g={nodes:d.bvh.nodes.getRawData(),primitives:d.bvh.primitives,useLeanNodes:32==d.bvh.nodes.bytes_per_node},b.postMessage({bvh:g,basePath:d.basePath,progress:1},[g.nodes,g.primitives.buffer]);else if("mesh"==c){var j=[];e.mesh&&j.push(e.mesh.vb.buffer),b.postMessage(e,j)}else"done"==c?b.postMessage({progress:1}):(b.raiseError(n.ErrorCodes.BAD_DATA,"Failure while loading SVF",{url:a.url}),b.postMessage(null))}var d=a.svf;a.loadDoneCB=c,d.loadRemainingSvf(a)})}function f(a){function b(b){c.postMessage({progress:.5}),d(a,function(){var d,g={max_pf_files:a.max_pf_files};d="gltf"===f||"glb"===f?new i.GltfPackage(b):a.perfOpt&&a.perfOpt.memoryOptimizedSvfLoading?new k.PackageLess(new Uint8Array(b)):new j.Package(new Uint8Array(b),g),a.svf=d,d.loadManifest(a),a.interceptManifest?c.postMessage({manifest:d.manifest}):(a.manifest=d.manifest,e(a))})}var c=a.worker;c.postMessage({progress:.01});var f="svf",g=a.url.toLocaleLowerCase();g.lastIndexOf(".gltf")===g.length-5&&(f="gltf"),g.lastIndexOf(".glb")===g.length-4&&(f="glb");var h={responseType:"gltf"===f?"json":"arraybuffer"};m.ViewingService.getItem(a,a.url,b,a.onFailureCallback,h),"svf"===f&&m.ViewingService.getItem(a,a.basePath+"0.pf",function(){},function(){},h)}function g(a){function b(a){d.postMessage({"status-topology":{}});var b=null;try{var e=new l.InputStream(a),f=a.byteLength;0<f&&(b=JSON.parse(e.getString(f))),b?d.postMessage({"fetch-topology":{error:null,topology:b}}):c("topology-no-content")}catch(a){c(a)}}function c(a){d.postMessage({"fetch-topology":{error:a,topology:null}})}var d=a.worker;m.ViewingService.getItem(a,a.path,b,c,{asynchronous:!0})}function h(a){a.register("LOAD_SVF",{doOperation:f}),a.register("LOAD_SVF_CONTD",{doOperation:e}),a.register("FETCH_TOPOLOGY",{doOperation:g})}Object.defineProperty(b,"__esModule",{value:!0}),b.register=h;var i=c(26),j=c(31),k=c(42),l=c(33),m=c(2),n=c(6)},function(a,b,c){"use strict";function d(a){var b;if(void 0!==("undefined"==typeof TextDecoder?"undefined":g(TextDecoder)))b=new TextDecoder("utf-8").decode(a);else{for(var c="",d=0;d<a.length;d++)c+=String.fromCharCode(a[d]);b=decodeURIComponent(escape(c))}return JSON.parse(b)}function e(a){if(this.loadedBuffers={},a instanceof Uint8Array){var b=new Int32Array(a.buffer,0,20);1179937895!==b[0]&&debug("glb header "+b[0]);var c=b[3],e=new Uint8Array(a.buffer,20,c),f=a.buffer.slice(20+c);a=d(e),this.loadedBuffers.binary_glTF=f}this.gltf=a,this.manifest=null,this.metadata=this.gltf.asset||{},this.metadata.gltf=this.metadata.version||1,this.materials=this.gltfMaterials={name:"GLTF Materials",version:"1.0",scene:{SceneUnit:"m"},materials:{}},this.materialToIndex={},this.materialList=[],this.geomToIndex={},this.geomList=[],this.geomsLoaded=0,this.fragments={length:0,numLoaded:0,boxes:null,transforms:null,materials:null,fragId2dbId:null,entityIndexes:null,mesh2frag:{}},this.geompacks=[],this.instances=[],this.cameras=[],this.lights=[],this.bbox=null,this.animations=null,this.pendingRequests=0,this.globalOffset={x:0,y:0,z:0},this.bbox=new j.LmvBox3,this.nodeToDbId={},this.nextDbId=1,this.nextFragId=0}function f(a,b){return t[0]=a[b],t[1]=a[b+1],t[2]=a[b+2],t[3]=a[b+3],s[0]}Object.defineProperty(b,"__esModule",{value:!0});var g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};b.GltfPackage=e;for(var h=c(27),i=c(28),j=c(29),k=c(30),l=c(2),m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),o=0;o<m.length;o++)n[m.charCodeAt(o)]=o;var p=function(a){var b,c,d,e,f,g=.75*a.length,h=a.length,i=0;"="===a[a.length-1]&&(g--,"="===a[a.length-2]&&g--);var j=new ArrayBuffer(g),k=new Uint8Array(j);for(b=0;b<h;b+=4)c=n[a.charCodeAt(b)],d=n[a.charCodeAt(b+1)],e=n[a.charCodeAt(b+2)],f=n[a.charCodeAt(b+3)],k[i++]=c<<2|d>>4,k[i++]=(15&d)<<4|e>>2,k[i++]=(3&e)<<6|63&f;return j};e.prototype.loadManifest=function(a){var b={name:"LMV Manifest",toolkitversion:"LMVTK 2.6.4",manifestversion:2,adskID:{sourceSystem:"",type:"",id:"",version:""},assets:[],typesets:[]};this.manifest=b;var c=this.gltf.buffers;for(var d in c)if("binary_glTF"!==d){var e=c[d];if(0!==e.uri.indexOf("data:application/octet-stream;base64,")){var f={id:d,URI:e.uri,uri:e.uri,usize:e.byteLength,type:e.type};this.manifest.assets.push(f)}else this.loadedBuffers[d]=p(e.uri.slice("data:application/octet-stream;base64,".length)),e.uri="embed://"+d}var g=this.gltf.images;for(var h in g){var i=g[h],j={id:h,URI:i.uri,uri:i.uri,name:i.name,type:"image"};this.manifest.assets.push(j)}},e.prototype.loadRemainingSvf=function(a){a.manifest&&(this.manifest=a.manifest),this.manifest.assetMap={};for(var b=0;b<this.manifest.assets.length;b++){var c=this.manifest.assets[b];this.manifest.assetMap[c.id]=c}this.processMeshesList(),this.processMaterialsList(),this.deriveInstanceTree(),a.loadDoneCB("svf");for(var d in this.loadedBuffers)this.loadGeometry(a,d);this.loadBuffers(a)},e.prototype.loadBuffers=function(a){function b(e){if(g<d.length-1){var f=d[g+1],h={responseType:f.type||"arraybuffer"};l.ViewingService.getItem(a,a.basePath+f.URI,b,a.onFailureCallback,h)}if(e){var i=d[g];c.loadedBuffers[i.id]=e.buffer,c.loadGeometry(a,i.id)}g++}for(var c=this,d=[],e=this.manifest.assets,f=0;f<e.length;f++)"image"!==e[f].type&&d.push(e[f]);var g=-1;b(null)};var q={5120:1,5121:1,5122:2,5123:2,5124:4,5125:4,5126:4},r={SCALAR:1,VEC2:2,VEC3:3,VEC4:4},s=new Float32Array(1),t=new Uint8Array(s.buffer);e.prototype.loadGeometry=function(a,b){function c(a){var b=g.gltf.accessors[a],c=b.bufferView;if(c){var d=g.gltf.bufferViews[c].buffer;if(d)return!!g.loadedBuffers[d]}return!1}for(var d=this.gltf.buffers[b],e=d.meshes,g=this,i=0;i<e.length;i++)for(var j=this.gltf.meshes[e[i]],k=j.primitives,l=void 0===a.packNormals||a.packNormals,m=0;m<k.length;m++){var n=k[m],j={vblayout:{},vbstride:0,packedNormals:l},o=!0;if(n.indices&&(o=o&&c(n.indices))){var p=g.gltf.accessors[n.indices];j.triangleCount=p.count/3;var s,t,u=p.byteStride,v=2,w=g.gltf.bufferViews[p.bufferView],x=p.byteOffset+w.byteOffset,d=g.loadedBuffers[w.buffer];5123===p.componentType?(t=j.indices=new Uint16Array(p.count),v=2,s=new Uint16Array(d)):5125===p.componentType?(t=j.indices=new Uint32Array(p.count),v=4,s=new Uint32Array(d)):debug("Unimplemented component type for index buffer");var y=x/v;0===u?u=1:u/=v;for(var z=0;z<p.count;z++)t[z]=s[y+z*u]}var A=0;for(var B in n.attributes){o=o&&c(n.attributes[B]);var C=g.gltf.accessors[n.attributes[B]];if(o)if("NORMAL"===B)j.vbstride+=l?1:3,j.vblayout.normal={offset:A,itemSize:l?2:3,bytesPerItem:l?2:4,normalize:l},A+=l?1:3;else{var D=B;if("POSITION"===B)D="position",j.vertexCount=C.count;else if(0===B.indexOf("TEXCOORD")){var E=parseInt(B.split("_")[1]);D="uv"+(E||"")}else 0===B.indexOf("COLOR")&&(D="color");var F=q[C.componentType]*r[C.type];j.vbstride+=F/4,j.vblayout[D]={offset:A,itemSize:r[C.type],bytesPerItem:q[C.componentType],normalize:!1},A+=F/4}}if(o){var G,H=j.vb=new Float32Array(j.vertexCount*j.vbstride);l&&(G=new Uint16Array(j.vb.buffer));for(var B in n.attributes){var C=g.gltf.accessors[n.attributes[B]],w=g.gltf.bufferViews[C.bufferView],x=C.byteOffset+w.byteOffset,I=new Uint8Array(g.loadedBuffers[w.buffer]);if("NORMAL"===B){var J=j.vblayout.normal;C.count!=j.vertexCount&&debug("Normals count does not equal vertex count");for(var u=0!==C.byteStride?C.byteStride:Q*r[C.type],K=x,A=J.offset,z=0;z<j.vertexCount;z++,A+=j.vbstride){var L=f(I,K),M=f(I,K+4),N=f(I,K+8);if(G){var O=.5*(Math.atan2(M,L)/Math.PI+1),P=.5*(N+1);G[2*A]=65535*O|0,G[2*A+1]=65535*P|0}else H[A]=L,H[A+1]=M,H[A+2]=N;K+=u}}else{var D=B;if("POSITION"===B)D="position",j.vertexCount=C.count;else if(0===B.indexOf("TEXCOORD")){var E=parseInt(B.split("_")[1]);D="uv"+(E||"")}else 0===B.indexOf("COLOR")&&(D="color");for(var J=j.vblayout[D],Q=q[C.componentType],u=0!==C.byteStride?C.byteStride:Q*r[C.type],s=new Uint8Array(I),t=new Uint8Array(H.buffer,4*J.offset),K=x,A=0,z=0;z<j.vertexCount;z++){for(var R=0;R<J.itemSize*Q;R++)t[A+R]=s[K+R];A+=j.vbstride*Q,K+=u}}var S=g.gltf.buffers[w.buffer];S.refCount--,0===S.refCount&&delete g.loadedBuffers[w.buffer]}g.geomsLoaded++,h.VBUtils.computeBounds3D(j),a.loadDoneCB("mesh",{mesh:j,packId:e[i],meshIndex:m,progress:g.geomsLoaded/g.geomList.length})}}d.meshes=null},e.prototype.processMaterialsList=function(){var a=this.gltf.materials;for(var b in a){var c=this.materialList.length;this.materialToIndex[b]=c,this.gltfMaterials.materials[c]=a[b],this.materialList.push(b)}},e.prototype.processMeshesList=function(){function a(a){var b=c.gltf.accessors[a],e=b.bufferView;if(e){var g=c.gltf.bufferViews[e].buffer;if(g){var h=c.gltf.buffers[g];h.refCount?h.refCount++:h.refCount=1,h.meshes||(h.meshes=[]),f||(h.meshes.push(d),f=!0)}}}var b=this.gltf.meshes,c=this;for(var d in b)for(var e=b[d],f=!1,g=0;g<e.primitives.length;g++){var h=d+":"+g;this.geomToIndex[h]=this.geomList.length,this.geomList.push(h);var i=e.primitives[g];i.indices&&a(i.indices);for(var j in i.attributes)a(i.attributes[j])}this.numGeoms=this.geomList.length},e.prototype.countFragments=function(){function a(b){var c=b.meshes;if(b.meshes)for(var g=0;g<c.length;g++)for(var h=f.gltf.meshes[c[g]].primitives,i=0;i<h.length;i++)e++;var j=b.children||b.nodes;if(j)for(var k=0;k<j.length;k++){var l=d[j[k]];a(l)}}var b=this.gltf.scene,c=this.gltf.scenes[b],d=this.gltf.nodes,e=0,f=this;a(c),this.fragments.length=e,this.fragments.boxes=new Float32Array(6*e),this.fragments.transforms=new Float32Array(12*e),this.fragments.materials=new Int32Array(e),this.fragments.entityIndexes=new Int32Array(e),this.fragments.fragId2dbId=new Int32Array(e),this.fragments.packIds=new Int32Array(e)},e.prototype.deriveInstanceTree=function(){function a(b,c,m,n){n>f&&(f=n);var o=m.clone();if(c.matrix){var p=new k.LmvMatrix4(!0);p.fromArray(c.matrix),o.multiply(p)}else{var q=c.translation,r=c.rotation,s=c.scale;if(void 0!==q||void 0!==r||void 0!==s){var t=function(a,b,c,d){this.x=a||0,this.y=b||0,this.z=c||0,this.w=d||0},u=q?new i.LmvVector3(q[0],q[1],q[2]):new i.LmvVector3,v=r?new t(r[0],r[1],r[2],r[3]):new t,w=s?new i.LmvVector3(s[0],s[1],s[2]):new i.LmvVector3(1,1,1),p=new k.LmvMatrix4(!0);p.compose(u,v,w),o.multiply(p)}}var x=new j.LmvBox3,y=c.meshes;if(c.meshes){b.fragIds=[];for(var z=0;z<y.length;z++)for(var A=g.gltf.meshes[y[z]].primitives,B=0;B<A.length;B++){var C=y[z]+":"+B,D=g.nextFragId++;b.fragIds.push(D),h.fragId2dbId[D]=b.dbId,h.entityIndexes[D]=g.geomToIndex[C],h.mesh2frag[C]?h.mesh2frag[C].push(D):h.mesh2frag[C]=[D],h.materials[D]=g.materialToIndex[A[B].material];var E=12*D,F=o.elements,G=h.transforms;G[E]=F[0],G[E+1]=F[1],G[E+2]=F[2],G[E+3]=F[4],G[E+4]=F[5],G[E+5]=F[6],G[E+6]=F[8],G[E+7]=F[9],G[E+8]=F[10],G[E+9]=F[12],G[E+10]=F[13],G[E+11]=F[14];var H=A[B].attributes.POSITION;if(H){var I=g.gltf.accessors[H];I.min&&I.max?(l.min.x=I.min[0],l.min.y=I.min[1],l.min.z=I.min[2],l.max.x=I.max[0],l.max.y=I.max[1],l.max.z=I.max[2]):(l.min.x=-.5,l.min.y=-.5,l.min.z=-.5,l.max.x=.5,l.max.y=.5,l.max.z=.5,debug("unknown bbox for mesh, using unit box",y[z])),l.applyMatrix4(o),E=6*D;var J=h.boxes;J[E]=l.min.x,J[E+1]=l.min.y,J[E+2]=l.min.z,J[E+3]=l.max.x,J[E+4]=l.max.y,J[E+5]=l.max.z,x.union(l)}}}var K=c.children||c.nodes;if(K){b.children=[];for(var L=0;L<K.length;L++){var M=d[K[L]],N={name:M.name||K[L],dbId:g.nextDbId++};g.nodeToDbId[K[L]]=N.dbId,b.children.push(N);var O=a(N,M,o,n+1);x.union(O)}}var P=6*b.dbId,J=e;return J[P]=x.min.x,J[P+1]=x.min.y,J[P+2]=x.min.z,J[P+3]=x.max.x,J[P+4]=x.max.y,J[P+5]=x.max.z,x}this.countFragments();var b=this.gltf.scene,c=this.gltf.scenes[b],d=this.gltf.nodes;this.instanceTree={name:b,dbId:this.nextDbId++,children:[]},this.nodeToDbId[b]=this.instanceTree.dbId;var e=[],f=1,g=this,h=this.fragments,l=new j.LmvBox3,m=a(this.instanceTree,c,new k.LmvMatrix4(!0),1);g.bbox.union(m),this.instanceBoxes=new Float32Array(e.length),this.instanceBoxes.set(e),this.objectCount=this.nextDbId,this.maxTreeDepth=f}},function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0});b.VBUtils={deduceUVRepetition:function(a){for(var b in a.vblayout)if(0==b.indexOf("uv")&&0!=b.indexOf("uvw"))for(var c=a.vblayout[b].offset,d=a.vbstride,e=a.vb,f=a.vb.length/d,g=0,h=c;g<f;g++,h+=d){var i=e[h],j=e[h+1];if(i>2||i<0||j>2||j<0){a.vblayout[b].isPattern=!0;break}}},computeBounds3D:function(a){var b,c,d,e,f,g=1/0,h=1/0,i=1/0,j=-1/0,k=-1/0,l=-1/0,m=a.vbstride,n=a.vblayout.position.offset,o=a.vb,p=a.vb.length/m;for(b=0,c=n;b<p;b++,c+=m)d=o[c],e=o[c+1],f=o[c+2],g>d&&(g=d),h>e&&(h=e),i>f&&(i=f),j<d&&(j=d),k<e&&(k=e),l<f&&(l=f);var q=(a.boundingBox={min:{x:g,y:h,z:i},max:{x:j,y:k,z:l}},.5*(g+j)),r=.5*(h+k),s=.5*(i+l),t=a.boundingSphere={};t.center={x:q,y:r,z:s};var u=0;for(b=0,c=n;b<p;b++,c+=m){d=o[c],e=o[c+1],f=o[c+2];var v=d-q,w=e-r,x=f-s,y=v*v+w*w+x*x;y>u&&(u=y)}t.radius=Math.sqrt(u)},bboxUnion:function(a,b){b.min.x<a.min.x&&(a.min.x=b.min.x),b.min.y<a.min.y&&(a.min.y=b.min.y),b.min.z<a.min.z&&(a.min.z=b.min.z),b.max.x>a.max.x&&(a.max.x=b.max.x),b.max.y>a.max.y&&(a.max.y=b.max.y),b.max.z>a.max.z&&(a.max.z=b.max.z)}}},function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var c=b.LmvVector3=function(a,b,c){this.x=a||0,this.y=b||0,this.z=c||0};c.prototype={constructor:c,set:function(a,b,c){return this.x=a,this.y=b,this.z=c,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setZ:function(a){return this.z=a,this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw new Error("index is out of range: "+a)}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+a)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this},add:function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b)):(this.x+=a.x,this.y+=a.y,this.z+=a.z,this)},addScalar:function(a){return this.x+=a,this.y+=a,this.z+=a,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this},addScaledVector:function(a,b){return this.x+=a.x*b,this.y+=a.y*b,this.z+=a.z*b,this},sub:function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b)):(this.x-=a.x,this.y-=a.y,this.z-=a.z,this)},subScalar:function(a){return this.x-=a,this.y-=a,this.z-=a,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this},multiply:function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b)):(this.x*=a.x,this.y*=a.y,this.z*=a.z,this)},multiplyScalar:function(a){return this.x*=a,this.y*=a,this.z*=a,this},multiplyVectors:function(a,b){return this.x=a.x*b.x,this.y=a.y*b.y,this.z=a.z*b.z,this},applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[3]*c+e[6]*d,this.y=e[1]*b+e[4]*c+e[7]*d,this.z=e[2]*b+e[5]*c+e[8]*d,this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[4]*c+e[8]*d+e[12],this.y=e[1]*b+e[5]*c+e[9]*d+e[13],this.z=e[2]*b+e[6]*c+e[10]*d+e[14],this},applyProjection:function(a){var b=this.x,c=this.y,d=this.z,e=a.elements,f=1/(e[3]*b+e[7]*c+e[11]*d+e[15]);return this.x=(e[0]*b+e[4]*c+e[8]*d+e[12])*f,this.y=(e[1]*b+e[5]*c+e[9]*d+e[13])*f,this.z=(e[2]*b+e[6]*c+e[10]*d+e[14])*f,this},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z,h=a.w,i=h*b+f*d-g*c,j=h*c+g*b-e*d,k=h*d+e*c-f*b,l=-e*b-f*c-g*d;return this.x=i*h+l*-e+j*-g-k*-f,this.y=j*h+l*-f+k*-e-i*-g,this.z=k*h+l*-g+i*-f-j*-e,this},transformDirection:function(a){var b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[4]*c+e[8]*d,this.y=e[1]*b+e[5]*c+e[9]*d,this.z=e[2]*b+e[6]*c+e[10]*d,this.normalize(),this},divide:function(a){return this.x/=a.x,this.y/=a.y,this.z/=a.z,this},divideScalar:function(a){if(0!==a){var b=1/a;this.x*=b,this.y*=b,this.z*=b}else this.x=0,this.y=0,this.z=0;return this},min:function(a){return this.x>a.x&&(this.x=a.x),this.y>a.y&&(this.y=a.y),this.z>a.z&&(this.z=a.z),this},max:function(a){return this.x<a.x&&(this.x=a.x),this.y<a.y&&(this.y=a.y),this.z<a.z&&(this.z=a.z),this},clamp:function(a,b){return this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x),this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y),this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z),this},clampScalar:function(){var a,b;return function(d,e){return void 0===a&&(a=new c,b=new c),a.set(d,d,d),b.set(e,e,e),this.clamp(a,b)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();return 0!==b&&a!==b&&this.multiplyScalar(a/b),this},lerp:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a),this},cross:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b);var c=this.x,d=this.y,e=this.z;return this.x=d*a.z-e*a.y,this.y=e*a.x-c*a.z,this.z=c*a.y-d*a.x,this},crossVectors:function(a,b){var c=a.x,d=a.y,e=a.z,f=b.x,g=b.y,h=b.z;return this.x=d*h-e*g,this.y=e*f-c*h,this.z=c*g-d*f,this},projectOnVector:function(){var a,b;return function(d){return void 0===a&&(a=new c),a.copy(d).normalize(),b=this.dot(a),this.copy(a).multiplyScalar(b)}}(),projectOnPlane:function(){var a;return function(b){return void 0===a&&(a=new c),a.copy(this).projectOnVector(b),this.sub(a)}}(),reflect:function(){var a;return function(b){return void 0===a&&(a=new c),this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y,d=this.z-a.z;return b*b+c*c+d*d},setEulerFromRotationMatrix:function(a,b){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(a,b){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(a){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,b){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(a,b)},setFromMatrixPosition:function(a){return this.x=a.elements[12],this.y=a.elements[13],this.z=a.elements[14],this},setFromMatrixScale:function(a){var b=this.set(a.elements[0],a.elements[1],a.elements[2]).length(),c=this.set(a.elements[4],a.elements[5],a.elements[6]).length(),d=this.set(a.elements[8],a.elements[9],a.elements[10]).length();return this.x=b,this.y=c,this.z=d,this},setFromMatrixColumn:function(a,b){var c=4*a,d=b.elements;return this.x=d[c],this.y=d[c+1],this.z=d[c+2],this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){return void 0===b&&(b=0),this.x=a[b],this.y=a[b+1],this.z=a[b+2],this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a},fromAttribute:function(a,b,c){return void 0===c&&(c=0),b=b*a.itemSize+c,this.x=a.array[b],this.y=a.array[b+1],this.z=a.array[b+2],this}}},function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.LmvBox3=void 0;var d=c(28),e=b.LmvBox3=function(a,b){this.min=void 0!==a?a:new d.LmvVector3(1/0,1/0,1/0),this.max=void 0!==b?b:new d.LmvVector3(-1/0,-1/0,-1/0)};e.prototype={constructor:e,set:function(a,b){return this.min.copy(a),this.max.copy(b),this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromArray:function(a,b){return this.min.x=a[b],this.min.y=a[b+1],this.min.z=a[b+2],this.max.x=a[b+3],this.max.y=a[b+4],this.max.z=a[b+5],this},copyToArray:function(a,b){a[b]=this.min.x,a[b+1]=this.min.y,a[b+2]=this.min.z,a[b+3]=this.max.x,a[b+4]=this.max.y,a[b+5]=this.max.z},setFromCenterAndSize:function(){var a=new d.LmvVector3;return function(b,c){var d=a.copy(c).multiplyScalar(.5);return this.min.copy(b).sub(d),this.max.copy(b).add(d),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.min.copy(a.min),this.max.copy(a.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(a){return(a||new d.LmvVector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(a){return(a||new d.LmvVector3).subVectors(this.max,this.min)},expandByPoint:function(a){return this.min.min(a),this.max.max(a),this},expandByVector:function(a){return this.min.sub(a),this.max.add(a),this},expandByScalar:function(a){return this.min.addScalar(-a),this.max.addScalar(a),this},containsPoint:function(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z)},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z},getParameter:function(a,b){return(b||new d.LmvVector3).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z)},clampPoint:function(a,b){return(b||new d.LmvVector3).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new d.LmvVector3
;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){return this.min.max(a.min),this.max.min(a.max),this},union:function(a){return this.min.min(a.min),this.max.max(a.max),this},applyMatrix4:function(){var a=[new d.LmvVector3,new d.LmvVector3,new d.LmvVector3,new d.LmvVector3,new d.LmvVector3,new d.LmvVector3,new d.LmvVector3,new d.LmvVector3];return function(b){return a[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(b),a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b),a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b),a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b),a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b),a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b),a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b),a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b),this.makeEmpty(),this.setFromPoints(a),this}}(),translate:function(a){return this.min.add(a),this.max.add(a),this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}}},function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var c=b.LmvMatrix4=function(a){this.elements=a?new Float64Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]):new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};c.prototype={constructor:c,set:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this.elements;return q[0]=a,q[4]=b,q[8]=c,q[12]=d,q[1]=e,q[5]=f,q[9]=g,q[13]=h,q[2]=i,q[6]=j,q[10]=k,q[14]=l,q[3]=m,q[7]=n,q[11]=o,q[15]=p,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(a){return this.elements.set(a.elements),this},makeRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,g=c+c,h=d+d,i=e+e,j=c*g,k=c*h,l=c*i,m=d*h,n=d*i,o=e*i,p=f*g,q=f*h,r=f*i;return b[0]=1-(m+o),b[4]=k-r,b[8]=l+q,b[1]=k+r,b[5]=1-(j+o),b[9]=n-p,b[2]=l-q,b[6]=n+p,b[10]=1-(j+m),b[3]=0,b[7]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this},multiply:function(a){return this.multiplyMatrices(this,a)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[4],h=c[8],i=c[12],j=c[1],k=c[5],l=c[9],m=c[13],n=c[2],o=c[6],p=c[10],q=c[14],r=c[3],s=c[7],t=c[11],u=c[15],v=d[0],w=d[4],x=d[8],y=d[12],z=d[1],A=d[5],B=d[9],C=d[13],D=d[2],E=d[6],F=d[10],G=d[14],H=d[3],I=d[7],J=d[11],K=d[15];return e[0]=f*v+g*z+h*D+i*H,e[4]=f*w+g*A+h*E+i*I,e[8]=f*x+g*B+h*F+i*J,e[12]=f*y+g*C+h*G+i*K,e[1]=j*v+k*z+l*D+m*H,e[5]=j*w+k*A+l*E+m*I,e[9]=j*x+k*B+l*F+m*J,e[13]=j*y+k*C+l*G+m*K,e[2]=n*v+o*z+p*D+q*H,e[6]=n*w+o*A+p*E+q*I,e[10]=n*x+o*B+p*F+q*J,e[14]=n*y+o*C+p*G+q*K,e[3]=r*v+s*z+t*D+u*H,e[7]=r*w+s*A+t*E+u*I,e[11]=r*x+s*B+t*F+u*J,e[15]=r*y+s*C+t*G+u*K,this},multiplyToArray:function(a,b,c){var d=this.elements;return this.multiplyMatrices(a,b),c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c[6]=d[6],c[7]=d[7],c[8]=d[8],c[9]=d[9],c[10]=d[10],c[11]=d[11],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15],this},multiplyScalar:function(a){var b=this.elements;return b[0]*=a,b[4]*=a,b[8]*=a,b[12]*=a,b[1]*=a,b[5]*=a,b[9]*=a,b[13]*=a,b[2]*=a,b[6]*=a,b[10]*=a,b[14]*=a,b[3]*=a,b[7]*=a,b[11]*=a,b[15]*=a,this},determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],i=a[13],j=a[2],k=a[6],l=a[10],m=a[14];return a[3]*(+e*h*k-d*i*k-e*g*l+c*i*l+d*g*m-c*h*m)+a[7]*(+b*h*m-b*i*l+e*f*l-d*f*m+d*i*j-e*h*j)+a[11]*(+b*i*k-b*g*m-e*f*k+c*f*m+e*g*j-c*i*j)+a[15]*(-d*g*j-b*h*k+b*g*l+d*f*k-c*f*l+c*h*j)},transpose:function(){var a,b=this.elements;return a=b[1],b[1]=b[4],b[4]=a,a=b[2],b[2]=b[8],b[8]=a,a=b[6],b[6]=b[9],b[9]=a,a=b[3],b[3]=b[12],b[12]=a,a=b[7],b[7]=b[13],b[13]=a,a=b[11],b[11]=b[14],b[14]=a,this},flattenToArrayOffset:function(a,b){var c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a[b+9]=c[9],a[b+10]=c[10],a[b+11]=c[11],a[b+12]=c[12],a[b+13]=c[13],a[b+14]=c[14],a[b+15]=c[15],a},setPosition:function(a){var b=this.elements;return b[12]=a.x,b[13]=a.y,b[14]=a.z,this},getInverse:function(a,b){var c=this.elements,d=a.elements,e=d[0],f=d[4],g=d[8],h=d[12],i=d[1],j=d[5],k=d[9],l=d[13],m=d[2],n=d[6],o=d[10],p=d[14],q=d[3],r=d[7],s=d[11],t=d[15];c[0]=k*p*r-l*o*r+l*n*s-j*p*s-k*n*t+j*o*t,c[4]=h*o*r-g*p*r-h*n*s+f*p*s+g*n*t-f*o*t,c[8]=g*l*r-h*k*r+h*j*s-f*l*s-g*j*t+f*k*t,c[12]=h*k*n-g*l*n-h*j*o+f*l*o+g*j*p-f*k*p,c[1]=l*o*q-k*p*q-l*m*s+i*p*s+k*m*t-i*o*t,c[5]=g*p*q-h*o*q+h*m*s-e*p*s-g*m*t+e*o*t,c[9]=h*k*q-g*l*q-h*i*s+e*l*s+g*i*t-e*k*t,c[13]=g*l*m-h*k*m+h*i*o-e*l*o-g*i*p+e*k*p,c[2]=j*p*q-l*n*q+l*m*r-i*p*r-j*m*t+i*n*t,c[6]=h*n*q-f*p*q-h*m*r+e*p*r+f*m*t-e*n*t,c[10]=f*l*q-h*j*q+h*i*r-e*l*r-f*i*t+e*j*t,c[14]=h*j*m-f*l*m-h*i*n+e*l*n+f*i*p-e*j*p,c[3]=k*n*q-j*o*q-k*m*r+i*o*r+j*m*s-i*n*s,c[7]=f*o*q-g*n*q+g*m*r-e*o*r-f*m*s+e*n*s,c[11]=g*j*q-f*k*q-g*i*r+e*k*r+f*i*s-e*j*s,c[15]=f*k*m-g*j*m+g*i*n-e*k*n-f*i*o+e*j*o;var u=e*c[0]+i*c[4]+m*c[8]+q*c[12];if(0==u){var v="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(b)throw new Error(v);return console.warn(v),this.identity(),this}return this.multiplyScalar(1/u),this},scale:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z;return b[0]*=c,b[4]*=d,b[8]*=e,b[1]*=c,b[5]*=d,b[9]*=e,b[2]*=c,b[6]*=d,b[10]*=e,b[3]*=c,b[7]*=d,b[11]*=e,this},makeTranslation:function(a,b,c){return this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1),this},makeRotationX:function(a){var b=Math.cos(a),c=Math.sin(a);return this.set(1,0,0,0,0,b,-c,0,0,c,b,0,0,0,0,1),this},makeRotationY:function(a){var b=Math.cos(a),c=Math.sin(a);return this.set(b,0,c,0,0,1,0,0,-c,0,b,0,0,0,0,1),this},makeRotationZ:function(a){var b=Math.cos(a),c=Math.sin(a);return this.set(b,-c,0,0,c,b,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,i=e*f,j=e*g;return this.set(i*f+c,i*g-d*h,i*h+d*g,0,i*g+d*h,j*g+c,j*h-d*f,0,i*h-d*g,j*h+d*f,e*h*h+c,0,0,0,0,1),this},makeScale:function(a,b,c){return this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1),this},compose:function(a,b,c){return this.makeRotationFromQuaternion(b),this.scale(c),this.setPosition(a),this},transformPoint:function(a){var b=a.x,c=a.y,d=a.z,e=this.elements;return a.x=e[0]*b+e[4]*c+e[8]*d+e[12],a.y=e[1]*b+e[5]*c+e[9]*d+e[13],a.z=e[2]*b+e[6]*c+e[10]*d+e[14],a},transformDirection:function(a){var b=a.x,c=a.y,d=a.z,e=this.elements;a.x=e[0]*b+e[4]*c+e[8]*d,a.y=e[1]*b+e[5]*c+e[9]*d,a.z=e[2]*b+e[6]*c+e[10]*d;var f=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);if(f>0){var g=1/f;a.x*=g,a.y*=g,a.z*=g}return a},fromArray:function(a){return this.elements.set(a),this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]},clone:function(){return new c(this.elements instanceof Float64Array).fromArray(this.elements)}}},function(a,b,c){"use strict";function d(a,b){this.unzip=new p.Unzip(a),this.max_pf_files=b?b.max_pf_files||0:0,this.manifest=null,this.materials=null,this.metadata=null,this.fragments=null,this.geompacks=[],this.instances=[],this.cameras=[],this.lights=[],this.propertydb={attrs:[],avs:[],ids:[],values:[],offsets:[]},this.bbox=null,this.animations=null,this.pendingRequests=0,this.globalOffset={x:0,y:0,z:0},this.topologyPath=null}Object.defineProperty(b,"__esModule",{value:!0}),b.Package=d;var e=c(4),f=c(32),g=c(28),h=c(2),i=c(33),j=c(34),k=c(35),l=c(37),m=c(38),n=c(39),o=c(40),p=c(41).Zlib;d.prototype.loadAsyncResource=function(a,b,c,d){function e(b){f.pendingRequests--,d(b),0==f.pendingRequests&&f.postLoad(a)}if(c)return void d(c);var f=this;this.pendingRequests++,h.ViewingService.getItem(a,a.basePath+b,e,a.onFailureCallback,{asynchronous:!0})},d.prototype.loadManifest=function(a){var b=this.unzip.decompress("manifest.json");if(!b)return!1;var c=new i.InputStream(b);this.manifest=JSON.parse(c.getString(b.byteLength))},d.prototype.parseFragmentList=function(a,b,c,d){var e=this;this.loadAsyncResource(b,c,d,function(a){var c=new j.PackFileReader(a),d=e.fragments=new k.FragList;(0,k.readFragments)(c,d,e.globalOffset,b.placementTransform),c=null})},d.prototype.parseGeometryMetadata=function(a,b,c,d){var e=this;this.loadAsyncResource(b,c,d,function(a){var b=new j.PackFileReader(a);e.geomMetadata={},(0,k.readGeometryMetadata)(b,e.geomMetadata),e.numGeoms=e.geomMetadata.primCounts.length})},d.prototype.parseInstanceTree=function(a,b,c,d){var e=this;this.loadAsyncResource(a,b,c,function(a){var b=new j.PackFileReader(a);e.instanceTransforms=(0,l.readInstanceTree)(b,d)})},d.prototype.loadRemainingSvf=function(a){var b=this,c=this.unzip;this.manifest=a.manifest;var d=this.manifest,f=d.assets,g=c.decompress("metadata.json"),h=new i.InputStream(g);g.byteLength>3&&0!==g[3]&&(this.metadata=JSON.parse(h.getString(g.byteLength)).metadata,(0,m.initPlacement)(this,a)),this.packFileTotalSize=0,this.primitiveCount=0;for(var k=d.typesets,l={},n=0;n<k.length;n++){var o=k[n];l[o.id]=o.types}for(var n=0;n<f.length;n++){var p=f[n];if(!(0,e.isMobileDevice)()||"Set.bin"!==p.id){var q=p.type;0==q.indexOf("Autodesk.CloudPlatform.")&&(q=q.substr(23));var r=p.URI,s=p.typeset?l[p.typeset]:null,t=p.usize||0,u=Math.round(t/1048576*1e5)/1e5|0;if(0!=r.indexOf("embed:/"))if("PackFile"==q){var v=s?s[0].class:null;"Autodesk.CloudPlatform.Geometry"==v&&(this.packFileTotalSize+=t,this.geompacks.push({id:p.id,uri:r,usize:t}))}else"PropertyAttributes"==q?this.propertydb.attrs.push(r):"PropertyAVs"==q?this.propertydb.avs.push(r):"PropertyIDs"==q?this.propertydb.ids.push(r):"PropertyOffsets"==q?this.propertydb.offsets.push(r):"PropertyValues"==q&&this.propertydb.values.push(r);var w=p.URI,x=null;if(0==w.indexOf("embed:/")&&(w=w.substr(7),x=c.decompress(w)),"ProteinMaterials"==q)-1==w.indexOf("Protein")?this.loadAsyncResource(a,w,x,function(a){var c=new i.InputStream(a),d=a.byteLength;b.materials=0<d?JSON.parse(c.getString(d)):null}):this.loadAsyncResource(a,w,x,function(a){var c=new i.InputStream(a),d=a.byteLength;if(0<d)try{b.proteinMaterials=JSON.parse(c.getString(d))}catch(c){for(var e="",f=0;f<a.length;f++)e+=String.fromCharCode(a[f]);try{b.proteinMaterials=JSON.parse(e)}catch(a){console.error("Failed to parse Protein materials file either as UTF8 or ANSI")}}else b.proteinMaterials=null});else if("FragmentList"==q)this.parseFragmentList(p,a,w,x);else if("GeometryMetadataList"==q)this.parseGeometryMetadata(p,a,w,x);else if("PackFile"==q)-1!=w.indexOf("CameraDefinitions.bin")?this.loadAsyncResource(a,w,x,function(a){b.camDefPack=new j.PackFileReader(a)}):-1!=w.indexOf("CameraList.bin")?this.loadAsyncResource(a,w,x,function(a){b.camInstPack=new j.PackFileReader(a)}):-1!=w.indexOf("LightDefinitions.bin")?this.loadAsyncResource(a,w,x,function(a){b.lightDefPack=new j.PackFileReader(a)}):-1!=w.indexOf("LightList.bin")&&this.loadAsyncResource(a,w,x,function(a){b.lightInstPack=new j.PackFileReader(a)});else if("Animations"==q)this.loadAsyncResource(a,w,x,function(a){var c=new i.InputStream(a),d=a.byteLength;0<d?(b.animations=JSON.parse(c.getString(d)),(0,m.transformAnimations)(b)):b.animations=null});else if("Topology"==q)b.topologyPath=a.basePath+w,b.topologySizeMB=u;else if(a.loadInstanceTree&&("InstanceTree"==q||"InstanceTreeTree"==q)){var y=s?s[0].version:1;this.parseInstanceTree(a,w,x,y)}}}0==this.pendingRequests&&this.postLoad(a),delete this.unzip},d.prototype.addTransparencyFlagsToMaterials=function(a){for(var b in a){var c=a[b],d=c.userassets,e=c.materials,f=e[d[0]];c.transparent=f.transparent}},d.prototype.postLoadOfCam=function(a){if(this.camDefPack&&this.camInstPack){for(var b=0,c=this.camInstPack.getEntryCounts();b<c;b++){var d=(0,l.readInstance)(this.camInstPack,b,this.placementTransform,this.globalOffset),e=(0,n.readCameraDefinition)(this.camDefPack,d);d.transform&&(d.transform.transformPoint(e.position),d.transform.transformPoint(e.target),d.transform.transformDirection(e.up));var f=this.bbox;if(f&&!f.containsPoint(e.target)){var h=(new g.LmvVector3).copy(f.center()).distanceTo(e.position),i=(new g.LmvVector3).copy(e.target).sub(e.position).normalize().multiplyScalar(h);e.target=(new g.LmvVector3).copy(e.position).add(i)}this.cameras.push(e)}delete this.camDefPack,delete this.camInstPack}},d.prototype.postLoadOfLight=function(a){if(this.lightDefPack&&this.lightInstPack){for(var b=0,c=this.lightInstPack.getEntryCounts();b<c;b++){var d=(0,l.readInstance)(this.lightInstPack,b,this.placementTransform,this.globalOffset);this.lights.push((0,o.readLightDefinition)(this.lightDefPack,d.definition))}delete this.lightInstPack,delete this.lightDefPack}},d.prototype.postLoadOfFragments=function(a){var b=this.fragments;if(this.geomMetadata){b.polygonCounts=b.geomDataIndexes;var c=this.geomMetadata;void 0!=c.topoIndexes&&(b.topoIndexes=new Int32Array(b.length));for(var d=0,e=b.length;d<e;d++){var f=b.geomDataIndexes[d];b.entityIndexes[d]=c.entityIndexes[f],b.packIds[d]=c.packIds[f],b.polygonCounts[d]=c.primCounts[f],this.primitiveCount+=c.primCounts[f],void 0!=c.topoIndexes&&(b.topoIndexes[d]=c.topoIndexes[f])}b.geomDataIndexes=null,this.geomMetadata=null}this.calculateMesh2Frag(b),this.max_pf_files>0&&this.geompacks.length>this.max_pf_files&&this.geompacks.splice(this.max_pf_files,this.geompacks.length-this.max_pf_files)},d.prototype.calculateMesh2Frag=function(a){for(var b=a.mesh2frag={},c=a.packIds,d=a.entityIndexes,e=0,f=a.length;e<f;e++){var g=c[e]+":"+d[e],h=b[g];void 0===h?b[g]=e:Array.isArray(h)?h.push(e):b[g]=[h,e]}},d.prototype.postLoadOfBBox=function(a){if(!this.bbox||a.placementTransform){this.bbox&&a.placementTransform&&(this.modelBox=this.bbox);for(var b=[1/0,1/0,1/0,-1/0,-1/0,-1/0],c=this.fragments,d=c.boxes,e=0,f=c.length;e<f;e++){var g,h=6*e;for(g=0;g<3;g++)d[h+g]<b[g]&&(b[g]=d[h+g]);for(g=3;g<6;g++)d[h+g]>b[g]&&(b[g]=d[h+g])}this.bbox={min:{x:b[0],y:b[1],z:b[2]},max:{x:b[3],y:b[4],z:b[5]}}}},d.prototype.postLoadOfObjectIds=function(a){var b=a.objectIds;if(null!=b){for(var c=[],d=[],e=0;e<b.length;++e)for(var f=0;f<this.fragments.length;++f)this.fragments.fragId2dbId[f]==b[e]&&(c.push(this.fragments.packIds[f]),d.push(f));for(var g=1,h=c.length,e=1;e<h;){for(;e<h&&c[e]==c[e-1];)++e;if(h==e)break;c[g++]=c[e++]}c.splice(g-1,h-g);for(var i=[],e=0;e<this.geompacks.length;++e)for(var f=0;f<c.length;++f)parseInt(this.geompacks[e].id)==c[f]&&i.push(this.geompacks[e]);this.geompacks=i;var j=(0,k.filterFragments)(this.fragments,d);this.bbox={min:{x:j[0],y:j[1],z:j[2]},max:{x:j[3],y:j[4],z:j[5]}}}},d.prototype.postLoadComplete=function(a){if(a.loadDoneCB("svf"),this.fragments.polygonCounts){var b=performance.now(),c=this.materials?this.materials.materials:null;c&&this.addTransparencyFlagsToMaterials(c),this.bvh=new f.BVHBuilder(this.fragments,c),this.bvh.build(a.bvhOptions);var d=performance.now();a.worker.debug("BVH build time (worker thread):"+(d-b)),a.loadDoneCB("bvh")}a.loadDoneCB("done")},d.prototype.postLoad=function(a){this.postLoadOfCam(a),this.postLoadOfLight(a),this.postLoadOfFragments(a),this.postLoadOfBBox(a),this.postLoadOfObjectIds(a),this.postLoadComplete(a)}},function(a,b){"use strict";function c(a,b){this.bytes_per_node=b?32:36;var c,d;a instanceof ArrayBuffer?(c=a.byteLength/this.bytes_per_node,d=a,this.nodeCount=c):(c=0|a,d=new ArrayBuffer(this.bytes_per_node*c),this.nodeCount=0),this.nodeCapacity=c,this.nodesRaw=d,this.is_lean_node=b,this.node_stride=this.bytes_per_node/4,this.node_stride_short=this.bytes_per_node/2,this.nodesF=new Float32Array(this.nodesRaw),this.nodesI=new Int32Array(this.nodesRaw),this.nodesS=new Uint16Array(this.nodesRaw)}function d(a,b){this.boxes=a.boxes,this.polygonCounts=a.polygonCounts,this.hasPolygonCounts=!!this.polygonCounts,this.materials=a.materials,this.materialDefs=b,this.count=a.length,this.boxStride=6,this.wantSort=!0}function e(a,b,c){this.finfo=c||new d(a,b),this.prim_count=this.finfo.getCount(),this.frags_per_leaf_node=-1,this.frags_per_inner_node=-1,this.nodes=null,this.work_buf=new ArrayBuffer(4*this.prim_count),this.sort_prims=new Int32Array(this.work_buf),this.primitives=new Int32Array(this.prim_count),this.centroids=new Float32Array(f*this.prim_count),this.boxv_o=new Float32Array(6),this.boxc_o=new Float32Array(6),this.boxv_t=new Float32Array(6),this.boxc_t=new Float32Array(6),this.recursion_stack=[]}Object.defineProperty(b,"__esModule",{value:!0}),b.NodeArray=c,b.BVHBuilder=e,c.prototype.setLeftChild=function(a,b){this.nodesI[a*this.node_stride+6]=b},c.prototype.getLeftChild=function(a){return this.nodesI[a*this.node_stride+6]},c.prototype.setPrimStart=function(a,b){this.is_lean_node?this.nodesI[a*this.node_stride+6]=b:this.nodesI[a*this.node_stride+8]=b},c.prototype.getPrimStart=function(a){return this.is_lean_node?this.nodesI[a*this.node_stride+6]:this.nodesI[a*this.node_stride+8]},c.prototype.setPrimCount=function(a,b){this.nodesS[a*this.node_stride_short+14]=b},c.prototype.getPrimCount=function(a){return this.nodesS[a*this.node_stride_short+14]},c.prototype.setFlags=function(a,b,c,d){this.nodesS[a*this.node_stride_short+15]=d<<3|c<<2|3&b},c.prototype.getFlags=function(a){return this.nodesS[a*this.node_stride_short+15]},c.prototype.setBox0=function(a,b){var c=a*this.node_stride,d=this.nodesF;d[c]=b[0],d[c+1]=b[1],d[c+2]=b[2],d[c+3]=b[3],d[c+4]=b[4],d[c+5]=b[5]},c.prototype.getBoxThree=function(a,b){var c=a*this.node_stride,d=this.nodesF;b.min.x=d[c],b.min.y=d[c+1],b.min.z=d[c+2],b.max.x=d[c+3],b.max.y=d[c+4],b.max.z=d[c+5]},c.prototype.getBoxArray=function(a,b,c){var d=a*this.node_stride,e=this.nodesF;c=c||0,b[0+c]=e[d],b[1+c]=e[d+1],b[2+c]=e[d+2],b[3+c]=e[d+3],b[4+c]=e[d+4],b[5+c]=e[d+5]},c.prototype.setBoxThree=function(a,b){var c=a*this.node_stride,d=this.nodesF;d[c]=b.min.x,d[c+1]=b.min.y,d[c+2]=b.min.z,d[c+3]=b.max.x,d[c+4]=b.max.y,d[c+5]=b.max.z},c.prototype.makeEmpty=function(a){var b=a*this.node_stride,c=this.nodesI;c[b+6]=-1,c[b+7]=0,this.is_lean_node||(c[b+8]=-1)},c.prototype.realloc=function(a){if(this.nodeCount+a>this.nodeCapacity){var b=0|3*this.nodeCapacity/2;b<this.nodeCount+a&&(b=this.nodeCount+a);var c=new ArrayBuffer(b*this.bytes_per_node),d=new Int32Array(c);d.set(this.nodesI),this.nodeCapacity=b,this.nodesRaw=c,this.nodesF=new Float32Array(c),this.nodesI=d,this.nodesS=new Uint16Array(c)}},c.prototype.nextNodes=function(a){this.realloc(a);var b=this.nodeCount;this.nodeCount+=a;for(var c=0;c<a;c++)this.makeEmpty(b+c);return b},c.prototype.getRawData=function(){return this.nodesRaw.slice(0,this.nodeCount*this.bytes_per_node)};var f=3,g=1e-5,h=1e-5,i=15,j=16,k=function(){function a(a,b,c,d){a[b]=.5*(c[d]+c[d+3]),a[b+1]=.5*(c[d+1]+c[d+4]),a[b+2]=.5*(c[d+2]+c[d+5])}function b(a,b,c){a[0]>b[c]&&(a[0]=b[c]),a[3]<b[c]&&(a[3]=b[c]),a[1]>b[c+1]&&(a[1]=b[c+1]),a[4]<b[c+1]&&(a[4]=b[c+1]),a[2]>b[c+2]&&(a[2]=b[c+2]),a[5]<b[c+2]&&(a[5]=b[c+2])}function c(a,b,c){a[0]>b[c]&&(a[0]=b[c]),a[1]>b[c+1]&&(a[1]=b[c+1]),a[2]>b[c+2]&&(a[2]=b[c+2]),a[3]<b[c+3]&&(a[3]=b[c+3]),a[4]<b[c+4]&&(a[4]=b[c+4]),a[5]<b[c+5]&&(a[5]=b[c+5])}function d(a,b){a[0]>b[0]&&(a[0]=b[0]),a[1]>b[1]&&(a[1]=b[1]),a[2]>b[2]&&(a[2]=b[2]),a[3]<b[3]&&(a[3]=b[3]),a[4]<b[4]&&(a[4]=b[4]),a[5]<b[5]&&(a[5]=b[5])}function e(a,b,c,d){for(var e=0;e<3;e++)a[b+e]=c[d+3+e]-c[d+e]}function f(a,b){a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5]}function k(a){a[0]=w,a[1]=w,a[2]=w,a[3]=-w,a[4]=-w,a[5]=-w}function l(a,b){var c=a[b+3]-a[b],d=a[b+4]-a[b+1],e=a[b+5]-a[b+2];return c<0||d<0||e<0?0:2*(c*d+d*e+e*c)}function m(a){var b=a[3]-a[0],c=a[4]-a[1],d=a[5]-a[2];return b<0||c<0||d<0?0:2*(b*c+c*d+d*b)}function n(){this.vb_left=new Float32Array(6),this.vb_right=new Float32Array(6),this.cb_left=new Float32Array(6),this.cb_right=new Float32Array(6),this.num_left=0,this.best_split=-1,this.best_cost=-1,this.num_bins=-1}function o(){this.box_bbox=new Float32Array(6),this.box_centroid=new Float32Array(6),this.num_prims=0}function p(){this.BL=new Float32Array(6),this.CL=new Float32Array(6),this.NL=0,this.AL=0}function q(a,d,e,f,g,i,j){for(var k=a.centroids,l=a.primitives,m=a.finfo.boxes,n=a.finfo.boxStride,o=j*(1-h)/i[f],p=g[f],q=a.sort_prims,r=d;r<=e;r++){var s=0|l[r],t=o*(k[3*s+f]-p),u=0|t;u<0?u=0:u>=j&&(u=j-1),q[r]=u,y[u].num_prims++,c(y[u].box_bbox,m,s*n),b(y[u].box_centroid,k,3*s)}}function r(a,b,c,e,g,h,i){if(h[e]<a.scene_epsilon)return void(i.best_cost=1/0);var k=j;k>c-b+1&&(k=c-b+1);var l;for(l=0;l<k;l++)y[l].reset();for(l=0;l<k-1;l++)z[l].reset();i.num_bins=k,q(a,b,c,e,g,h,k),f(z[0].BL,y[0].box_bbox),f(z[0].CL,y[0].box_centroid),z[0].AL=m(z[0].BL),z[0].NL=y[0].num_prims;var n;for(l=1;l<k-1;l++){n=y[l];var o=z[l];f(o.BL,z[l-1].BL),d(o.BL,n.box_bbox),o.AL=m(o.BL),f(o.CL,z[l-1].CL),d(o.CL,n.box_centroid),o.NL=z[l-1].NL+n.num_prims}l=k-1,f(A,y[l].box_bbox),f(B,y[l].box_centroid);var p=m(A),r=y[l].num_prims,s=l,t=p*r+z[l-1].AL*z[l-1].NL;for(f(i.vb_right,A),f(i.cb_right,y[l].box_centroid),f(i.vb_left,z[l-1].BL),f(i.cb_left,z[l-1].CL),i.num_left=z[l-1].NL,l-=1;l>=1;l--){n=y[l],d(A,n.box_bbox),d(B,n.box_centroid),p=m(A),r+=n.num_prims;var u=p*r+z[l-1].AL*z[l-1].NL;u<=t&&(t=u,s=l,f(i.vb_right,A),f(i.cb_right,B),f(i.vb_left,z[l-1].BL),f(i.cb_left,z[l-1].CL),i.num_left=z[l-1].NL)}i.best_split=s,i.best_cost=t}function s(a,b,c,d,e,f,g){var h,i,j=a.primitives,k=a.sort_prims,l=0,m=0|b,n=0|g.best_split;for(h=b;h<=c;h++){var o=0|j[h];k[h]<n?j[m++]=o:k[l++]=o}for(i=0;i<l;i++)j[m+i]=k[i]}function t(a,c,d,f,g,h,i,j){var l=a.primitives,m=a.centroids,n=g-f+1;n>a.frags_per_inner_node&&(n=a.frags_per_inner_node),n>j&&(n=j),c.setPrimStart(d,f),c.setPrimCount(d,n),f+=n,k(h);for(var o=f;o<=g;o++)b(h,m,3*l[o]);e(i,0,h,0);var p=0;return i[1]>i[0]&&(p=1),i[2]>i[p]&&(p=2),p}function u(a,b,c,d,f,g,h,j){e(C,0,g,0);var k=a.nodes,l=h?a.frags_per_leaf_node_transparent:a.frags_per_leaf_node,m=h?a.frags_per_inner_node_transparent:a.frags_per_inner_node,o=a.max_polys_per_node,p=0;C[1]>C[0]&&(p=1),C[2]>C[p]&&(p=2),k.setBox0(b,f);var q=0,u=0,v=d-c+1;if(a.finfo.hasPolygonCounts&&a.frags_per_inner_node)for(var w=v<=a.frags_per_inner_node?d:c+a.frags_per_inner_node-1,x=c;x<=w&&(q+=a.finfo.getPolygonCount(a.primitives[x]),u++,!(q>o));x++);if(v<=l&&q<o||1===v||j>i||C[p]<a.scene_epsilon)return k.setLeftChild(b,-1),k.setPrimStart(b,c),k.setPrimCount(b,d-c+1),void k.setFlags(b,0,0,h?1:0);m&&(p=t(a,k,b,c,d,g,C,u),c+=k.getPrimCount(b));var y=new n;if(r(a,c,d,p,g,C,y),y.num_bins<0)return void k.setPrimCount(b,k.getPrimCount(b)+d-c+1);s(a,c,d,p,g,C,y);var z=k.nextNodes(2),A=.5*(y.vb_left[3+p]+y.vb_left[p]),B=.5*(y.vb_right[3+p]+y.vb_right[p]);k.setFlags(b,p,A<B?0:1,h?1:0),k.setLeftChild(b,z),a.recursion_stack.push([a,z+1,c+y.num_left,d,y.vb_right,y.cb_right,h,j+1]),a.recursion_stack.push([a,z,c,c+y.num_left-1,y.vb_left,y.cb_left,h,j+1])}function v(d){var f=d.boxv_o,h=d.boxc_o,i=d.boxv_t,j=d.boxc_t;k(f),k(h),k(i),k(j);for(var l=d.centroids,m=d.finfo.boxes,n=d.finfo.boxStride,o=0,p=d.prim_count;o<p;o++){var q=d.primitives[o];a(l,3*q,m,n*q),o>=d.first_transparent?(b(j,l,3*q),c(i,m,n*q)):(b(h,l,3*q),c(f,m,n*q))}e(C,0,d.boxv_o,0);var r=Math.max(C[0],C[1],C[2]);d.scene_epsilon=g*r}var w=1/0;n.prototype.reset=function(){this.num_left=0,this.best_split=-1,this.best_cost=-1,this.num_bins=-1},o.prototype.reset=function(){this.num_prims=0,k(this.box_bbox),k(this.box_centroid)},p.prototype.reset=function(){this.NL=0,this.AL=0,k(this.BL),k(this.CL)};var x,y=[];for(x=0;x<j;x++)y.push(new o);var z=[];for(x=0;x<j-1;x++)z.push(new p);var A=new Float32Array(6),B=new Float32Array(6),C=new Float32Array(3);return{bvh_subdivide:u,compute_boxes:v,box_area:l}}();d.prototype.getCount=function(){return this.count},d.prototype.isTransparent=function(a){return!(!this.materialDefs||!this.materialDefs[this.materials[a]])&&this.materialDefs[this.materials[a]].transparent},d.prototype.getPolygonCount=function(a){return this.polygonCounts[a]},e.prototype.sortPrimitives=function(a){var b,c,d=new Float32Array(this.work_buf),e=this.primitives,f=0,g=a;for(b=0,c=this.prim_count;b<c;b++){e[b]=b;var h=this.finfo.isTransparent(b);h&&f++,g?(d[b]=k.box_area(this.finfo.boxes,this.finfo.boxStride*b),h&&(d[b]=-d[b])):d[b]=h?-1:1}if(g)Array.prototype.sort.call(this.primitives,function(a,b){return d[b]-d[a]});else if(f&&f<this.prim_count){var i=new Int32Array(f),j=0,l=0;for(b=0,c=this.prim_count;b<c;b++)d[b]>=0?e[j++]=e[b]:i[l++]=e[b];e.set(i,this.prim_count-f)}this.first_transparent=this.prim_count-f},e.prototype.build=function(a){function b(b,c){a.hasOwnProperty(b)?e[b]=a[b]:e[b]=c}var d=a&&!!a.useSlimNodes,e=this;if(d)b("frags_per_leaf_node",1),b("frags_per_inner_node",0),b("frags_per_leaf_node_transparent",1),b("frags_per_inner_node_transparent",0),b("max_polys_per_node",1/0);else{var f=a.isWeakDevice?.5:1;b("frags_per_leaf_node",0|32*f),b("frags_per_inner_node",0|this.frags_per_leaf_node),b("frags_per_leaf_node_transparent",this.frags_per_leaf_node),b("frags_per_inner_node_transparent",0),b("max_polys_per_node",0|1e4*f)}if(this.nodes&&this.nodes.is_lean_node==d)this.nodes.nodeCount=0;else{for(var g=this.prim_count/this.frags_per_leaf_node,h=1;h<g;)h*=2;this.nodes=new c(h,!!a&&a.useSlimNodes)}this.sortPrimitives(this.finfo.wantSort),k.compute_boxes(this);var i=this.nodes.nextNodes(2);k.bvh_subdivide(this,i,0,this.first_transparent-1,this.boxv_o,this.boxc_o,!1,0);for(var j;this.recursion_stack.length;)j=this.recursion_stack.pop(),k.bvh_subdivide(j[0],j[1],j[2],j[3],j[4],j[5],j[6],j[7]);for(k.bvh_subdivide(this,i+1,this.first_transparent,this.prim_count-1,this.boxv_t,this.boxc_t,!0,0);this.recursion_stack.length;)j=this.recursion_stack.pop(),k.bvh_subdivide(j[0],j[1],j[2],j[3],j[4],j[5],j[6],j[7])}},function(a,b,c){"use strict";function d(a){this.buffer=a,this.offset=0,this.byteLength=a.length}Object.defineProperty(b,"__esModule",{value:!0}),b.InputStream=d;var e=c(7),f=new ArrayBuffer(8),g=new Uint8Array(f),h=new Uint16Array(f),i=new Int32Array(f),j=new Uint32Array(f),k=new Float32Array(f),l=new Float64Array(f);d.prototype.seek=function(a){this.offset=a},d.prototype.getBytes=function(a){var b=new Uint8Array(this.buffer.buffer,this.offset,a);return this.offset+=a,b},d.prototype.getVarints=function(){var a,b=0,c=0;do{a=this.buffer[this.offset++],b|=(127&a)<<c,c+=7}while(128&a);return b},d.prototype.getUint8=function(){return this.buffer[this.offset++]},d.prototype.getUint16=function(){return g[0]=this.buffer[this.offset++],g[1]=this.buffer[this.offset++],h[0]},d.prototype.getInt16=function(){var a=this.getUint16();return a>32767&&(a|=4294901760),a},d.prototype.getInt32=function(){var a=this.buffer,b=g,c=this.offset;return b[0]=a[c],b[1]=a[c+1],b[2]=a[c+2],b[3]=a[c+3],this.offset+=4,i[0]},d.prototype.getUint32=function(){var a=this.buffer,b=g,c=this.offset;return b[0]=a[c],b[1]=a[c+1],b[2]=a[c+2],b[3]=a[c+3],this.offset+=4,j[0]},d.prototype.getFloat32=function(){var a=this.buffer,b=g,c=this.offset;return b[0]=a[c],b[1]=a[c+1],b[2]=a[c+2],b[3]=a[c+3],this.offset+=4,k[0]},d.prototype.getIndicesArray=function(a,b,c){for(var d=this.buffer,e=new Uint8Array(a,b,2*c),f=this.offset,g=0,h=2*c;g<h;g+=2)e[g]=d[f],e[g+1]=d[f+1],f+=4;this.offset=f},d.prototype.getVector3Array=function(a,b,c,d){var e=this.buffer,f=this.offset,g=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);if(3===d&&0===c){var h=12*b;g.set(e.subarray(f,f+h)),this.offset+=h}else{d*=4;for(var i=4*c,j=0;j<b;j++){for(var k=0;k<12;k++)g[i+k]=e[f++];i+=d}this.offset=f}},d.prototype.getVector2Array=function(a,b,c,d){var e=this.buffer,f=new Uint8Array(a.buffer,a.byteOffset,a.byteLength),g=this.offset;d*=4;for(var h=4*c,i=0;i<b;i++){for(var j=0;j<8;j++)f[h+j]=e[g++];h+=d}this.offset=g},d.prototype.getVector4=function(a,b){for(var c=this.buffer,d=g,e=this.offset,f=k,h=0;h<4;h++)d[0]=c[e],d[1]=c[e+1],d[2]=c[e+2],d[3]=c[e+3],a[b+h]=f[0],e+=4;this.offset=e},d.prototype.getFloat64=function(){for(var a=this.buffer,b=g,c=this.offset,d=0;d<8;d++)b[d]=a[c+d];return this.offset+=8,l[0]},d.prototype.getString=function(a){var b=(0,e.utf8ArrayToString)(this.buffer,this.offset,a);return this.offset+=a,b},d.prototype.reset=function(a){this.buffer=a,this.offset=0,this.byteLength=a.length}},function(a,b,c){"use strict";function d(a){var b=this.stream=new e.InputStream(a),c=b.getInt32();this.type=b.getString(c),this.version=b.getInt32(),this.types=null,this.entryOffsets=[];var d=b.offset;b.seek(b.byteLength-8);var f=b.getUint32();this.typesOffset=b.getUint32(),b.seek(this.typesOffset);var g=this.readU32V();this.types=[];for(var h=0;h<g;++h)this.types.push({entryClass:this.readString(),entryType:this.readString(),version:this.readU32V()});b.seek(f);for(var i=this.readU32V(),j=this.entryOffsets,h=0;h<i;++h)j.push(b.getUint32());b.seek(d)}Object.defineProperty(b,"__esModule",{value:!0}),b.PackFileReader=d;var e=c(33),f=c(30);d.prototype.readVarint=function(){var a,b=0,c=0;do{a=this.stream.getUint8(),b|=(127&a)<<c,c+=7}while(128&a);return b},d.prototype.readU32V=d.prototype.readVarint,d.prototype.readU16=function(){return this.stream.getUint16()},d.prototype.readU8=function(){return this.stream.getUint8()},d.prototype.readString=function(){return this.stream.getString(this.readU32V())},d.prototype.readVector3f=function(){var a=this.stream;return{x:a.getFloat32(),y:a.getFloat32(),z:a.getFloat32()}},d.prototype.readF32=function(){return this.stream.getFloat32()},d.prototype.readVector3d=function(){var a={x:0,y:0,z:0};return function(){var b=this.stream;return a.x=b.getFloat64(),a.y=b.getFloat64(),a.z=b.getFloat64(),a}}(),d.prototype.readQuaternionf=function(){var a={x:0,y:0,z:0,w:0};return function(){var b=this.stream;return a.x=b.getFloat32(),a.y=b.getFloat32(),a.z=b.getFloat32(),a.w=b.getFloat32(),a}}(),d.prototype.readMatrix3f=function(){var a=new f.LmvMatrix4;return function(b){b||(b=a);var c=this.stream;b.identity();for(var d=0;d<3;++d)for(var e=0;e<3;++e)b.elements[4*d+e]=c.getFloat32();return b}}(),d.prototype.readTransform=function(){var a={x:1,y:1,z:1},b=new f.LmvMatrix4(!0);return function(c,d,e,g,h,i){var j,k,l=this.stream;switch(l.getUint8()){case 4:b.identity();break;case 0:j=this.readVector3d(),b.makeTranslation(j.x,j.y,j.z);break;case 1:k=this.readQuaternionf(),j=this.readVector3d(),a.x=1,a.y=1,a.z=1,b.compose(j,k,a);break;case 2:var m=l.getFloat32();k=this.readQuaternionf(),j=this.readVector3d(),a.x=m,a.y=m,a.z=m,b.compose(j,k,a);break;case 3:this.readMatrix3f(b),j=this.readVector3d(),b.setPosition(j)}if(i&&(i[0]=b.elements[12],i[1]=b.elements[13],i[2]=b.elements[14]),g&&b.multiplyMatrices(g,b),h&&(b.elements[12]-=h.x,b.elements[13]-=h.y,b.elements[14]-=h.z),void 0===c)return(new f.LmvMatrix4).copy(b);var n=b.elements;d&&(d[e+0]=n[0],d[e+1]=n[1],d[e+2]=n[2],d[e+3]=n[4],d[e+4]=n[5],d[e+5]=n[6],d[e+6]=n[8],d[e+7]=n[9],d[e+8]=n[10],d[e+9]=n[12],d[e+10]=n[13],d[e+11]=n[14])}}(),d.prototype.getEntryCounts=function(){return this.entryOffsets.length},d.prototype.seekToEntry=function(a){if(a>=this.getEntryCounts())return null;this.stream.seek(this.entryOffsets[a]);var b=this.stream.getUint32();return b>=this.types.length?null:this.types[b]},d.prototype.readPathID=function(){var a=this.stream;if(this.version<2){var b=a.getUint16();if(!b)return null;if(a.getUint16(),1==b)return"";for(var c=a.getUint16(),d=2;d<b;++d)c+="/"+a.getUint16()}else{var b=this.readU32V();if(!b)return null;if(this.readU32V(),1==b)return"";for(var c=this.readU32V(),d=2;d<b;++d)c+="/"+this.readU32V()}return c}},function(a,b,c){"use strict";function d(){this.length=0,this.numLoaded=0,this.boxes=null,this.transforms=null,this.materials=null,this.packIds=null,this.entityIndexes=null,this.fragId2dbId=null,this.topoIndexes=null,this.visibilityFlags=null}function e(a,b){var c=b.geomDataIndexes.length,d=a.stream,e=0,f={},g=b.mesh2frag={};b.polygonCounts=b.geomDataIndexes;for(var h=0;h<c;h++){var i=b.geomDataIndexes[h];if(f[i]){var j=f[i];b.polygonCounts[h]=b.polygonCounts[j],b.packIds[h]=b.packIds[j],b.entityIndexes[h]=b.entityIndexes[j],e+=b.polygonCounts[h]}else{if(!a.seekToEntry(i))return;d.getUint8(),d.seek(d.offset+24),b.polygonCounts[h]=d.getUint16(),b.packIds[h]=parseInt(a.readString()),b.entityIndexes[h]=a.readU32V(),e+=b.polygonCounts[h],f[i]=h}var k=b.packIds[h]+":"+b.entityIndexes[h],l=g[k]
;void 0===l?g[k]=h:Array.isArray(l)?l.push(h):g[k]=[l,h]}return b.geomDataIndexes=null,f=null,e}function f(a,b){var c=a.getEntryCounts(),d=a.stream;b.length=c;for(var e,f=b.fragTypes=new Uint8Array(c),g=b.primCounts=new Uint16Array(c),h=b.packIds=new Int32Array(c),i=b.entityIndexes=new Int32Array(c),j=0,k=c;j<k;j++){var l=a.seekToEntry(j);if(!l)return;if(f[j]=d.getUint8(),d.seek(d.offset+24),g[j]=d.getUint16(),h[j]=parseInt(a.readString()),i[j]=a.readU32V(),l.version>2){var m=d.getInt32();if(-1!=m&&void 0===e){e=b.topoIndexes=new Int32Array(c);for(var n=0;n<j;n++)e[n]=-1}void 0!=e&&(e[j]=m)}}}function g(a,b){var c=[];if(!b)return c;for(var d=a.getEntryCounts(),e=a.stream,f=0;f<d;f++){var g=a.seekToEntry(f);if(!g)return;if(g.version>5)return;g.version>4&&a.readU8(),a.readU32V(),g.version>2?a.readU32V():(a.readString(),a.readU32V()),a.readTransform(f,null,12*f);for(var h=0;h<6;h++)e.getFloat32();if(g.version>1){var i=a.readU32V();b.indexOf(i)>=0&&c.push(f)}}return c}function h(a,b,c,d,e){var f=g(a,e),h=f.length?f.length:a.getEntryCounts(),i=a.stream;n&&h>n&&(h=n),b.totalLength=a.getEntryCounts(),b.length=h,b.numLoaded=0;var l,o,p=b.boxes=new Float32Array(6*h),q=b.transforms=new Float32Array(12*h),r=b.materials=new Int32Array(h),s=b.packIds=new Int32Array(h),t=b.entityIndexes=new Int32Array(h),u=b.geomDataIndexes=new Int32Array(h),v=b.fragId2dbId=new Int32Array(h),w=b.visibilityFlags=new Uint16Array(h),x=[0,0,0];d&&(l=new j.LmvBox3,o=new k.LmvMatrix4(!0).fromArray(d.elements));for(var y=0,z=b.length;y<z;y++){var A=f.length?a.seekToEntry(f[y]):a.seekToEntry(y);if(!A)return;if(A.version>5)return;var B=!0;if(A.version>4){B=0!=(1&a.readU8())}if(w[y]=B?m.MeshFlags.MESH_VISIBLE:0,r[y]=a.readU32V(),A.version>2?u[y]=a.readU32V():(s[y]=parseInt(a.readString()),t[y]=a.readU32V()),a.readTransform(y,q,12*y,d,c,x),A.version>3?function(a,b){for(var c=6*a,d=0;d<6;d++)p[c++]=i.getFloat32()+b[d%3]}(y,x):function(a){for(var b=6*a,c=0;c<6;c++)p[b++]=i.getFloat32()}(y),function(a){if(d){var b=6*a;l.setFromArray(p,b),l.applyMatrix4(o),l.copyToArray(p,b)}}(y),c){var C=6*y;p[C++]-=c.x,p[C++]-=c.y,p[C++]-=c.z,p[C++]-=c.x,p[C++]-=c.y,p[C++]-=c.z}A.version>1&&(v[y]=a.readU32V())}b.finishLoading=!0}function i(a,b){a.length=b.length,a.numLoaded=0;for(var c=a.length,d=[1/0,1/0,1/0,-1/0,-1/0,-1/0],e=new Float32Array(6*c),f=new Float32Array(12*c),g=new Int32Array(c),h=new Int32Array(c),i=new Int32Array(c),j=new Uint16Array(c),k={},l=0;l<b.length;++l){for(var m=b[l],n=6*m,o=6*l,p=0;p<6;++p)e[o++]=a.boxes[n++];n=12*m,o=12*l;for(var p=0;p<12;++p)f[o++]=a.transforms[n++];g[l]=a.materials[m],h[l]=a.packIds[m],i[l]=a.entityIndexes[m],j[l]=a.visibilityFlags[m];var q=a.packIds[m]+":"+a.entityIndexes[m],r=k[q];void 0==r?k[q]=l:Array.isArray(r)?r.push(l):k[q]=[r,l];for(var s=6*l,p=0;p<3;++p)e[s+p]<d[p]&&(d[p]=e[s+p]);for(var p=3;p<6;++p)e[s+p]>d[p]&&(d[p]=e[s+p])}return a.boxes=e,a.transforms=f,a.materials=g,a.packIds=h,a.entityIndexes=i,a.mesh2frag=k,a.visibilityFlags=j,d}Object.defineProperty(b,"__esModule",{value:!0}),b.FragList=d,b.readGeometryMetadataIntoFragments=e,b.readGeometryMetadata=f,b.readFragments=h,b.filterFragments=i;var j=c(29),k=c(30),l=c(4),m=c(36),n=((0,l.isMobileDevice)(),null)},function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0});b.MeshFlags={MESH_VISIBLE:1,MESH_HIGHLIGHTED:2,MESH_HIDE:4,MESH_ISLINE:8,MESH_MOVED:16,MESH_TRAVERSED:32,MESH_DRAWN:64,MESH_RENDERFLAG:128,MESH_ISPOINT:256,MESH_ISWIDELINE:512}},function(a,b){"use strict";function c(a,b,c,d){var e=a.seekToEntry(b);if(!e)return null;if(e.version>2)return null;if(e.version>1){0!=(1&a.readU8())}return{definition:a.stream.getUint32(),transform:a.readTransform(void 0,void 0,void 0,c,d),instanceNodePath:a.readPathID()}}function d(a,b){for(var c=[],d=[],f=[],g=[],h=0,i=a.stream;i.offset<i.byteLength-8-1;){if(a.readTransform(h,c,12*h,void 0,void 0,void 0),b<5){i.getUint8()&&i.getUint32()}var j=i.getUint8();if(b>=5){i.getUint8()}if(b>=3&&(d[h]=i.getVarints()),h)switch(j){case e.NT_Inner:break;case e.NT_Geometry:if(b<2){var k=i.getUint16();if(1===k)f[h]=i.getUint32();else if(k>0){for(var l=[],m=0;m<k;m++)l.push(i.getUint32());f[h]=l}}else{var k=i.getVarints();if(1===k)f[h]=i.getVarints();else if(k>0){for(var l=[],m=0;m<k;m++)l.push(i.getVarints());f[h]=l}}break;case e.NT_Camera:case e.NT_Light:i.getUint8()&&i.getUint32();break;default:debug("Unrecognized instance tree node type.")}var n=0;j===e.NT_Inner&&(n=b<2?i.getUint16():i.getVarints()),g[h]=n,h++}var o=new Uint32Array(d.length);o.set(d);var p=new Float32Array(c.length);p.set(c);var q=new Uint32Array(g.length);return q.set(g),{dbIds:o,fragIds:f,transforms:p,childCounts:q}}Object.defineProperty(b,"__esModule",{value:!0}),b.readInstance=c,b.readInstanceTree=d;var e={NT_Inner:0,NT_Geometry:1,NT_Camera:2,NT_Light:3}},function(a,b,c){"use strict";function d(a){switch(a){case"meter":case"meters":case"m":return 1;case"feet and inches":case"foot":case"feet":case"ft":return.3048;case"inch":case"inches":case"in":return.0254;case"centimeter":case"centimeters":case"cm":return.01;case"millimeter":case"millimeters":case"mm":return.001;default:return 1}}function e(a){for(var b=a.elements,c=0;c<4;c++)for(var d=0;d<4;d++)if(c===d){if(1!==b[4*c+d])return!1}else if(0!==b[4*c+d])return!1;return!0}function f(a,b){if(a.placementTransform=b.placementTransform,b.applyScaling){var c="m";a.metadata["distance unit"]&&(c=a.metadata["distance unit"].value),a.scalingUnit=c,"object"===j(b.applyScaling)?(b.applyScaling.from&&(c=b.applyScaling.from),b.applyScaling.to&&(a.scalingUnit=b.applyScaling.to)):a.scalingUnit=b.applyScaling;var f=d(c)/d(a.scalingUnit);if(1!=f){var g=new m.LmvMatrix4(!0),h=new m.LmvMatrix4(!0);h.elements[0]=f,h.elements[5]=f,h.elements[10]=f,b.placementTransform&&g.copy(b.placementTransform),a.placementTransform=b.placementTransform=g.multiply(h)}}var i=a.metadata["custom values"];if(i&&i.refPointTransform){a.refPointTransform=new m.LmvMatrix4(!0);var k=a.refPointTransform.elements,l=i.refPointTransform;k[0]=l[0],k[1]=l[1],k[2]=l[2],k[4]=l[3],k[5]=l[4],k[6]=l[5],k[8]=l[6],k[9]=l[7],k[10]=l[8],k[12]=l[9],k[13]=l[10],k[14]=l[11]}else{var n=a.metadata.georeference,o=n&&n.refPointLMV,p=0;if(i&&i.hasOwnProperty("angleToTrueNorth")&&(p=Math.PI/180*i.angleToTrueNorth),o||p){var q=new m.LmvMatrix4(!0),r=q.elements;r[0]=r[5]=Math.cos(p),r[1]=-Math.sin(p),r[4]=Math.sin(p),o&&(r[12]=o[0],r[13]=o[1],r[14]=o[2]),a.refPointTransform=q}}if(b.applyRefPoint&&a.refPointTransform){var s=new m.LmvMatrix4(!0);b.placementTransform&&s.copy(b.placementTransform),s.multiply(a.refPointTransform),a.placementTransform=b.placementTransform=s}else!b.applyRefPoint&&b.placementTransform&&(a.placementTransform=(new m.LmvMatrix4).copy(b.placementTransform));return a.placementTransform&&e(a.placementTransform)&&(a.placementTransform=null),a.placementTransform}function g(a,b){if(a.metadata){var c=a.metadata["world bounding box"],d=new k.LmvVector3(c.minXYZ[0],c.minXYZ[1],c.minXYZ[2]),e=new k.LmvVector3(c.maxXYZ[0],c.maxXYZ[1],c.maxXYZ[2]);a.bbox=new l.LmvBox3(d,e),a.globalOffset=b.globalOffset||{x:.5*(d.x+e.x),y:.5*(d.y+e.y),z:.5*(d.z+e.z)};var g=f(a,b),h=a.globalOffset;if(h.x||h.y||h.z){if(g){var i=new m.LmvMatrix4(!0);i.copy(g),g=i,g.elements[12]-=h.x,g.elements[13]-=h.y,g.elements[14]-=h.z}else g=new m.LmvMatrix4(!0),g.makeTranslation(-h.x,-h.y,-h.z);a.placementWithOffset=g}else a.placementWithOffset=g;g&&a.bbox.applyMatrix4(g),a.metadata.hasOwnProperty("double sided geometry")&&a.metadata["double sided geometry"].value&&(a.doubleSided=!0)}}function h(a,b){a[0]-=b.x,a[1]-=b.y,a[2]-=b.z}function i(a){if(a.animations){var b=a.animations.animations;if(b)for(var c=a.globalOffset,d=(new m.LmvMatrix4).makeTranslation(c.x,c.y,c.z),e=(new m.LmvMatrix4).makeTranslation(-c.x,-c.y,-c.z),f=new m.LmvMatrix4,g=new m.LmvMatrix4,i=0;i<b.length;i++){var j=b[i];if(j.hierarchy)for(var k=0;k<j.hierarchy.length;k++){var l=j.hierarchy[k].keys;if(l)for(var n=0;n<l.length;n++){var o=l[n].pos;if(o){var p=c,q=l[n].rot;q&&(f.makeRotationFromQuaternion({x:q[0],y:q[1],z:q[2],w:q[3]}),g.multiplyMatrices(d,f).multiply(e),p={x:g.elements[12],y:g.elements[13],z:g.elements[14]}),h(o,p)}var r=l[n].target;r&&h(r,c);var s=l[n].points;if(s)for(var t=0;t<s.length;t++)h(s[t],c)}}}}}Object.defineProperty(b,"__esModule",{value:!0});var j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};b.derivePlacementTransform=f,b.initPlacement=g,b.transformAnimations=i;var k=c(28),l=c(29),m=c(30)},function(a,b){"use strict";function c(a,b){var c=b.definition,d=a.seekToEntry(c);if(!d)return null;if(d.version>2)return null;var e=a.stream,f={isPerspective:!e.getUint8(),position:a.readVector3f(),target:a.readVector3f(),up:a.readVector3f(),aspect:e.getFloat32(),fov:e.getFloat32()*(180/Math.PI)};return d.version<2&&(e.getFloat32(),e.getFloat32()),f.orthoScale=e.getFloat32(),f}Object.defineProperty(b,"__esModule",{value:!0}),b.readCameraDefinition=c},function(a,b){"use strict";function c(a,b){var c=a.seekToEntry(b);if(!c)return null;if(c.version>1)return null;var d=a.stream;return{position:a.readVector3f(),dir:a.readVector3f(),r:d.getFloat32(),g:d.getFloat32(),b:d.getFloat32(),intensity:d.getFloat32(),spotAngle:d.getFloat32(),size:d.getFloat32(),type:d.getUint8()}}Object.defineProperty(b,"__esModule",{value:!0}),b.readLightDefinition=c},function(a,b){/** @license zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */
(function(){"use strict";function a(a){throw a}function b(a,b){var c=a.split("."),d=p;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||b===o?d=d[e]?d[e]:d[e]={}:d[e]=b}function c(a){var b,c,d,e,f,g,h,i,j,k=a.length,l=0,m=Number.POSITIVE_INFINITY;for(i=0;i<k;++i)a[i]>l&&(l=a[i]),a[i]<m&&(m=a[i]);for(b=1<<l,c=new(q?Uint32Array:Array)(b),d=1,e=0,f=2;d<=l;){for(i=0;i<k;++i)if(a[i]===d){for(g=0,h=e,j=0;j<d;++j)g=g<<1|1&h,h>>=1;for(j=g;j<b;j+=f)c[j]=d<<16|i;++e}++d,e<<=1,f<<=1}return[c,l,m]}function d(b,c){switch(this.l=[],this.m=32768,this.d=this.f=this.c=this.t=0,this.input=q?new Uint8Array(b):b,this.u=!1,this.n=A,this.K=!1,!c&&(c={})||(c.index&&(this.c=c.index),c.bufferSize&&(this.m=c.bufferSize),c.bufferType&&(this.n=c.bufferType),c.resize&&(this.K=c.resize)),this.n){case z:this.a=32768,this.b=new(q?Uint8Array:Array)(32768+this.m+258);break;case A:this.a=0,this.b=new(q?Uint8Array:Array)(this.m),this.e=this.W,this.B=this.R,this.q=this.V;break;default:a(Error("invalid inflate mode"))}}function e(b,c){for(var d,e=b.f,f=b.d,g=b.input,h=b.c;f<c;)d=g[h++],d===o&&a(Error("input buffer is broken")),e|=d<<f,f+=8;return d=e&(1<<c)-1,b.f=e>>>c,b.d=f-c,b.c=h,d}function f(a,b){for(var c,d,e,f=a.f,g=a.d,h=a.input,i=a.c,j=b[0],k=b[1];g<k&&(c=h[i++])!==o;)f|=c<<g,g+=8;return d=j[f&(1<<k)-1],e=d>>>16,a.f=f>>e,a.d=g-e,a.c=i,65535&d}function g(a){function b(a,b,c){var d,g,h,i;for(i=0;i<a;)switch(d=f(this,b)){case 16:for(h=3+e(this,2);h--;)c[i++]=g;break;case 17:for(h=3+e(this,3);h--;)c[i++]=0;g=0;break;case 18:for(h=11+e(this,7);h--;)c[i++]=0;g=0;break;default:g=c[i++]=d}return c}var d,g,h,i,j=e(a,5)+257,k=e(a,5)+1,l=e(a,4)+4,m=new(q?Uint8Array:Array)(E.length);for(i=0;i<l;++i)m[E[i]]=e(a,3);d=c(m),g=new(q?Uint8Array:Array)(j),h=new(q?Uint8Array:Array)(k),a.q(c(b.call(a,j,d,g)),c(b.call(a,k,d,h)))}function h(a){a=a||{},this.files=[],this.v=a.comment}function i(a,b){b=b||{},this.input=q&&a instanceof Array?new Uint8Array(a):a,this.c=0,this.ba=b.verify||!1,this.j=b.password}function j(a,b){this.input=a,this.offset=b}function k(a,b){this.input=a,this.offset=b}function l(b){var c,d,e,f,g=[],h={};if(!b.i){if(b.o===o){var i,k=b.input;if(!b.D)a:{var l,m=b.input;for(l=m.length-12;0<l;--l)if(m[l]===W[0]&&m[l+1]===W[1]&&m[l+2]===W[2]&&m[l+3]===W[3]){b.D=l;break a}a(Error("End of Central Directory Record not found"))}i=b.D,(k[i++]!==W[0]||k[i++]!==W[1]||k[i++]!==W[2]||k[i++]!==W[3])&&a(Error("invalid signature")),b.ha=k[i++]|k[i++]<<8,b.ja=k[i++]|k[i++]<<8,b.ka=k[i++]|k[i++]<<8,b.aa=k[i++]|k[i++]<<8,b.Q=(k[i++]|k[i++]<<8|k[i++]<<16|k[i++]<<24)>>>0,b.o=(k[i++]|k[i++]<<8|k[i++]<<16|k[i++]<<24)>>>0,b.w=k[i++]|k[i++]<<8,b.v=q?k.subarray(i,i+b.w):k.slice(i,i+b.w)}for(c=b.o,e=0,f=b.aa;e<f;++e)d=new j(b.input,c),d.parse(),c+=d.length,g[e]=d,h[d.filename]=e;b.Q<c-b.o&&a(Error("invalid file header size")),b.i=g,b.G=h}}function m(a,b,c){return c^=a.s(b),a.k(b,c),c}var n,o=void 0,p=this,q="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array;new(q?Uint8Array:Array)(256);var r;for(r=0;256>r;++r)for(var s=r,t=7,s=s>>>1;s;s>>>=1)--t;var u,v=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],w=q?new Uint32Array(v):v,x=[];for(u=0;288>u;u++)switch(!0){case 143>=u:x.push([u+48,8]);break;case 255>=u:x.push([u-144+400,9]);break;case 279>=u:x.push([u-256+0,7]);break;case 287>=u:x.push([u-280+192,8]);break;default:a("invalid literal: "+u)}var y=function(){var b,c,d=[];for(b=3;258>=b;b++)c=function(b){switch(!0){case 3===b:return[257,b-3,0];case 4===b:return[258,b-4,0];case 5===b:return[259,b-5,0];case 6===b:return[260,b-6,0];case 7===b:return[261,b-7,0];case 8===b:return[262,b-8,0];case 9===b:return[263,b-9,0];case 10===b:return[264,b-10,0];case 12>=b:return[265,b-11,1];case 14>=b:return[266,b-13,1];case 16>=b:return[267,b-15,1];case 18>=b:return[268,b-17,1];case 22>=b:return[269,b-19,2];case 26>=b:return[270,b-23,2];case 30>=b:return[271,b-27,2];case 34>=b:return[272,b-31,2];case 42>=b:return[273,b-35,3];case 50>=b:return[274,b-43,3];case 58>=b:return[275,b-51,3];case 66>=b:return[276,b-59,3];case 82>=b:return[277,b-67,4];case 98>=b:return[278,b-83,4];case 114>=b:return[279,b-99,4];case 130>=b:return[280,b-115,4];case 162>=b:return[281,b-131,5];case 194>=b:return[282,b-163,5];case 226>=b:return[283,b-195,5];case 257>=b:return[284,b-227,5];case 258===b:return[285,b-258,0];default:a("invalid length: "+b)}}(b),d[b]=c[2]<<24|c[1]<<16|c[0];return d}();q&&new Uint32Array(y);var z=0,A=1;d.prototype.r=function(){for(;!this.u;){var b=e(this,3);switch(1&b&&(this.u=!0),b>>>=1){case 0:var c=this.input,d=this.c,f=this.b,h=this.a,i=o,j=o,k=o,l=f.length,m=o;switch(this.d=this.f=0,i=c[d++],i===o&&a(Error("invalid uncompressed block header: LEN (first byte)")),j=i,i=c[d++],i===o&&a(Error("invalid uncompressed block header: LEN (second byte)")),j|=i<<8,i=c[d++],i===o&&a(Error("invalid uncompressed block header: NLEN (first byte)")),k=i,i=c[d++],i===o&&a(Error("invalid uncompressed block header: NLEN (second byte)")),k|=i<<8,j===~k&&a(Error("invalid uncompressed block header: length verify")),d+j>c.length&&a(Error("input buffer is broken")),this.n){case z:for(;h+j>f.length;){if(m=l-h,j-=m,q)f.set(c.subarray(d,d+m),h),h+=m,d+=m;else for(;m--;)f[h++]=c[d++];this.a=h,f=this.e(),h=this.a}break;case A:for(;h+j>f.length;)f=this.e({H:2});break;default:a(Error("invalid inflate mode"))}if(q)f.set(c.subarray(d,d+j),h),h+=j,d+=j;else for(;j--;)f[h++]=c[d++];this.c=d,this.a=h,this.b=f;break;case 1:this.q(Q,S);break;case 2:g(this);break;default:a(Error("unknown BTYPE: "+b))}}return this.B()};var B,C,D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],E=q?new Uint16Array(D):D,F=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],G=q?new Uint16Array(F):F,H=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],I=q?new Uint8Array(H):H,J=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],K=q?new Uint16Array(J):J,L=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],M=q?new Uint8Array(L):L,N=new(q?Uint8Array:Array)(288);for(B=0,C=N.length;B<C;++B)N[B]=143>=B?8:255>=B?9:279>=B?7:8;var O,P,Q=c(N),R=new(q?Uint8Array:Array)(30);for(O=0,P=R.length;O<P;++O)R[O]=5;var S=c(R);n=d.prototype,n.q=function(a,b){var c=this.b,d=this.a;this.C=a;for(var g,h,i,j,k=c.length-258;256!==(g=f(this,a));)if(256>g)d>=k&&(this.a=d,c=this.e(),d=this.a),c[d++]=g;else for(h=g-257,j=G[h],0<I[h]&&(j+=e(this,I[h])),g=f(this,b),i=K[g],0<M[g]&&(i+=e(this,M[g])),d>=k&&(this.a=d,c=this.e(),d=this.a);j--;)c[d]=c[d++-i];for(;8<=this.d;)this.d-=8,this.c--;this.a=d},n.V=function(a,b){var c=this.b,d=this.a;this.C=a;for(var g,h,i,j,k=c.length;256!==(g=f(this,a));)if(256>g)d>=k&&(c=this.e(),k=c.length),c[d++]=g;else for(h=g-257,j=G[h],0<I[h]&&(j+=e(this,I[h])),g=f(this,b),i=K[g],0<M[g]&&(i+=e(this,M[g])),d+j>k&&(c=this.e(),k=c.length);j--;)c[d]=c[d++-i];for(;8<=this.d;)this.d-=8,this.c--;this.a=d},n.e=function(){var a,b,c=new(q?Uint8Array:Array)(this.a-32768),d=this.a-32768,e=this.b;if(q)c.set(e.subarray(32768,c.length));else for(a=0,b=c.length;a<b;++a)c[a]=e[a+32768];if(this.l.push(c),this.t+=c.length,q)e.set(e.subarray(d,d+32768));else for(a=0;32768>a;++a)e[a]=e[d+a];return this.a=32768,e},n.W=function(a){var b,c,d,e,f=this.input.length/this.c+1|0,g=this.input,h=this.b;return a&&("number"==typeof a.H&&(f=a.H),"number"==typeof a.P&&(f+=a.P)),2>f?(c=(g.length-this.c)/this.C[2],e=c/2*258|0,d=e<h.length?h.length+e:h.length<<1):d=h.length*f,q?(b=new Uint8Array(d),b.set(h)):b=h,this.b=b},n.B=function(){var a,b,c,d,e,f=0,g=this.b,h=this.l,i=new(q?Uint8Array:Array)(this.t+(this.a-32768));if(0===h.length)return q?this.b.subarray(32768,this.a):this.b.slice(32768,this.a);for(b=0,c=h.length;b<c;++b)for(a=h[b],d=0,e=a.length;d<e;++d)i[f++]=a[d];for(b=32768,c=this.a;b<c;++b)i[f++]=g[b];return this.l=[],this.buffer=i},n.R=function(){var a,b=this.a;return q?this.K?(a=new Uint8Array(b),a.set(this.b.subarray(0,b))):a=this.b.subarray(0,b):(this.b.length>b&&(this.b.length=b),a=this.b),this.buffer=a},h.prototype.L=function(a){this.j=a},h.prototype.s=function(a){var b=65535&a[2]|2;return b*(1^b)>>8&255},h.prototype.k=function(a,b){a[0]=(w[255&(a[0]^b)]^a[0]>>>8)>>>0,a[1]=1+(6681*(20173*(a[1]+(255&a[0]))>>>0)>>>0)>>>0,a[2]=(w[255&(a[2]^a[1]>>>24)]^a[2]>>>8)>>>0},h.prototype.T=function(a){var b,c,d=[305419896,591751049,878082192];for(q&&(d=new Uint32Array(d)),b=0,c=a.length;b<c;++b)this.k(d,255&a[b]);return d};var T={O:0,M:8},U=[80,75,1,2],V=[80,75,3,4],W=[80,75,5,6];j.prototype.parse=function(){var b=this.input,c=this.offset;(b[c++]!==U[0]||b[c++]!==U[1]||b[c++]!==U[2]||b[c++]!==U[3])&&a(Error("invalid file header signature")),this.version=b[c++],this.ia=b[c++],this.Z=b[c++]|b[c++]<<8,this.I=b[c++]|b[c++]<<8,this.A=b[c++]|b[c++]<<8,this.time=b[c++]|b[c++]<<8,this.U=b[c++]|b[c++]<<8,this.p=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0,this.z=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0,this.J=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0,this.h=b[c++]|b[c++]<<8,this.g=b[c++]|b[c++]<<8,this.F=b[c++]|b[c++]<<8,this.ea=b[c++]|b[c++]<<8,this.ga=b[c++]|b[c++]<<8,this.fa=b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24,this.$=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0,this.filename=String.fromCharCode.apply(null,q?b.subarray(c,c+=this.h):b.slice(c,c+=this.h)),this.X=q?b.subarray(c,c+=this.g):b.slice(c,c+=this.g),this.v=q?b.subarray(c,c+this.F):b.slice(c,c+this.F),this.length=c-this.offset};var X={N:1,ca:8,da:2048};k.prototype.parse=function(){var b=this.input,c=this.offset;(b[c++]!==V[0]||b[c++]!==V[1]||b[c++]!==V[2]||b[c++]!==V[3])&&a(Error("invalid local file header signature")),this.Z=b[c++]|b[c++]<<8,this.I=b[c++]|b[c++]<<8,this.A=b[c++]|b[c++]<<8,this.time=b[c++]|b[c++]<<8,this.U=b[c++]|b[c++]<<8,this.p=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0,this.z=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0,this.J=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0,this.h=b[c++]|b[c++]<<8,this.g=b[c++]|b[c++]<<8,this.filename=String.fromCharCode.apply(null,q?b.subarray(c,c+=this.h):b.slice(c,c+=this.h)),this.X=q?b.subarray(c,c+=this.g):b.slice(c,c+=this.g),this.length=c-this.offset},n=i.prototype,n.Y=function(){var a,b,c,d=[];for(this.i||l(this),c=this.i,a=0,b=c.length;a<b;++a)d[a]=c[a].filename;return d},n.r=function(b,c){var e;this.G||l(this),(e=this.G[b])===o&&a(Error(b+" not found"));var f;f=c||{};var g,h,i,j,n,p,r,s,t=this.input,u=this.i;if(u||l(this),u[e]===o&&a(Error("wrong index")),h=u[e].$,g=new k(this.input,h),g.parse(),h+=g.length,i=g.z,0!=(g.I&X.N)){for(!f.password&&!this.j&&a(Error("please set password")),p=this.S(f.password||this.j),r=h,s=h+12;r<s;++r)m(this,p,t[r]);for(h+=12,i-=12,r=h,s=h+i;r<s;++r)t[r]=m(this,p,t[r])}switch(g.A){case T.O:j=q?this.input.subarray(h,h+i):this.input.slice(h,h+i);break;case T.M:j=new d(this.input,{index:h,bufferSize:g.J}).r();break;default:a(Error("unknown compression type"))}if(this.ba){var v,x=o,y="number"==typeof x?x:x=0,z=j.length;for(v=-1,y=7&z;y--;++x)v=v>>>8^w[255&(v^j[x])];for(y=z>>3;y--;x+=8)v=v>>>8^w[255&(v^j[x])],v=v>>>8^w[255&(v^j[x+1])],v=v>>>8^w[255&(v^j[x+2])],v=v>>>8^w[255&(v^j[x+3])],v=v>>>8^w[255&(v^j[x+4])],v=v>>>8^w[255&(v^j[x+5])],v=v>>>8^w[255&(v^j[x+6])],v=v>>>8^w[255&(v^j[x+7])];n=(4294967295^v)>>>0,g.p!==n&&a(Error("wrong crc: file=0x"+g.p.toString(16)+", data=0x"+n.toString(16)))}return j},n.L=function(a){this.j=a},n.k=h.prototype.k,n.S=h.prototype.T,n.s=h.prototype.s,b("Zlib.Unzip",i),b("Zlib.Unzip.prototype.decompress",i.prototype.r),b("Zlib.Unzip.prototype.getFilenames",i.prototype.Y),b("Zlib.Unzip.prototype.setPassword",i.prototype.L)}).call(this)},function(a,b,c){"use strict";function d(a){h.Package.call(this,a),this.memoryOptimizedMode=!1,this.pendingGeometryMetadataLoad={}}Object.defineProperty(b,"__esModule",{value:!0}),b.PackageLess=d;var e=c(4),f=c(2),g=c(32),h=c(31),i=c(43),j=c(35),k=(0,e.isMobileDevice)()?6291456:33554432;d.prototype=Object.create(h.Package.prototype),d.prototype.constructor=d,d.prototype.loadAsyncResource=function(a,b,c,d,e){function g(b){h.pendingRequests--,d(b),0==h.pendingRequests&&h.postLoad(a)}if(c)return void d(c);var h=this;this.pendingRequests++,f.ViewingService.getItem(a,a.basePath+b,g,a.onFailureCallback,{asynchronous:!0,skipDecompress:e})},d.prototype.parseFragmentList=function(a,b,c,d){this.memoryOptimizedMode=b.perfOpt.forceMemoryOptimizedMode||a.size>k,debug("PackageLess: memory optimized mode: "+this.memoryOptimizedMode);var e=this;if(this.loadAsyncResource(b,c,d,function(c){var d=a.usize,f=new i.PackFileReaderLess(c,d),g=e.fragments=new j.FragList;(0,j.readFragments)(f,g,e.globalOffset,b.placementTransform,b.objectIds),f=null,e.memoryOptimizedMode&&e.pendingGeometryMetadataLoad.path&&e.loadAsyncResource(b,e.pendingGeometryMetadataLoad.path,e.pendingGeometryMetadataLoad.contents,function(a){var b=new i.PackFileReaderLess(a,e.pendingGeometryMetadataLoad.usize);debug("PackageLess: read geometry metadata into fragment directly."),e.primitiveCount=(0,j.readGeometryMetadataIntoFragments)(b,e.fragments),e.numGeoms=b.getEntryCounts(),b=null,e.pendingGeometryMetadataLoad.contents=null},e.memoryOptimizedMode)},e.memoryOptimizedMode),!this.memoryOptimizedMode&&this.pendingGeometryMetadataLoad.path){var c=this.pendingGeometryMetadataLoad.path,d=this.pendingGeometryMetadataLoad.contents;this.pendingGeometryMetadataLoad={},debug("PackageLess: read geometry metadata as usual."),h.Package.prototype.parseGeometryMetadata.call(this,null,b,c,d)}},d.prototype.parseGeometryMetadata=function(a,b,c,d){var e=a.usize;if(this.fragments){var f=this;this.loadAsyncResource(b,c,d,function(a){var b=new i.PackFileReaderLess(a,e);f.primitiveCount=(0,j.readGeometryMetadataIntoFragments)(b,f.fragments),f.numGeoms=b.getEntryCounts(),b=null},f.memoryOptimizedMode)}else this.pendingGeometryMetadataLoad.path=c,this.pendingGeometryMetadataLoad.contents=d,this.pendingGeometryMetadataLoad.usize=e},d.prototype.postLoadOfFragments=function(a){this.memoryOptimizedMode?this.fragments.mesh2frag||this.calculateMesh2Frag(this.fragments):h.Package.prototype.postLoadOfFragments.call(this,a)},d.prototype.postLoadOfObjectIds=function(a){if(this.memoryOptimizedMode){if(a.objectIds&&a.objectIds.length>0){var b=this.geompacks.length,c=this.fragments,d=0,e=new Int8Array(b);for(d=0;d<c.packIds.length;d++)e[c.packIds[d]]=15;var f=0;for(d=0;d<e.length;d++)15===e[d]&&(this.geompacks[f]=this.geompacks[d],f++);f<b&&this.geompacks.splice(f,b-f)}}else h.Package.prototype.postLoadOfObjectIds.call(this,a)},d.prototype.postLoadComplete=function(a){if(this.memoryOptimizedMode){if(this.fragments.polygonCounts){var b=performance.now(),c=this.materials?this.materials.materials:null;c&&this.addTransparencyFlagsToMaterials(c),this.bvh=new g.BVHBuilder(this.fragments,c),this.bvh.build(a.bvhOptions);var d=performance.now();a.worker.debug("BVH build time (worker thread):"+(d-b))}a.loadDoneCB("svf"),a.loadDoneCB("done")}else h.Package.prototype.postLoadComplete.call(this,a)}},function(a,b,c){"use strict";function d(a,b){var c,d=!1;if(31==a[0]&&139==a[1])if(b){d=!0,c=new g.InputStreamLess(a,b);var e=c.getInt32();this.type=c.getString(e),this.version=c.getInt32();var i=Math.floor(.9*c.byteLength);c.seek(i,c.byteLength-i)}else{a=h.ungzip(a),c=new f.InputStream(a);var e=c.getInt32();this.type=c.getString(e),this.version=c.getInt32()}else c=new f.InputStream(a);this.stream=c,this.types=null,this.entryOffsets=[],c.seek(c.byteLength-8,8,d);var j=c.getUint32();this.typesOffset=c.getUint32(),c.seek(this.typesOffset,1,d);var k=this.readU32V();this.types=[];for(var l=0;l<k;++l)this.types.push({entryClass:this.readString(),entryType:this.readString(),version:this.readU32V()});c.seek(j,1,d);for(var m=this.readU32V(),n=this.entryOffsets,l=0;l<m;++l)n.push(c.getUint32());c.seek(0)}Object.defineProperty(b,"__esModule",{value:!0}),b.PackFileReaderLess=d;var e=c(34),f=c(33),g=c(44),h=c(8);d.prototype=Object.create(e.PackFileReader.prototype)},function(a,b,c){"use strict";function d(a,b){this.offset=0,this.byteLength=b,this.range=0,this.compressedBuffer=a,this.compressedByteLength=a.length,this.compressedOffset=0,this.decompressEnd=!1,this.resetCount=0,this.convBuf=new ArrayBuffer(8),this.convUint8=new Uint8Array(this.convBuf),this.convUint16=new Uint16Array(this.convBuf),this.convInt32=new Int32Array(this.convBuf),this.convUint32=new Uint32Array(this.convBuf),this.convFloat32=new Float32Array(this.convBuf),this.convFloat64=new Float64Array(this.convBuf),this.COMPRESSED_chunk_SIZE=524288,this.DECOMPRESSED_chunk_SIZE=262144,this.chunks=[],this.chunksByteLengthMax=0,this.chunksByteLengthMin=0,this.chunkPointer=null,this.chunkOffset=0,this.tempchunk={startIdx:0,endIdx:0,buffer:null},this.inflate=this.getInflate(),this.prepare(0,1024)}Object.defineProperty(b,"__esModule",{value:!0}),b.InputStreamLess=d;var e=c(8);d.prototype.getInflate=function(){if(!this.inflate){this.inflate=new e.Inflate({level:3,chunkSize:this.DECOMPRESSED_chunk_SIZE});var a=this;this.inflate.onData=function(b){a.chunksByteLengthMax+=b.byteLength,a.chunksByteLengthMax<a.offset&&(b=null,a.chunksByteLengthMin=a.chunksByteLengthMax),a.chunks.push(b)},this.inflate.onEnd=function(){if(a.decompressEnd=!0,a.inflate=null,a.chunksByteLengthMax!=a.byteLength)throw"Decompress error, unexpected size."}}return this.inflate},d.prototype.prepare=function(a,b,c){if(this.chunksByteLengthMin>a&&(this.reset(),this.offset=a,this.range=b),!c){for(var d=Math.floor(a/this.DECOMPRESSED_chunk_SIZE),e=Math.floor(this.chunksByteLengthMin/this.DECOMPRESSED_chunk_SIZE),f=this.chunks.length<d?this.chunks.length:d,g=e;g<f;g++)this.chunks[g]=null;this.chunksByteLengthMin=f*this.DECOMPRESSED_chunk_SIZE}var b=b||1,h=a+b;h=h>this.byteLength?this.byteLength:h;for(var i=!1;h>this.chunksByteLengthMax;){var j=this.COMPRESSED_chunk_SIZE;this.compressedOffset+j>=this.compressedByteLength&&(j=this.compressedByteLength-this.compressedOffset,i=!0);var k=new Uint8Array(this.compressedBuffer.buffer,this.compressedOffset,j);if(this.getInflate().push(k,i),this.compressedOffset+=j,i)break}},d.prototype.ensurechunkData=function(a){a=a||1;var b=this.chunks.length,c=Math.floor(this.offset/this.DECOMPRESSED_chunk_SIZE),d=Math.floor((this.offset+a-1)/this.DECOMPRESSED_chunk_SIZE);if(d>=b){var e=(d-b+1)*this.DECOMPRESSED_chunk_SIZE;this.prepare(this.DECOMPRESSED_chunk_SIZE*b,e,!0)}if(c<d){if(this.tempchunk.startIdx>c||this.tempchunk.endIdx<d){var f=(d-c+1)*this.DECOMPRESSED_chunk_SIZE;this.tempchunk.buffer=new Uint8Array(f);for(var g=0,h=c;h<=d;h++)this.tempchunk.buffer.set(this.chunks[h],g),g+=this.DECOMPRESSED_chunk_SIZE;this.tempchunk.startIdx=c,this.tempchunk.endIdx=d}this.chunkPointer=this.tempchunk.buffer}else this.chunkPointer=this.chunks[c];this.chunkOffset=this.offset-c*this.DECOMPRESSED_chunk_SIZE,this.offset+=a},d.prototype.seek=function(a,b,c){this.offset=a,this.range=b,this.prepare(a,b,c)},d.prototype.getBytes=function(a){return this.ensurechunkData(a),new Uint8Array(this.chunkPointer.buffer,this.chunkOffset,a)},d.prototype.getVarints=function(){var a,b=0,c=0;do{this.ensurechunkData(),a=this.chunkPointer[this.chunkOffset],b|=(127&a)<<c,c+=7}while(128&a);return b},d.prototype.getUint8=function(){return this.ensurechunkData(),this.chunkPointer[this.chunkOffset]},d.prototype.getUint16=function(){return this.ensurechunkData(),this.convUint8[0]=this.chunkPointer[this.chunkOffset],this.ensurechunkData(),this.convUint8[1]=this.chunkPointer[this.chunkOffset],this.convUint16[0]},d.prototype.getInt16=function(){var a=this.getUint16();return a>32767&&(a|=4294901760),a},d.prototype.getInt32=function(){var a=this.convUint8;return this.ensurechunkData(),a[0]=this.chunkPointer[this.chunkOffset],this.ensurechunkData(),a[1]=this.chunkPointer[this.chunkOffset],this.ensurechunkData(),a[2]=this.chunkPointer[this.chunkOffset],this.ensurechunkData(),a[3]=this.chunkPointer[this.chunkOffset],this.convInt32[0]},d.prototype.getUint32=function(){var a=this.convUint8;return this.ensurechunkData(),a[0]=this.chunkPointer[this.chunkOffset],this.ensurechunkData(),a[1]=this.chunkPointer[this.chunkOffset],this.ensurechunkData(),a[2]=this.chunkPointer[this.chunkOffset],this.ensurechunkData(),a[3]=this.chunkPointer[this.chunkOffset],this.convUint32[0]},d.prototype.getFloat32=function(){var a=this.convUint8;return this.ensurechunkData(),a[0]=this.chunkPointer[this.chunkOffset],this.ensurechunkData(),a[1]=this.chunkPointer[this.chunkOffset],this.ensurechunkData(),a[2]=this.chunkPointer[this.chunkOffset],this.ensurechunkData(),a[3]=this.chunkPointer[this.chunkOffset],this.convFloat32[0]},d.prototype.getFloat64=function(){for(var a=this.convUint8,b=0;b<8;b++)this.ensurechunkData(),a[b]=this.chunkPointer[this.chunkOffset];return this.convFloat64[0]},d.prototype.getString=function(a){var b="";this.ensurechunkData(a);for(var c=this.chunkPointer,d=this.chunkOffset,e=this.chunkOffset+a;d<e;d++)b+=String.fromCharCode(c[d]);var f;try{f=decodeURIComponent(escape(b))}catch(a){f=b,debug("Failed to decode string "+f)}return f},d.prototype.reset=function(a){this.resetCount++,debug("InputStream Less Reset: "+this.resetCount),a&&(this.compressedBuffer=a,this.compressedByteLength=a.length),this.offset=0,this.chunks=[],this.chunksByteLengthMax=0,this.chunksByteLengthMin=0,this.compressedOffset=0,this.decompressEnd=!1,this.chunkPointer=null,this.chunkOffset=0,this.inflate=null,this.tempchunk.startIdx=0,this.tempchunk.endIdx=0,this.tempchunk.buffer=null}},function(a,b,c){"use strict";function d(a,b){try{b()}catch(b){a.raiseError(l.ErrorCodes.BAD_DATA,"",{exception:b.toString(),stack:b.stack}),a.postMessage(null)}}function e(a,b){var c=b.f2dLoadOptions.onDemandLoading?j.F2DOnDemand:k.F2D,d=a.f2d=new c(b.metadata,b.manifest,b.basePath,b.f2dLoadOptions);return d.F2D_MESH_COUNT_OLD=0,a.onDemandLoading&&(a.nextFrame=0,a.queuedMeshes=[],a.useFrames||d.load(b,a.frames[0])),d}function f(a,b){if(a.onDemandLoading){for(var c=0;c<a.requestQueue.length;++c)a.requestQueue[c]&&(a.requestQueue[c].promised?a.requestQueue[c].rendered=!1:a.requestQueue[c]=null);a.nextRequest=0}return e(a,b)}function g(a){var b=a.worker;if(b.postMessage({progress:.01}),a.data){if(b.postMessage({progress:.5}),a.f2dLoadOptions.onDemandLoading){var c=a.data;c instanceof Uint8Array||(c=new Uint8Array(c)),b.frames=[c],b.nextFrame=1,b.finalFrame=!0,b.initialLoadContext=a,b.onDemandLoading=!0,b.streamStates=[],b.requestQueue=[],b.promisedBuffers=[],b.parsePromiseRequest=!1}b.totalBufferCount=m,b.useFrames=!1;var e=f(b,a);if(b.onDemandLoading){var g={f2dframe:e};b.postMessage(g)}else a.loadDoneCB=function(a){if(a){var c={f2d:e};b.postMessage(c)}else b.raiseError(l.ErrorCodes.BAD_DATA,"",{}),b.postMessage(null)},d(b,function(){e.load(a,a.data)})}else b.postMessage(null)}function h(a){function b(){}function c(a,b){var c=o.saveState();n.streamStates[a+(0!=c.vbbCount)]=c,c.dataBuffer=b}function g(a){a>=n.streamStates.length&&(a=n.streamStates.length-1);for(var b,c=a;!(b=n.streamStates[c]);--c)if(c<=0)return void(o=e(n,n.initialLoadContext));var d=n.frames[b.dataBuffer];o.stream&&o.stream.buffer==d&&(d=null),o.restoreState(b,d)?(n.queuedMeshes.length=0,o.F2D_MESH_COUNT_OLD=c-(0!=b.vbbCount),n.nextFrame=b.dataBuffer+1):o=e(n,n.initialLoadContext)}function h(b){return!(o.F2D_MESH_COUNT_OLD<a.bufferId)||(++o.F2D_MESH_COUNT_OLD,!1)}function i(){for(var a=n.nextRequest;a<n.requestQueue.length;){var b=n.requestQueue[a];if(b&&b.rendered)return n.nextRequest=a,b;++a}return null}function j(){a=i();var e=n.parsePromiseRequest;if(n.parsePromiseRequest=!0,e||!a)for(var f;n.promisedBuffers.length>0;)if((f=n.requestQueue[n.promisedBuffers.shift()])&&f.promised){a=f,n.parsePromiseRequest=!1;break}if(a){if(a.loadDoneCB=b,a.acceptMeshCB=h,0==n.streamStates.length&&c(0,0),o&&(a.bufferId<o.F2D_MESH_COUNT_OLD||a.bufferId>o.F2D_MESH_COUNT_OLD+n.queuedMeshes.length)&&g(a.bufferId),o.F2D_MESH_COUNT_OLD+=n.queuedMeshes.splice(0,a.bufferId-o.F2D_MESH_COUNT_OLD).length,a.bufferId<o.F2D_MESH_COUNT_OLD+n.queuedMeshes.length)o.meshes=n.queuedMeshes.splice(0,1),a.finalFrame=n.finalFrame&&n.nextFrame==n.frames.length&&0==n.queuedMeshes.length&&null==o.stream&&n.totalBufferCount==m,k(!0,!0);else for(var l=a.bufferId;l<=a.bufferId;){if(null==o.stream){if(!(n.nextFrame<n.frames.length)){if(n.finalFrame&&0==n.queuedMeshes.length)break;return}a.data=n.frames[n.nextFrame++]}n.nextFrame>=n.frames.length&&(a.finalFrame=n.finalFrame),d(n,function(){o.loadFrames(a)}),n.queuedMeshes=n.queuedMeshes.concat(o.meshes),o.F2D_MESH_COUNT_OLD+=n.queuedMeshes.splice(0,a.bufferId-o.F2D_MESH_COUNT_OLD).length,o.meshes=n.queuedMeshes.splice(0,1),o.meshes.length&&(a.finalFrame=n.finalFrame&&n.nextFrame==n.frames.length&&0==n.queuedMeshes.length&&null==o.stream&&n.totalBufferCount==m,k(!0,!0),l=o.F2D_MESH_COUNT_OLD,n.streamStates[o.F2D_MESH_COUNT_OLD+n.queuedMeshes.length]||c(o.F2D_MESH_COUNT_OLD+n.queuedMeshes.length,n.nextFrame-1))}if(a.bufferId==n.nextRequest&&++n.nextRequest,n.requestQueue[a.bufferId]=null,a.promised){var p=n.promisedBuffers.indexOf(a.bufferId);p>=0&&n.promisedBuffers.splice(p,1)}n.timer=setTimeout(j,2)}}function k(b,c){if(b){if(!o.meshes.length&&!c)return;var d={f2dframe:!0,meshes:o.meshes,baseIndex:o.F2D_MESH_COUNT_OLD,bbox:o.bbox};o.F2D_MESH_COUNT_OLD+=o.meshes.length,a.finalFrame&&(d.cumulativeProps={maxObjectNumber:o.maxObjectNumber,viewports:o.viewports,clips:o.clips,strings:o.strings,stringDbIds:o.stringDbIds,stringBoxes:o.stringBoxes},d.finalFrame=c,n.totalBufferCount=o.F2D_MESH_COUNT_OLD,n.onDemandLoading&&n.requestQueue.splice(n.totalBufferCount));for(var e=[],f=0,g=o.meshes.length;f<g;++f)e.push(o.meshes[f].vb.buffer),e.push(o.meshes[f].indices.buffer);n.postMessage(d,e),o.meshes=[]}else n.raiseError(l.ErrorCodes.BAD_DATA,"",{}),n.postMessage(null)}var n=a.worker,o=n.f2d;if(!o&&a.data){n.postMessage({progress:.5}),a.f2dLoadOptions.onDemandLoading&&(n.frames=[],n.finalFrame=!1,n.initialLoadContext=a,n.onDemandLoading=!0,n.streamStates=[],n.requestQueue=[],n.promisedBuffers=[],n.parsePromiseRequest=!1),n.totalBufferCount=m,n.useFrames=!0,o=f(n,a);var p={f2dframe:o};n.postMessage(p)}if(n.onDemandLoading){if(a.data){var q=a.data;q instanceof Uint8Array||(q=new Uint8Array(q)),n.frames.push(q),a.finalFrame&&(n.finalFrame=!0)}else if(a.finalFrame)n.finalFrame=!0;else if(a.cancel)o&&(o=f(n,n.initialLoadContext)),n.postMessage({canceled:!0});else if(a.cancelPromise){var r=n.requestQueue[a.cancelPromise];r&&(r.rendered?r.promise=!1:n.requestQueue[a.cancelPromise]=null);var s=n.promisedBuffers.indexOf(a.cancelPromise);s>=0&&n.promisedBuffers.splice(s,1)}else if(a.bufferId>=0&&a.bufferId<n.totalBufferCount){var r=n.requestQueue[a.bufferId];a.conditional&&!r||(a.promised&&n.promisedBuffers.push(a.bufferId),r&&(a.promised|=r.promised,a.rendered|=r.rendered),n.requestQueue[a.bufferId]=a)}o&&(n.timer&&clearTimeout(n.timer),n.timer=setTimeout(j,2))}else a.loadDoneCB=k,d(n,function(){o.loadFrames(a)})}function i(a){a.register("PARSE_F2D",{doOperation:g}),a.register("PARSE_F2D_FRAME",{doOperation:h})}Object.defineProperty(b,"__esModule",{value:!0}),b.register=i;var j=c(46),k=c(47),l=c(6),m=1e20},function(a,b,c){"use strict";function d(a,b,c,d){e.F2D.call(this,a,b,c,d)}Object.defineProperty(b,"__esModule",{value:!0}),b.F2DOnDemand=d;var e=c(47),f=c(3),g=c(33);d.prototype=Object.create(e.F2D.prototype),d.prototype.constructor=d,d.prototype.load=function(a,b){b instanceof Uint8Array||(b=new Uint8Array(b)),this.data=b,this.readHeader()},d.prototype.loadFrames=function(a){if(this.loadContext=a,this.acceptMeshCB=a.acceptMeshCB,null==this.stream){var b=a.data;if(b)b instanceof Uint8Array||(b=new Uint8Array(b)),this.data=b;else if(a.finalFrame&&(this.data=null,this.stringBoxes.length)){var c=new Float32Array(this.stringBoxes.length);c.set(this.stringBoxes),this.stringBoxes=c}}this.parseFrames(a.finalFrame),a.loadDoneCB(!0)},d.prototype.pushMesh=function(a){this.acceptMeshCB&&!this.acceptMeshCB(a)||e.F2D.prototype.pushMesh.call(this,a)},d.prototype.parseFrames=function(a){if(this.data||this.stream){this.stream||(this.stream=new g.InputStream(this.data));for(var b=this.stream;b.offset<b.byteLength;){if(this.meshes.length>0)return;if(this.parseDataType(),this.error)break;this.opCount++}}else a||f.logger.warn("Unexpected F2D parse state: If there is no data, we only expect a flush command, but flush was false.");a&&this.flushBuffer(0,!0),this.stream=null,this.data=null},d.prototype.saveState=function(){var a={};a.fontCount=this.fontCount,a.fontId=this.fontId,a.objectMemberQueue=[].concat(this.objectMemberQueue),a.viewportCount=this.viewports.length,a.currentVpId=this.currentVpId,a.clipsCount=this.clips.length,a.stringsCount=this.strings.length,a.currentStringNumber=this.currentStringNumber,a.currentStringBox=this.currentStringBox.clone(),a.objectNumber=this.objectNumber,a.currentFakeId=this.currentFakeId,a.maxObjectNumber=this.maxObjectNumber,a.objectStack=[].concat(this.objectStack),a.objectNameStack=[].concat(this.objectNameStack);var b=a.parseObjState={},c=b.polyTriangle={};c.points=this.parseObjState.polyTriangle.points,c.indices=this.parseObjState.polyTriangle.indices,c.colors=this.parseObjState.polyTriangle.colors;var d=b.viewport={};d.units=this.parseObjState.viewport.units,
d.transform=this.parseObjState.viewport.transform;var e=b.clip={};e.contourCounts=this.parseObjState.clip.contourCounts,e.points=this.parseObjState.clip.points,e.indices=this.parseObjState.clip.indices;var f=b.raster={};f.position=this.parseObjState.raster.position,f.width=this.parseObjState.raster.width,f.height=this.parseObjState.raster.height,f.imageId=this.parseObjState.raster.imageId;var g=b.text={};g.string=this.parseObjState.text.string,g.position=this.parseObjState.text.position,g.height=this.parseObjState.text.height,g.widthScale=this.parseObjState.text.widthScale,g.rotation=this.parseObjState.text.rotation,g.oblique=this.parseObjState.text.oblique,g.charWidths=this.parseObjState.text.charWidths;var h=b.fontDef={};return h.name=this.parseObjState.fontDef.name,h.fullName=this.parseObjState.fontDef.fullName,h.flags=this.parseObjState.fontDef.flags,h.spacing=this.parseObjState.fontDef.spacing,h.panose=this.parseObjState.fontDef.panose,b.uknown={},a.lineWeight=this.lineWeight,a.color=this.color,a.layer=this.layer,a.bgColor=this.bgColor,a.vbbCount=this.currentVbb.vcount,a.numCircles=this.numCircles,a.numEllipses=this.numEllipses,a.numPolylines=this.numPolylines,a.numLineSegs=this.numLineSegs,a.numPolytriangles=this.numPolytriangles,a.numTriangles=this.numTriangles,a.error=this.error,a.offsetX=this.offsetX,a.offsetY=this.offsetY,a.streamPosition=null==this.stream?0:this.stream.offset,a},d.prototype.restoreState=function(a,b){if(b||!this.stream||a.streamPosition!=this.stream.offset){if(b)this.stream=new g.InputStream(b);else if(!this.stream)return!1;this.stream.seek(a.streamPosition),this.currentVbb.reset(a.vbbCount),this.fontCount=a.fontCount,this.fontId=a.fontId,this.objectMemberQueue=[].concat(a.objectMemberQueue),this.viewports.length=a.viewportCount,this.currentVpId=a.currentVpId,this.clips.length=a.clipsCount,this.strings.length=a.stringsCount,this.currentStringNumber=a.currentStringNumber,this.currentStringBox=a.currentStringBox,this.objectNumber=a.objectNumber,this.currentFakeId=a.currentFakeId,this.maxObjectNumber=a.maxObjectNumber,this.objectStack=[].concat(a.objectStack),this.objectNameStack=[].concat(a.objectNameStack);var c=this.parseObjState,d=c.polyTriangle;d.points=a.parseObjState.polyTriangle.points,d.indices=a.parseObjState.polyTriangle.indices,d.colors=a.parseObjState.polyTriangle.colors;var e=c.viewport;e.units=a.parseObjState.viewport.units,e.transform=a.parseObjState.viewport.transform;var f=c.clip;f.contourCounts=a.parseObjState.clip.contourCounts,f.points=a.parseObjState.clip.points,f.indices=a.parseObjState.clip.indices;var h=c.raster;h.position=a.parseObjState.raster.position,h.width=a.parseObjState.raster.width,h.height=a.parseObjState.raster.height,h.imageId=a.parseObjState.raster.imageId;var i=c.text;i.string=a.parseObjState.text.string,i.position=a.parseObjState.text.position,i.height=a.parseObjState.text.height,i.widthScale=a.parseObjState.text.widthScale,i.rotation=a.parseObjState.text.rotation,i.oblique=a.parseObjState.text.oblique,i.charWidths=a.parseObjState.text.charWidths;var j=c.fontDef;j.name=a.parseObjState.fontDef.name,j.fullName=a.parseObjState.fontDef.fullName,j.flags=a.parseObjState.fontDef.flags,j.spacing=a.parseObjState.fontDef.spacing,j.panose=a.parseObjState.fontDef.panose,this.lineWeight=a.lineWeight,this.color=a.color,this.layer=a.layer,this.bgColor=a.bgColor,this.numCircles=a.numCircles,this.numEllipses=a.numEllipses,this.numPolylines=a.numPolylines,this.numLineSegs=a.numLineSegs,this.numPolytriangles=a.numPolytriangles,this.numTriangles=a.numTriangles,this.error=a.error,this.offsetX=a.offsetX,this.offsetY=a.offsetY}return!0}},function(a,b,c){"use strict";function d(){return{arcs:0,circles:0,circ_arcs:0,viewports:0,clips:0,colors:0,db_ids:0,dots:0,fills:0,layers:0,line_caps:0,line_joins:0,line_patterns:0,line_pat_refs:0,plines:0,pline_points:0,line_weights:0,links:0,miters:0,ptris:0,ptri_indices:0,ptri_points:0,rasters:0,texts:0,strings:[]}}function e(a,b,c,e){if(this.metadata=a,this.scaleX=1,this.scaleY=1,this.bbox={min:{x:0,y:0,z:0},max:{x:0,y:0,z:0}},this.is2d=!0,this.layersMap={},this.fontDefs={},this.fontCount=0,this.fontId=0,this.manifestAvailable=!1,this.objectMemberQueue=[],this.propertydb={attrs:[],avs:[],ids:[],values:[],offsets:[],rcv_offsets:[],rcvs:[],viewables:[]},a){var h=a.page_dimensions;this.paperWidth=h.page_width,this.paperHeight=h.page_height,this.scaleX=this.paperWidth/h.plot_width,this.scaleY=this.paperHeight/h.plot_height,this.hidePaper=h.hide_paper;var i=this.paperWidth,j=this.paperHeight;this.bbox.max.x=i,this.bbox.max.y=j;var k=a.page_dimensions||{};if(isFinite(k.paper_rotation)&&0!==k.paper_rotation){var l,n=k.paper_rotation*Math.PI/180,o=Math.cos(n),p=Math.sin(n),l=i*o,q=i*p,r=-j*p,s=j*o;this.bbox.min.x=Math.min(0,l,r,l+r),this.bbox.max.x=Math.max(0,l,r,l+r),this.bbox.min.y=Math.min(0,q,s,q+s),this.bbox.max.y=Math.max(0,q,s,q+s)}isFinite(k.paper_offset_x)&&0!==k.paper_offset_x&&(this.bbox.min.x+=k.paper_offset_x,this.bbox.max.x+=k.paper_offset_x),isFinite(k.paper_offset_y)&&0!==k.paper_offset_y&&(this.bbox.min.y+=k.paper_offset_y,this.bbox.max.y+=k.paper_offset_y);var t=0;this.layersMap[0]=t++;for(var u in a.layers){var v=parseInt(u);this.layersMap[v]=t++}this.layerCount=t,this.createLayerGroups(a.layers)}if(this.hidePaper=this.hidePaper||e&&e.modelSpace,this.opCount=0,this.fontFaces=[],this.fontFamilies=[],this.viewports=[{}],this.currentVpId=0,this.viewports[0].geom_metrics=this.currentGeomMetrics=d(),this.clips=[0],this.strings=[],this.stringDbIds=[],this.stringBoxes=[],this.currentStringNumber=-1,this.currentStringBox=new g.LmvBox3,this.linkBoxes=[],this.currentLinkBox=new g.LmvBox3,this.objectNumber=0,this.currentFakeId=-2,this.imageNumber=0,this.linkNumber=0,this.maxObjectNumber=0,this.objectStack=[],this.objectNameStack=[],this.parseObjState={polyTriangle:{},viewport:{},clip:{},raster:{},text:{},fontDef:{},uknown:{}},this.layer=0,this.bgColor="number"==typeof e.bgColor?e.bgColor:4294967295,this.contrastColor=this.color=this.fillColor=4278190080,this.hidePaper&&(this.contrastColor=4294967040),this.useInstancing=e&&!!e.useInstancing,this.isMobile=e&&!!e.isMobile,this.max_vcount=this.isMobile?m:void 0,this.currentVbb=new f.VertexBufferBuilder(this.useInstancing,void 0,this.max_vcount),this.meshes=[],this.numCircles=this.numEllipses=this.numPolylines=this.numLineSegs=0,this.numPolytriangles=this.numTriangles=0,this.error=!1,this.offsetX=0,this.offsetY=0,b){this.manifestAvailable=!0,this.imageId2URI={};for(var w=b.assets,x=0,y=w.length;x<y;++x){var z=w[x];if(-1!=z.mime.indexOf("image/")){var A=z.id;A=A.substr(0,A.indexOf(".")),this.imageId2URI[A]=c+z.URI}"Autodesk.CloudPlatform.PropertyAttributes"==z.type&&this.propertydb.attrs.push(z.URI),"Autodesk.CloudPlatform.PropertyValues"==z.type&&this.propertydb.values.push(z.URI),"Autodesk.CloudPlatform.PropertyIDs"==z.type&&this.propertydb.ids.push(z.URI),"Autodesk.CloudPlatform.PropertyViewables"==z.type&&this.propertydb.viewables.push(z.URI),"Autodesk.CloudPlatform.PropertyOffsets"==z.type&&(-1!=z.id.indexOf("rcv")?this.propertydb.rcv_offsets.push(z.URI):this.propertydb.offsets.push(z.URI)),"Autodesk.CloudPlatform.PropertyAVs"==z.type&&this.propertydb.avs.push(z.URI),"Autodesk.CloudPlatform.PropertyRCVs"==z.type&&this.propertydb.rcvs.push(z.URI)}}}Object.defineProperty(b,"__esModule",{value:!0}),b.F2dSemanticType=b.F2dDataType=void 0,b.F2D=e;var f=c(48),g=c(29),h=c(28),i=c(27),j=c(33),k=c(3),l=c(6),m=16383,n=b.F2dDataType={dt_object:0,dt_void:1,dt_byte:2,dt_int:3,dt_float:4,dt_double:5,dt_varint:6,dt_point_varint:7,dt_byte_array:32,dt_int_array:33,dt_float_array:34,dt_double_array:35,dt_varint_array:36,dt_point_varint_array:37,dt_arc:38,dt_circle:39,dt_circular_arc:40,dt_string:63,dt_last_data_type:127},o=b.F2dSemanticType={st_object_member:0,st_fill:1,st_fill_off:2,st_clip_off:3,st_layer:4,st_link:5,st_line_weight:6,st_miter_angle:7,st_miter_length:8,st_line_pattern_ref:9,st_back_color:10,st_color:11,st_markup:12,st_object_id:13,st_markup_id:14,st_reset_rel_offset:15,st_font_ref:16,st_begin_object:32,st_clip:33,st_line_caps:34,st_line_join:35,st_line_pattern_def:36,st_font_def:37,st_viewport:38,st_sheet:42,st_arc:43,st_polyline:44,st_raster:45,st_text:46,st_polytriangle:47,st_dot:48,st_end_object:63,st_last_semantic_type:127};e.prototype.load=function(a,b){if(b instanceof Uint8Array||(b=new Uint8Array(b)),this.data=b,this.parse(),this.stringBoxes.length){var c=new Float32Array(this.stringBoxes.length);c.set(this.stringBoxes),this.stringBoxes=c}a.loadDoneCB(!0)},e.prototype.loadFrames=function(a){this.loadContext=a;var b=a.data;if(b)b instanceof Uint8Array||(b=new Uint8Array(b)),this.data=b;else if(a.finalFrame&&(this.data=null,this.stringBoxes.length)){var c=new Float32Array(this.stringBoxes.length);c.set(this.stringBoxes),this.stringBoxes=c}this.parseFrames(a.finalFrame),a.loadDoneCB(!0)},e.prototype.pushMesh=function(a){this.meshes.push(a),a.material={skipEllipticals:!this.currentVbb.numEllipticals,skipCircles:!this.currentVbb.numCirculars,skipTriangleGeoms:!this.currentVbb.numTriangleGeoms,useInstancing:this.currentVbb.useInstancing},this.currentImage&&(a.material.image=this.currentImage,a.material.image.name=this.imageNumber++,this.currentImage=null)},e.prototype.flushBuffer=function(a,b){if(this.currentVbb.vcount||b){var c=b;if(c=c||this.currentVbb.isFull(a)){if(this.currentVbb.vcount){var d=this.currentVbb.toMesh();i.VBUtils.bboxUnion(this.bbox,d.boundingBox),this.pushMesh(d),this.currentVbb=new f.VertexBufferBuilder(this.useInstancing,void 0,this.max_vcount)}this.loadContext&&this.loadContext.loadDoneCB(!0,b)}}},e.prototype.tx=function(a){return this.sx(a)},e.prototype.ty=function(a){return this.sy(a)},e.prototype.sx=function(a){return a*this.scaleX},e.prototype.sy=function(a){return a*this.scaleY},e.prototype.invertColor=function(a){var b=a>>24&255,c=a>>16&255,d=a>>8&255,e=255&a;return c=255-c,d=255-d,e=255-e,b<<24|c<<16|d<<8|e},e.prototype.mapColor=function(a,b){if(!this.hidePaper)return a;if(0!==this.bgColor)return a;var c=255&a,d=(65280&a)>>8,e=(16711680&a)>>16,f=c===d&&c===e;return c<127||f&&b&&(a&=1442840575),a},e.prototype.restoreSignBitFromLSB=function(a){return 1&a?-(a>>>1):a>>>1},e.prototype.parsePointPositions=function(){var a=this.stream.getVarints(),b=this.stream.getVarints();return a=this.restoreSignBitFromLSB(a),b=this.restoreSignBitFromLSB(b),a+=this.offsetX,b+=this.offsetY,this.offsetX=a,this.offsetY=b,[this.tx(a),this.ty(b)]},e.prototype.parserAssert=function(a,b,c){return a!=b&&(k.logger.warn("Expect "+b+"; actual type is "+a+"; in function "+c),this.error=!0,!0)},e.prototype.unhandledTypeWarning=function(a,b){k.logger.warn("Unhandled semantic type : "+b+" in function "+a)},e.prototype.parseObject=function(){var a=this.stream.getVarints();switch(this.objectStack.push(a),a){case o.st_sheet:this.objectNameStack.push("sheet"),this.objectMemberQueue.unshift("paperColor");break;case o.st_viewport:this.objectNameStack.push("viewport"),this.objectMemberQueue.unshift("units","transform");break;case o.st_clip:this.objectNameStack.push("clip"),this.objectMemberQueue.unshift("contourCounts","points","indices");break;case o.st_polytriangle:this.objectNameStack.push("polyTriangle"),this.objectMemberQueue.unshift("points","indices","colors");break;case o.st_raster:this.objectNameStack.push("raster"),this.objectMemberQueue.unshift("position","width","height","imageId");break;case o.st_text:this.currentStringNumber=this.strings.length,0===this.objectNumber&&(this.objectNumber=this.currentFakeId--),this.currentStringBox.makeEmpty(),this.objectNameStack.push("text"),this.objectMemberQueue.unshift("string","position","height","widthScale","rotation","oblique","charWidths");break;case o.st_font_def:this.objectNameStack.push("fontDef"),this.objectMemberQueue.unshift("name","fullName","flags","spacing","panose");break;case o.st_end_object:if(this.objectStack.pop(),this.objectStack.length){switch(this.objectStack.pop()){case o.st_polytriangle:this.actOnPolyTriangle();break;case o.st_viewport:this.actOnViewport();break;case o.st_clip:this.actOnClip();break;case o.st_raster:this.actOnRaster();break;case o.st_text:this.actOnText();break;case o.st_font_def:this.actOnFontDef()}var b=this.objectNameStack.pop(),c=this.parseObjState[b];for(var d in c)c[d]=null}else this.parserAssert(0,1,"parseEndObject (Stack Empty)");this.objectMemberQueue.length=0;break;default:this.objectNameStack.push("unknown"),this.error=!0,this.unhandledTypeWarning("parseObject",a)}},e.prototype.initSheet=function(a){if(this.bgColor=a,!this.hidePaper&&this.metadata){var b=this.paperWidth,c=this.paperHeight,d={x:0,y:0},e={x:b,y:0},f={x:0,y:c},g=this.metadata.page_dimensions||{};if(isFinite(g.paper_rotation)&&0!==g.paper_rotation){var h=g.paper_rotation*Math.PI/180,i=Math.cos(h),j=Math.sin(h);e.y=b*j,e.x=b*i,f.x=-c*j,f.y=c*i}isFinite(g.paper_offset_x)&&0!==g.paper_offset_x&&(d.x=g.paper_offset_x),isFinite(g.paper_offset_y)&&0!==g.paper_offset_y&&(d.y=g.paper_offset_y);var k=this.currentVbb,l=.0075*b,m={x:e.x*l/b,y:e.y*l/b},n={x:f.x*l/c,y:f.y*l/c},o={x:d.x+m.x,y:d.y+m.y},p={x:d.x+e.x,y:d.y+e.y},q=[d.x,d.y,d.x+e.x,d.y+e.y,d.x+e.x+f.x,d.y+e.y+f.y,d.x+f.x,d.y+f.y,o.x-n.x,o.y-n.y,o.x-n.x+e.x,o.y-n.y+e.y,o.x+e.x,o.y+e.y,o.x,o.y,p.x,p.y,p.x+m.x,p.y+m.y,p.x+m.x-n.x+f.x,p.y+m.y-n.y+f.y,p.x-n.x+f.x,p.y-n.y+f.y],r=[a,a,a,a,4283782485,4283782485,4283782485,4283782485,4283782485,4283782485,4283782485,4283782485],s=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11];this.addPolyTriangle(q,r,s,4294967295,-1,0,!1),k.addSegment(d.x,d.y,d.x+e.x,d.y+e.y,0,1e-6,4278190080,-1,0,this.currentVpId),k.addSegment(d.x+e.x,d.y+e.y,d.x+e.x+f.x,d.y+e.y+f.y,0,1e-6,4278190080,-1,0,this.currentVpId),k.addSegment(d.x+e.x+f.x,d.y+e.y+f.y,d.x+f.x,d.y+f.y,0,1e-6,4278190080,-1,0,this.currentVpId),k.addSegment(d.x+f.x,d.y+f.y,d.x,d.y,0,1e-6,4278190080,-1,0,this.currentVpId)}},e.prototype.setObjectMember=function(a){if(!this.objectMemberQueue.length)return k.logger.warn("Unexpected object member. "+a+" on object "+this.objectNameStack[this.objectNameStack.length-1]),!1;var b=this.objectMemberQueue.shift(),c=this.objectNameStack[this.objectNameStack.length-1];return"sheet"==c&&"paperColor"==b?(this.initSheet(a),!0):!!c&&(this.parseObjState[c][b]=a,!0)},e.prototype.parseString=function(){var a=this.stream,b=a.getVarints(),c=a.getVarints(),d=a.getString(c);switch(b){case o.st_object_member:if(this.setObjectMember(d))return;break;default:k.logger.info("Unexpected opcode semantic type for string.")}return d},e.prototype.actOnFontDef=function(){var a=this.parseObjState.fontDef;this.fontDefs[++this.fontCount]=a,this.fontId=this.fontCount},e.prototype.parsePoint=function(){var a=this.stream,b=a.getVarints(),c=this.parsePointPositions();switch(b){case o.st_object_member:if(this.setObjectMember(c))return;break;default:k.logger.info("Unexpected opcode semantic type for point.")}return c},e.prototype.parsePointsArray=function(){var a=this.stream,b=a.getVarints(),c=a.getVarints();if(c){c/=2;for(var d,e=[],f=0;f<c;++f)d=this.parsePointPositions(),e.push(d[0]),e.push(d[1]);switch(b){case o.st_polyline:return void this.actOnPolylinePointsArray(e);case o.st_dot:return void this.actOnDot(e);case o.st_object_member:if(this.setObjectMember(e))return;break;default:k.logger.info("Unexpected opcode semantic type for points array.")}return e}},e.prototype.parseIntArray=function(){for(var a=this.stream,b=a.getVarints(),c=a.getVarints(),d=[],e=0;e<c;++e)d.push(a.getUint32());switch(b){case o.st_object_member:if(this.setObjectMember(d))return;break;default:this.unhandledTypeWarning("parseIntArray",b)}return d},e.prototype.parseDoubleArray=function(){for(var a=this.stream,b=a.getVarints(),c=a.getVarints(),d=[],e=0;e<c;++e)d.push(a.getFloat64());switch(b){case o.st_object_member:if(this.setObjectMember(d))return;break;default:this.unhandledTypeWarning("parseDoubleArray",b)}return d},e.prototype.parseByteArray=function(){for(var a=this.stream,b=a.getVarints(),c=a.getVarints(),d=[],e=0;e<c;++e)d.push(a.getUint8());switch(b){case o.st_object_member:if(this.setObjectMember(d))return;break;default:this.unhandledTypeWarning("parseByteArray",b)}return d},e.prototype.parseVarintArray=function(){for(var a=this.stream,b=a.getVarints(),c=[],d=a.getVarints(),e=0;e<d;++e)c.push(a.getVarints());switch(b){case o.st_object_member:if(this.setObjectMember(c))return;break;default:this.unhandledTypeWarning("parseVarIntArray",b)}return c},e.prototype.parseInt=function(){var a=this.stream,b=a.getVarints(),c=a.getUint32();switch(b){case o.st_color:this.color=this.mapColor(c,!1),this.currentGeomMetrics.colors++;break;case o.st_fill:this.fill=!0,this.fillColor=this.mapColor(c,!0),this.currentGeomMetrics.fills++;break;case o.st_object_member:if(this.setObjectMember(c))return;default:this.unhandledTypeWarning("parseInt",b)}return c},e.prototype.parseVoid=function(){var a=this.stream.getVarints();switch(a){case o.st_fill_off:this.fill=!1,this.currentGeomMetrics.fills++;break;default:this.unhandledTypeWarning("parseVoid",a)}},e.prototype.parseVarint=function(){var a=this.stream,b=a.getVarints(),c=a.getVarints();switch(b){case o.st_line_weight:this.lineWeight=this.tx(c),this.currentGeomMetrics.line_weights++;break;case o.st_line_caps:this.currentGeomMetrics.line_caps++;break;case o.st_line_join:this.currentGeomMetrics.line_joins++;break;case o.st_object_id:case o.st_markup_id:this.objectNumber=c,this.maxObjectNumber=Math.max(this.maxObjectNumber,c),this.currentGeomMetrics.db_ids++;break;case o.st_link:this.linkNumber&&(this.linkBoxes[this.linkNumber]=this.currentLinkBox.clone(),this.currentLinkBox.makeEmpty()),this.linkNumber=c;break;case o.st_layer:this.currentGeomMetrics.layers++,this.layer=this.layersMap[c];break;case o.st_font_ref:this.fontId=c;break;case o.st_object_member:if(this.setObjectMember(c))return}return c},e.prototype.parseFloat=function(){var a=this.stream,b=a.getVarints(),c=a.getFloat32();switch(b){case o.st_miter_angle:case o.st_miter_length:break;case o.st_object_member:if(this.setObjectMember(c))return}return c},e.prototype.parseCircularArc=function(){var a=this.stream,b=a.getVarints();if(!this.parserAssert(b,o.st_arc,"parseCircularArc")){var c=this.parsePointPositions(),d=a.getVarints(),e=a.getFloat32(),f=a.getFloat32();this.actOnCircularArc(c[0],c[1],e,f,this.sx(d))}},e.prototype.parseCircle=function(){var a=this.stream,b=a.getVarints();if(!this.parserAssert(b,o.st_arc,"parseCircle")){var c=this.parsePointPositions(),d=a.getVarints();this.actOnCompleteCircle(c[0],c[1],this.sx(d))}},e.prototype.parseArc=function(){var a=this.stream,b=a.getVarints();if(!this.parserAssert(b,o.st_arc,"parseArc")){var c=this.parsePointPositions(),d=a.getVarints(),e=a.getVarints(),f=a.getFloat32(),g=a.getFloat32(),h=a.getFloat32();this.actOnArc(c[0],c[1],g,h,this.sx(d),this.sy(e),f)}},e.prototype.parseDataType=function(){var a=this.stream.getVarints();switch(a){case n.dt_void:this.parseVoid();break;case n.dt_int:this.parseInt();break;case n.dt_object:this.parseObject();break;case n.dt_varint:this.parseVarint();break;case n.dt_point_varint:this.parsePoint();break;case n.dt_float:this.parseFloat();break;case n.dt_point_varint_array:this.parsePointsArray();break;case n.dt_circular_arc:this.parseCircularArc();break;case n.dt_circle:this.parseCircle();break;case n.dt_arc:this.parseArc();break;case n.dt_int_array:this.parseIntArray();break;case n.dt_varint_array:this.parseVarintArray();break;case n.dt_byte_array:this.parseByteArray();break;case n.dt_string:this.parseString();break;case n.dt_double_array:this.parseDoubleArray();break;default:this.error=!0,k.logger.info("Data type not supported yet: "+a)}},e.prototype.readHeader=function(){var a=this.stream=new j.InputStream(this.data),b=a.getString(3);if("F2D"!==b)return k.logger.error("Invalid F2D header : "+b,(0,l.errorCodeString)(l.ErrorCodes.BAD_DATA)),!1;var c=a.getString(2);if("01"!==c)return k.logger.error("Only support f2d major version 1; actual version is : "+c,(0,l.errorCodeString)(l.ErrorCodes.BAD_DATA)),!1;if("."!==a.getString(1))return k.logger.error("Invalid version delimiter.",(0,l.errorCodeString)(l.ErrorCodes.BAD_DATA)),!1;a.getString(2);return!0},e.prototype.parse=function(){if(this.readHeader()){for(var a=this.stream;a.offset<a.byteLength&&(this.parseDataType(),!this.error);)this.opCount++;this.linkNumber&&(this.linkBoxes[this.linkNumber]=this.currentLinkBox.clone(),this.currentLinkBox.makeEmpty()),this.flushBuffer(0,!0),this.currentVbb=null,this.stream=null,this.data=null,k.logger.info("F2d parse: data types count : "+this.opCount)}},e.prototype.parseFrames=function(a){if(this.data)for(var b=this.stream=new j.InputStream(this.data);b.offset<b.byteLength&&(this.parseDataType(),!this.error);)this.opCount++;else a||k.logger.warn("Unexpected F2D parse state: If there is no data, we only expect a flush command, but flush was false.");a&&this.flushBuffer(0,!0),this.stream=null,this.data=null},e.prototype.actOnPolylinePointsArray=function(a){this.flushBuffer();for(var b=a.length/2,c=0,d=a[0],e=a[1],f=1;f<b;++f){var g=a[2*f],h=a[2*f+1];this.currentVbb.addSegment(d,e,g,h,c,this.lineWeight,this.color,this.objectNumber,this.layer,this.currentVpId),c+=Math.sqrt((g-d)*(g-d)+(h-e)*(h-e)),d=g,e=h}this.numPolylines++,this.numLineSegs+=b-1,this.currentGeomMetrics.plines++,this.currentGeomMetrics.pline_points+=b-1},e.prototype.actOnDot=function(a){this.currentGeomMetrics.dots++;var b=a[0],c=a[1];this.actOnCompleteCircle(b,c,this.sx(1),!0)},e.prototype.actOnCompleteCircle=function(a,b,c,d){this.flushBuffer(),this.numCircles++,d||this.currentGeomMetrics.circles++,this.fill?this.currentVbb.addSegment(a,b,a,b,0,2*c,this.color,this.objectNumber,this.layer,this.currentVpId,!0,!1,!0):this.currentVbb.addArc(a,b,0,2*Math.PI,c,c,0,this.lineWeight,this.color,this.objectNumber,this.layer,this.currentVpId)},e.prototype.actOnCircularArc=function(a,b,c,d,e){this.numCircles++,this.currentGeomMetrics.circ_arcs++,this.flushBuffer(),this.currentVbb.addArc(a,b,c,d,e,e,0,this.lineWeight,this.color,this.objectNumber,this.layer,this.currentVpId)},e.prototype.actOnArc=function(a,b,c,d,e,f,g){this.numEllipses++,this.currentGeomMetrics.arcs++,this.flushBuffer(),this.currentVbb.addArc(a,b,c,d,e,f,g,this.lineWeight,this.color,this.objectNumber,this.layer,this.currentVpId)},e.prototype.actOnRaster=function(){if(this.manifestAvailable){this.flushBuffer(4,!0);var a=this.parseObjState.raster,b=a.position,c=a.imageId,d=this.imageId2URI[c],e=this.sx(a.width),f=this.sy(a.height),g=b[0]+.5*e,h=b[1]-.5*f;this.currentVbb.addTexturedQuad(g,h,e,f,0,4278255615,this.objectNumber,this.layer,this.currentVpId),this.currentImage={dataURI:d},this.flushBuffer(0,!0),this.currentGeomMetrics.rasters++}},e.prototype.actOnClip=function(){var a=this.parseObjState.clip;this.parseObjState.clip={},this.clips.push(a),this.currentGeomMetrics.clips++},e.prototype.actOnText=function(){this.strings[this.currentStringNumber]=this.parseObjState.text.string,this.currentGeomMetrics.texts++,this.currentGeomMetrics.strings.push(this.parseObjState.text.string),this.stringDbIds[this.currentStringNumber]=this.objectNumber,this.stringBoxes.push(this.currentStringBox.min.x,this.currentStringBox.min.y,this.currentStringBox.max.x,this.currentStringBox.max.y),this.currentStringBox.makeEmpty(),this.currentStringNumber=-1,this.objectNumber<-1&&(this.objectNumber=0)};var p=new h.LmvVector3;e.prototype.addPolyTriangle=function(a,b,c,d,e,f,g){function h(a,b){if(a>b){var c=a;a=b,b=c}if(l[a]){var d=l[a],e=d.lastIndexOf(b);-1==e?d.push(b):d[e]=-1}else l[a]=[b]}function i(c,g){if(c>g){var h=c;c=g,g=h}var i=l[c];if(i){-1!=i.indexOf(g)&&(j.flushBuffer(4),j.currentVbb.addSegment(a[2*c],a[2*c+1],a[2*g],a[2*g+1],0,m,j.mapColor(b?b[c]:d,!0),e,f,j.currentVpId),b&&b[c]!=b[g]&&k.logger.warn("Gouraud triangle encountered. Will have incorrect antialiasing."))}}var j=this,l=null,m=-1;if(this.objectStack[this.objectStack.length-1]==o.st_text&&(m=-.5),g){l=new Array(a.length/2);for(var n=0,q=c.length;n<q;n+=3){var r=c[n],s=c[n+1],t=c[n+2];h(r,s),h(s,t),h(t,r)}}if(-1!==this.currentStringNumber||this.linkNumber)for(var u=a.length/2,n=0;n<u;++n)p.set(a[2*n],a[2*n+1],0),-1!==this.currentStringNumber&&this.currentStringBox.expandByPoint(p),this.linkNumber&&this.currentLinkBox.expandByPoint(p);if(this.currentVbb.useInstancing)for(var u=c.length,n=0;n<u;n+=3){var r=c[n],s=c[n+1],t=c[n+2];this.flushBuffer(4),this.currentVbb.addTriangleGeom(a[2*r],a[2*r+1],a[2*s],a[2*s+1],a[2*t],a[2*t+1],this.mapColor(b?b[r]:d,!0),e,f,this.currentVpId),g&&(i(r,s),i(s,t),i(t,r))}else{var u=a.length/2;this.flushBuffer(u);for(var v=this.currentVbb,w=v.vcount,n=0;n<u;++n){var x=a[2*n],y=a[2*n+1];v.addVertexPolytriangle(x,y,this.mapColor(b?b[n]:d,!0),e,f,this.currentVpId)}v.addIndices(c,w),g&&function(){for(var c=0,g=l.length;c<g;c++){var h=l[c];if(h)for(var i=0;i<h.length;i++){var n=h[i];-1!=n&&(j.flushBuffer(4),j.currentVbb.addSegment(a[2*c],a[2*c+1],a[2*n],a[2*n+1],0,m,j.mapColor(b?b[c]:d,!0),e,f,j.currentVpId),b&&b[c]!=b[n]&&k.logger.warn("Gouraud triangle encountered. Will have incorrect antialiasing."))}}}()}},e.prototype.actOnPolyTriangle=function(){var a=this.parseObjState.polyTriangle;this.parseObjState.polyTriangle={};var b=a.points,c=a.indices,d=a.colors;if(!b||!c)return void k.logger.warn("Malformed polytriangle.");this.objectStack[this.objectStack.length-1]==o.st_text||(this.currentGeomMetrics.ptris++,this.currentGeomMetrics.ptri_points+=b.length/2,this.currentGeomMetrics.ptri_indices+=c.length),this.numPolytriangles++,this.numTriangles+=c.length/3,this.addPolyTriangle(b,d,c,this.color,this.objectNumber,this.layer,!0)},e.prototype.actOnViewport=function(){var a=this.parseObjState.viewport;this.parseObjState.viewport={},a.geom_metrics=this.currentGeomMetrics=d(),this.viewports.push(a),this.currentVpId=this.viewports.length-1},e.prototype.createLayerGroups=function(a){function b(a){var c=Object.keys(a.childrenByName).map(function(b){return a.childrenByName[b]});if(delete a.childrenByName,c.length){a.children=c,a.childCount=0;for(var d=0;d<c.length;++d)a.childCount+=b(c[d]);c.sort(function(a,b){return a.isLayer&&!b.isLayer?-1:!a.isLayer&&b.isLayer?1:a.name.localeCompare(b.name,void 0,{sensitivity:"base",numeric:!0})})}return a.isLayer?1:a.childCount}var c=this.layersRoot={name:"root",id:"root",childrenByName:{},isLayer:!1},d=0,e=0;for(var f in a){var g=parseInt(f),h=a[f],i="string"==typeof h?h:h.name;i||(i=f);var j=i.split("|"),k=c;if(j.length>1)for(var l=0;l<j.length-1;++l){var m=j[l],n=k.childrenByName[m];n||(n={name:m,id:"group-"+d++,childrenByName:{},isLayer:!1},k.childrenByName[m]=n),k=n}k.childrenByName[i]={name:i,index:g,id:e++,childrenByName:{},isLayer:!0}}b(this.layersRoot)}},function(a,b){"use strict";function c(a,b,c){var d=b||65536;this.FULL_COUNT=0|(c||32767),this.useInstancing=a,this.stride=12,this.vb=new ArrayBuffer(4*this.stride*(this.useInstancing?d/4:d)),this.vbf=new Float32Array(this.vb),this.vbi=new Int32Array(this.vb),this.ib=this.useInstancing?null:new Uint16Array(d),this.reset(0)}Object.defineProperty(b,"__esModule",{value:!0}),b.VertexBufferBuilder=c;var d=2*Math.PI,e=[0,1,3,0,3,2];c.prototype.reset=function(a){this.vcount=a,this.icount=0,this.minx=this.miny=1/0,this.maxx=this.maxy=-1/0,this.dbIds={},this.numEllipticals=0,this.numCirculars=0,this.numTriangleGeoms=0},c.prototype.expandStride=function(){},c.prototype.addToBounds=function(a,b){a<this.minx&&(this.minx=a),a>this.maxx&&(this.maxx=a),b<this.miny&&(this.miny=b),b>this.maxy&&(this.maxy=b)},c.prototype.setCommonVertexAttribs=function(a,b,c,d,e,f,g,h){b&=255,c&=255,h&=255,f&=65535,g&=65535,this.vbi[a+8]=b|c<<8|h<<16,this.vbi[a+6]=d,this.vbi[a+7]=e,this.vbi[a+9]=f|g<<16,this.dbIds[e]=1},c.prototype.addVertexTriangleGeom=function(a,b,c,d,e,f,g,h,i,j){for(var k=this.vcount,l=this.vbf,m=this.useInstancing?1:4,n=0;n<m;n++){var o=(k+n)*this.stride;l[o]=a,l[o+1]=b,l[o+2]=c,l[o+3]=d,l[o+4]=e,l[o+5]=f,this.setCommonVertexAttribs(o,0+n,5,g,h,i,j,0),this.vcount++}return k},c.prototype.addVertexLine=function(a,b,c,d,e,f,g,h,i,j,k){for(var l=this.vcount,m=this.vbf,n=this.useInstancing?1:4,o=0;o<n;o++){var p=(l+o)*this.stride;m[p]=a,m[p+1]=b,m[p+2]=c,m[p+3]=d,m[p+4]=.5*f,m[p+5]=e,this.setCommonVertexAttribs(p,0+o,1,g,h,i,j,k),this.vcount++}return l},c.prototype.addVertexTexQuad=function(a,b,c,d,e,f,g,h,i){for(var j=this.vcount,k=this.vbf,l=this.useInstancing?1:4,m=0;m<l;m++){var n=(j+m)*this.stride;k[n]=a,k[n+1]=b,k[n+2]=e,k[n+3]=c,k[n+4]=d,this.setCommonVertexAttribs(n,0+m,4,f,g,h,i,0),this.vcount++}return j},c.prototype.addVertexArc=function(a,b,c,d,e,f,g,h,i,j,k,l){for(var m=this.vcount,n=this.vbf,o=e==f?2:3,p=this.useInstancing?1:4,q=0;q<p;q++){var r=(m+q)*this.stride;n[r]=a,n[r+1]=b,n[r+2]=c,n[r+3]=d,n[r+4]=.5*h,n[r+5]=e,3===o&&(n[r+10]=f,n[r+11]=g),this.setCommonVertexAttribs(r,0+q,o,i,j,k,l,0),this.vcount++}return m},c.prototype.addVertex=function(a,b,c,d,e,f){if(!this.useInstancing){var g=this.vcount,h=this.stride*g,i=this.vbf;return i[h]=a,i[h+1]=b,this.setCommonVertexAttribs(h,0,0,c,d,e,f,0),this.vcount++,g}},c.prototype.addVertexPolytriangle=function(a,b,c,d,e,f){this.useInstancing||(this.addVertex(a,b,c,d,e,f),this.addToBounds(a,b))},c.prototype.addIndices=function(a,b){if(!this.useInstancing){var c=this.ib,d=this.icount;if(d+a.length>=c.length){for(var e=new Uint16Array(2*Math.max(a.length,c.length)),f=0;f<d;++f)e[f]=c[f];this.ib=c=e}for(var f=0;f<a.length;++f)c[d+f]=b+a[f];this.icount+=a.length}},c.prototype.finalizeQuad=function(a){this.useInstancing||this.addIndices(e,a)},c.prototype.addSegment=function(a,b,c,d,e,f,g,h,i,j,k){var l=c-a,m=d-b,n=l||m?Math.atan2(m,l):0,o=l||m?Math.sqrt(l*l+m*m):0,p=this.addVertexLine(a,b,n,o,e,f,g,h,i,j,k);this.finalizeQuad(p),this.addToBounds(a,b),this.addToBounds(c,d)},c.prototype.addTriangleGeom=function(a,b,c,d,e,f,g,h,i,j){this.numTriangleGeoms++;var k=this.addVertexTriangleGeom(a,b,c,d,e,f,g,h,i,j);this.finalizeQuad(k),this.addToBounds(a,b),this.addToBounds(c,d),this.addToBounds(e,f)},c.prototype.addArc=function(a,b,c,e,g,h,i,j,k,l,m,n){g==h?this.numCirculars++:this.numEllipticals++;var o=f(c,e);c=o.start,e=o.end,0==c&&0==e&&(e=d);var p=Math.abs(c-e);if(p>1e-4&&Math.abs(p-d)>1e-4){var q=a+g*Math.cos(c),r=b+h*Math.sin(c);this.addSegment(q,r,q,r,0,j,k,l,m,n);var s=a+g*Math.cos(e),t=b+h*Math.sin(e);this.addSegment(s,t,s,t,0,j,k,l,m,n)}else this.addToBounds(a-g,b-h),this.addToBounds(a+g,b+h);var u=this.addVertexLine(a,b,0,1e-4,0,0,1,l,m,n);this.finalizeQuad(u);var v=this.addVertexArc(a,b,c,e,g,h,i,j,k,l,m,n);this.finalizeQuad(v);var p,q,r,s,t},c.prototype.addTexturedQuad=function(a,b,c,d,e,f,g,h,i){var j=this.addVertexTexQuad(a,b,c,d,e,f,g,h,i);this.finalizeQuad(j);var k=.5*Math.cos(e),l=.5*Math.sin(e),m=Math.abs(c*k)+Math.abs(d*l),n=Math.abs(c*l)+Math.abs(d*k);this.addToBounds(a-m,b-n),this.addToBounds(a+m,b+n)},c.prototype.isFull=function(a){a=a||3;var b=this.useInstancing?4:1;return this.vcount*b+a>this.FULL_COUNT},c.prototype.toMesh=function(){var a={};a.vb=new Float32Array(this.vb.slice(0,this.vcount*this.stride*4)),a.vbstride=this.stride;var b=this.useInstancing?1:0;if(a.vblayout={fields1:{offset:0,itemSize:3,bytesPerItem:4,divisor:b,normalize:!1},fields2:{offset:3,itemSize:3,bytesPerItem:4,divisor:b,normalize:!1},color4b:{offset:6,itemSize:4,bytesPerItem:1,divisor:b,normalize:!0},dbId4b:{offset:7,itemSize:4,bytesPerItem:1,divisor:b,normalize:!1},flags4b:{offset:8,itemSize:4,bytesPerItem:1,divisor:b,normalize:!1},layerVp4b:{offset:9,itemSize:4,bytesPerItem:1,divisor:b,normalize:!1}},this.stride>10&&(a.vblayout.extraParams={offset:10,itemSize:2,bytesPerItem:4,divisor:b,normalize:!1}),this.useInstancing){a.numInstances=this.vcount;var c=new Int32Array([0,1,2,3]);a.vblayout.instFlags4b={offset:0,itemSize:4,bytesPerItem:1,divisor:0,normalize:!1},a.vblayout.instFlags4b.array=c.buffer;a.indices=new Uint16Array(e)}else a.indices=new Uint16Array(this.ib.buffer.slice(0,2*this.icount));a.dbIds=this.dbIds
;var d=this.maxx-this.minx,f=this.maxy-this.miny,g=Math.max(d,f);a.boundingBox={min:{x:this.minx,y:this.miny,z:.001*-g},max:{x:this.maxx,y:this.maxy,z:.001*g}};a.boundingSphere={center:{x:.5*(this.minx+this.maxx),y:.5*(this.miny+this.maxy),z:0},radius:.5*Math.sqrt(d*d+f*f)};return a};var f=function(a,b){function c(){function c(a,b){return Math.abs(a-b)<.001}c(a,0)&&(a=0),c(b,0)&&(b=0),c(a,d)&&(a=d),c(b,d)&&(b=d)}if(c(),a>b)for(;a>d;)a-=d,b-=d;else for(;b>d;)a-=d,b-=d;return c(),a<0&&b>0&&(a+=d),{start:a,end:b}}},function(a,b,c){"use strict";function d(a,b,c){var d=a.basePath+b;g.ViewingService.getItem(a,d,c,null)}function e(a){function b(a){if(p.length<a.length+q){var b=Math.max(2*p.length,a.length+q),c=new Uint8Array(b);c.set(p),p=c}p.set(a,q),q+=a.length}function c(a){r=a}function e(a,c,d){function e(b){if(j.postMessage({type:"F2DAssetURL",urls:o}),o=null,m){var e={type:"F2DSTREAM",finalFrame:!0,finished:!0,progress:1};return B||(e.manifest=c,e.metadata=d,e.basePath=a.basePath,e.f2dSize=u,B=!0),j.debug("Total text bytes count : "+b.length),void j.postMessage(e)}p.length>q&&(p=new Uint8Array(p.buffer.slice(0,q)));var f;if(31==p[0]&&139==p[1])try{f=new Uint8Array(p.buffer,0,q),f=l.ungzip(f)}catch(a){console.error(a)}var e={type:"F2DBLOB",metadata:d,manifest:c,f2dSize:u,basePath:a.basePath,progress:1,buffer:f.buffer},g=[];g.push(f.buffer),j.postMessage(e,g)}function f(){if(m){if(z&&(z=!1,31==p[0]&&139==p[1]))return i.logger.error("F2D streaming broken by non-streaming unzip!",(0,k.errorCodeString)(k.ErrorCodes.BAD_DATA)),void(m=!1);var b=new Uint8Array(p.buffer,A,q-A);try{var e=y.load(b);if(e.frameEnd>e.frameStart){var f=p.buffer.slice(A+e.frameStart,A+e.frameEnd);A+=e.frameEnd;var g=[];g.push(f);var h={type:"F2DSTREAM",frames:f,finalFrame:!1};u&&(h.progress=A/u),B||(h.manifest=c,h.metadata=d,h.f2dSize=u,h.basePath=a.basePath,B=!0),j.postMessage(h,g)}}catch(a){j.debug(a)}}}function g(a){b(a),f()}var j=a.worker,n=a.url,o=[],u=0,v=0;if(c&&c.assets)for(var w=c.assets,x=0;x<w.length;x++){if(-1!=n.indexOf(w[x].URI)){u=w[x].usize||0;break}"Autodesk.CloudPlatform.F2D"==w[x].type&&(v=w[x].usize||0)}0==u&&v>0&&(u=v);var y=new h.F2DProbe,z=!0,A=0,B=!1;t=e,s=g,q>0&&f(),null!=r&&e(r)}a.worker.postMessage({progress:.01});var f,n,o=0,p=new Uint8Array(65536),q=0,r=null,s=b,t=c;g.ViewingService.getItem(a,a.url,function(a){t(a)},a.onFailureCallback,{ondata:function(a){s(a)},responseType:""}),d(a,"metadata.json.gz",function(b){try{f=JSON.parse((0,j.utf8ArrayToString)(b)),o++}catch(a){self.raiseError(k.ErrorCodes.BAD_DATA,"")}2===o&&e(a,n,f)}),d(a,"manifest.json.gz",function(b){try{b&&(n=JSON.parse((0,j.utf8ArrayToString)(b))),o++}catch(a){}2===o&&e(a,n,f)})}function f(a){a.register("STREAM_F2D",{doOperation:e})}Object.defineProperty(b,"__esModule",{value:!0}),b.register=f;var g=c(2),h=c(50),i=c(3),j=c(7),k=c(6),l=c(8),m=!0},function(a,b,c){"use strict";function d(){this.data=null,this.frameStart=0,this.frameEnd=0,this.stream=null,this.opCount=0,this.marker={frameStart:this.frameStart,frameEnd:this.frameEnd}}Object.defineProperty(b,"__esModule",{value:!0}),b.F2DProbe=d;var e=c(51),f=c(47),g=c(6),h=c(3);d.prototype.load=function(a){return this.data=a,this.frameStart=0,this.stream?(this.stream.reset(this.data),this.stream.seek(0),this.frameEnd=0):(this.stream=new e.CheckedInputStream(this.data),this.stream.seek(8),this.frameStart=8,this.frameEnd=8),this.probe(),this.marker.frameStart=this.frameStart,this.marker.frameEnd=this.frameEnd,this.marker};var i=f.F2dDataType,j=f.F2dSemanticType;d.prototype.readColor=function(){var a=this.stream;a.getVarints(),a.getVarints(),a.skipUint32()},d.prototype.parsePointPositions=function(){this.stream.getVarints(),this.stream.getVarints()},d.prototype.unhandledTypeWarning=function(a,b){h.logger.warn("Unhandled semantic type when probing F2d : "+b+" in function "+a)},d.prototype.parseObject=function(){this.stream.getVarints()},d.prototype.parseString=function(){var a=this.stream;a.getVarints();var b=a.getVarints();a.skipBytes(b)},d.prototype.parsePoint=function(){this.stream.getVarints(),this.parsePointPositions()},d.prototype.parseVarintArray=function(){var a=this.stream;a.getVarints();for(var b=a.getVarints(),c=0;c<b;++c)a.getVarints()},d.prototype.parseByteArray=function(){var a=this.stream;a.getVarints();var b=a.getVarints();a.skipBytes(b)},d.prototype.parseEndOfObject=function(){var a=this.stream;a.getVarints(),a.getVarints()},d.prototype.parsePointsArray=function(a){var b=this.stream,c=(b.getVarints(),b.getVarints());if(c){c/=2;for(var d=0;d<c;++d)this.parsePointPositions()}},d.prototype.parsePoint=function(a){var b=this.stream;b.getVarints();this.parsePointPositions()},d.prototype.parseInt=function(){var a=this.stream,b=a.getVarints();switch(b){case j.st_color:case j.st_fill:a.skipUint32();break;default:a.skipUint32(),this.unhandledTypeWarning("parseInt",b)}},d.prototype.parseVoid=function(){var a=this.stream.getVarints();switch(a){case j.st_fill_off:break;default:this.unhandledTypeWarning("parseVoid",a)}},d.prototype.parseVarint=function(){this.stream.getVarints(),this.stream.getVarints()},d.prototype.parseIntArray=function(){var a=this.stream;a.getVarints();for(var b=a.getVarints(),c=0;c<b;++c)a.skipUint32()},d.prototype.parseFloat=function(){var a=this.stream;a.getVarints(),a.getFloat32()},d.prototype.parseDoubleArray=function(){var a=this.stream;a.getVarints();for(var b=a.getVarints(),c=0;c<b;++c)a.skipFloat64()},d.prototype.parseCircularArc=function(){var a=this.stream;a.getVarints(),this.parsePointPositions(),a.getVarints(),a.getFloat32(),a.getFloat32()},d.prototype.parseCircle=function(){var a=this.stream;a.getVarints(),this.parsePointPositions(),a.getVarints()},d.prototype.parseArc=function(){var a=this.stream;a.getVarints(),this.parsePointPositions(),a.getVarints(),a.getVarints(),a.getFloat32(),a.getFloat32(),a.getFloat32()},d.prototype.parseDataType=function(){var a=this.stream.getVarints();switch(a){case i.dt_void:this.parseVoid();break;case i.dt_int:this.parseInt();break;case i.dt_object:this.parseObject();break;case i.dt_varint:this.parseVarint();break;case i.dt_float:this.parseFloat();break;case i.dt_point_varint:this.parsePoint();break;case i.dt_point_varint_array:this.parsePointsArray();break;case i.dt_circular_arc:this.parseCircularArc();break;case i.dt_circle:this.parseCircle();break;case i.dt_arc:this.parseArc();break;case i.dt_varint_array:this.parseVarintArray();break;case i.dt_int_array:this.parseIntArray();break;case i.dt_byte_array:this.parseByteArray();break;case i.dt_string:this.parseString();break;case i.dt_double_array:this.parseDoubleArray();break;default:this.error=!0,h.logger.error("Bad op code encountered : "+a+" , bail out.",(0,g.errorCodeString)(g.ErrorCodes.BAD_DATA))}this.error||(this.frameEnd=this.stream.offset)},d.prototype.probe=function(){var a=this.stream;try{for(;a.offset<a.byteLength&&(this.parseDataType(),!this.error);)this.opCount++}catch(a){a.toString(),a.stack&&a.stack.toString()}}},function(a,b){"use strict";function c(a){this.buffer=a,this.offset=0,this.byteLength=a.length,this.convBuf=new ArrayBuffer(8),this.convUint8=new Uint8Array(this.convBuf),this.convUint16=new Uint16Array(this.convBuf),this.convInt32=new Int32Array(this.convBuf),this.convUint32=new Uint32Array(this.convBuf)}function d(a){this.offset=a,this.message="try to access an offset that is out of bounds: "+this.offset,this.toString=function(){return this.message}}Object.defineProperty(b,"__esModule",{value:!0}),b.CheckedInputStream=c,c.prototype.boundsCheck=function(a){if(a>=this.byteLength)throw new d(a)},c.prototype.seek=function(a){this.boundsCheck(a),this.offset=a},c.prototype.getBytes=function(a){this.boundsCheck(this.offset+a);var b=new Uint8Array(this.buffer.buffer,this.offset,a);return this.offset+=a,b},c.prototype.skipBytes=function(a){this.boundsCheck(this.offset+a),this.offset+=a},c.prototype.getVarints=function(){var a,b=0,c=0;do{this.boundsCheck(this.offset),a=this.buffer[this.offset++],b|=(127&a)<<c,c+=7}while(128&a);return b},c.prototype.getUint8=function(){return this.boundsCheck(this.offset+1),this.buffer[this.offset++]},c.prototype.getUint16=function(){return this.boundsCheck(this.offset+2),this.convUint8[0]=this.buffer[this.offset++],this.convUint8[1]=this.buffer[this.offset++],this.convUint16[0]},c.prototype.getInt16=function(){var a=this.getUint16();return a>32767&&(a|=4294901760),a},c.prototype.getInt32=function(){this.boundsCheck(this.offset+4);var a=this.buffer,b=this.convUint8,c=this.offset;return b[0]=a[c],b[1]=a[c+1],b[2]=a[c+2],b[3]=a[c+3],this.offset+=4,this.convInt32[0]},c.prototype.getUint32=function(){this.boundsCheck(this.offset+4);var a=this.buffer,b=this.convUint8,c=this.offset;return b[0]=a[c],b[1]=a[c+1],b[2]=a[c+2],b[3]=a[c+3],this.offset+=4,this.convUint32[0]},c.prototype.skipUint32=function(){this.boundsCheck(this.offset+4),this.offset+=4},c.prototype.getFloat32=function(){return this.boundsCheck(this.offset+4),this.offset+=4,0},c.prototype.getFloat64=function(){return this.boundsCheck(this.offset+8),this.offset+=8,0},c.prototype.skipFloat64=function(){this.boundsCheck(this.offset+8),this.offset+=8},c.prototype.reset=function(a){this.buffer=a,this.offset=0,this.byteLength=a.length}},function(a,b,c){"use strict";function d(a,b){try{b()}catch(b){a.raiseError(i.ErrorCodes.BAD_DATA,"Unhandled exception while reading pack file",{url:a.url,exception:b.toString(),stack:b.stack})}}function e(a){function b(b){c.postMessage({url:a.url,workerId:a.workerId,progress:.5}),d(a,function(){var d,e,f=new g.PackFileReader(b),j=!1,l={estimateSizeOnly:!0,packNormals:void 0===a.packNormals||a.packNormals},m=f.getEntryCounts(),n=a.inMemory||[],o=0,p=function(a){var b=n[a>>5];return!(b&&b&1<<(31&a))};for(d=0;d<m;d++)p(d)&&(e=(0,h.readGeometry)(f,d,l),o+=e&&e.sharedBufferBytes||0);var q=o?new ArrayBuffer(o):null,r=0,s={packId:a.packId,workerId:a.workerId,progress:1,meshes:[],sharedBuffer:q},t=q?[q]:[];for(l={dstBuffer:q,startOffset:0,estimateSizeOnly:!1,packNormals:void 0===a.packNormals||a.packNormals},d=0;d<m;d++)l.startOffset=r,p(d)&&(e=(0,h.readGeometry)(f,d,l),e?(r+=e.sharedBufferBytes||0,s.meshes[d]=e,a.createWireframe&&((0,k.createWireframe)(e),e.iblines&&t.push(e.iblines.buffer))):(j||(c.raiseError(i.ErrorCodes.BAD_DATA,"Unable to load geometry",{url:a.url}),j=!0),c.postMessage(s)));c.postMessage(s,t)})}var c=a.worker,e={skipAssetCallback:a.skipAssetCallback};j.ViewingService.getItem(a,a.url,b,a.onFailureCallback,e)}function f(a){a.register("LOAD_GEOMETRY",{doOperation:e})}Object.defineProperty(b,"__esModule",{value:!0}),b.register=f;var g=c(34),h=c(53),i=c(6),j=c(2),k=c(54)},function(a,b,c){"use strict";function d(a,b,c,d,e){var f=function(){return a.getString(a.getInt32())},g=a.getString(4);if("INDX"!=g)return null;var k=b.vertexCount,l=b.triangleCount,m=b.vbstride,n=k*m,o=n+(3*l*2+3)/4|0;if(b.sharedBufferBytes=4*o,!e){var p;if(c||(c=new ArrayBuffer(4*o),d=0),p=b.vb=new Float32Array(c,d,n),b.indices=new Uint16Array(c,d+4*n,3*l),a.getIndicesArray(p.buffer,d+4*n,3*l),"VERT"!=(g=a.getString(4)))return null;var q;b.vblayout.normal&&2===b.vblayout.normal.itemSize&&(q=new Uint16Array(p.buffer,p.byteOffset,p.byteLength/2)),a.getVector3Array(p,k,b.vblayout.position.offset,m);var r,s,t;if(1&b.flags){if("NORM"!=(g=a.getString(4)))return null;if(q)for(h.length<3*k&&(h=new Float32Array(3*k)),a.getVector3Array(h,k,0,3),r=0,t=b.vblayout.normal.offset;r<k;r++,t+=m){var u=.5*(j(h[3*r+1],h[3*r])*i+1),v=.5*(h[3*r+2]+1);q[2*t]=65535*u|0,q[2*t+1]=65535*v|0}else a.getVector3Array(p,k,b.vblayout.normal.offset,m)}for(s=0;s<b.texMapCount;s++){if("TEXC"!=(g=a.getString(4)))return null;var w={name:f(),file:f()};b.uvs.push(w);var x="uv";s&&(x+=(s+1).toString()),a.getVector2Array(p,k,b.vblayout[x].offset,m)}var y=m-3*(b.attribMapCount||0);for(s=0;s<b.attribMapCount;s++){if("ATTR"!=(g=a.getString(4)))return null;var z,A={name:f()};if(-1!=A.name.indexOf("Color"))z="color";else{if(-1==A.name.indexOf("UVW")){b.attrs.push(A),a.getBytes(16*k);continue}z="uvw"}b.vblayout[z]={offset:y,itemSize:3};var B=[0,0,0,0];for(r=0,t=y;r<k;r++,t+=m)a.getVector4(B,0),p[t]=B[0],p[t+1]=B[1],p[t+2]=B[2];y+=3}}}function e(a,b,c){var d=a.seekToEntry(b);return d?"Autodesk.CloudPlatform.OpenCTM"==d.entryType?m(a.stream,c.dstBuffer,c.startOffset,c.estimateSizeOnly,c.packNormals):"Autodesk.CloudPlatform.Lines"==d.entryType?o(a,d,c.estimateSizeOnly):"Autodesk.CloudPlatform.Points"==d.entryType?p(a,d,c.estimateSizeOnly):null:null}Object.defineProperty(b,"__esModule",{value:!0}),b.readGeometry=e;var f=c(4),g=c(27),h=new Float32Array(3),i=1/Math.PI,j=Math.atan2;(0,f.isNodeJS)()||(j=function(a,b){var c=Math.abs(b),d=Math.abs(a),e=Math.min(c,d)/Math.max(c,d),f=e*e,g=((-.0464964749*f+.15931422)*f-.327622764)*f*e+e;return d>c&&(g=1.57079637-g),b<0&&(g=3.14159274-g),a<0&&(g=-g),g});var k=function(a,b,c,d,e){var f,g={x:b[a*d],y:b[a*d+1],z:b[a*d+2]},h={x:g.x-b[a*e],y:g.y-b[a*e+1],z:g.z-b[a*e+2]},i=c[d].next==e?c[d].prev:c[d].next;return f=i<0?{x:h.x,y:h.y,z:h.z}:{x:b[a*i]-g.x,y:b[a*i+1]-g.y,z:b[a*i+2]-g.z},{pos:g,next:h,prev:f}},l=function(a,b,c,d,e){e=a.vbstride,a.vblayout.prev={offset:e,itemSize:3},e+=3,a.vblayout.next={offset:e,itemSize:3},e+=3,a.vblayout.side={offset:e,itemSize:1},a.vbstride+=7;var f,g,h,i,j,l=a.lineWidth,m=0,n=new Array(a.vertexCount);for(f=0;f<a.vertexCount;++f)n[f]={prev:-1,next:-1,prev_seg:-1};for(g=0;g<d;++g)h=2*g,i=a.indices[h],j=a.indices[h+1],n[i].next=j,n[i].prev>=0&&++m,n[j].prev=i,n[j].prev_seg=g,n[j].next>=0&&++m;var o=2*d,p=new Array(o),q=new Uint16Array(6*(d+m)),r=0;for(g=0;g<d;++g)h=2*g,i=a.indices[h],j=a.indices[h+1],p[h]=k(b,c,n,i,j),p[h+1]=k(b,c,n,j,i),i=h,j=h+1,q[r++]=2*i+1,q[r++]=2*j,q[r++]=2*i,q[r++]=2*j,q[r++]=2*j+1,q[r++]=2*i,i=a.indices[h],n[i].prev>=0&&(j=2*n[i].prev_seg+1,i=h,q[r++]=2*j,q[r++]=2*i,q[r++]=2*j+1,q[r++]=2*i+1,q[r++]=2*i,q[r++]=2*j);a.indices=q;var s=2*o;a.vb=new Float32Array(s*a.vbstride),e=a.vblayout.position.offset;for(var t=0;t<o;++t)for(var u=0;u<2;++u)a.vb[e]=p[t].pos.x,a.vb[e+1]=p[t].pos.y,a.vb[e+2]=p[t].pos.z,e+=b,a.vb[e]=p[t].prev.x,a.vb[e+1]=p[t].prev.y,a.vb[e+2]=p[t].prev.z,e+=3,a.vb[e]=p[t].next.x,a.vb[e+1]=p[t].next.y,a.vb[e+2]=p[t].next.z,e+=3,a.vb[e]=u?-l:l,e+=1;a.vertexCount=s,a.isWideLines=!0},m=function(a,b,c,e,f){if("OCTM"!=a.getString(4))return null;if(5!=a.getInt32())return null;var h=a.getString(3);a.getUint8();var i={stream:null,vertices:null,indices:null,normals:null,colors:null,uvs:[],attrs:[]};i.vertexCount=a.getInt32(),i.triangleCount=a.getInt32(),i.texMapCount=a.getInt32(),i.attribMapCount=a.getInt32(),i.flags=a.getInt32(),i.comment=function(){return a.getString(a.getInt32())}();var j=f;i.vbstride=3,1&i.flags&&(i.vbstride+=j?1:3),i.vbstride+=2*(i.texMapCount||0),i.vbstride+=3*(i.attribMapCount||0),i.vblayout={};var k=0;if(i.vblayout.position={offset:k,itemSize:3},k+=3,1&i.flags&&(i.vblayout.normal={offset:k,itemSize:j?2:3,bytesPerItem:j?2:4,normalize:j},k+=j?1:3),i.texMapCount)for(var l=0;l<i.texMapCount;l++){var m="uv";l&&(m+=(l+1).toString()),i.vblayout[m]={offset:k,itemSize:2},k+=2}return"RAW"==h?(d(a,i,b,c,e),e||(g.VBUtils.deduceUVRepetition(i),g.VBUtils.computeBounds3D(i)),i):"MG2"==h?(debug("readOpenCTM_MG2(stream, mesh, dstBuffer, startOffset, estimateSizeOnly) not supported"),e||(g.VBUtils.deduceUVRepetition(i),g.VBUtils.computeBounds3D(i)),i):null},n=function(a,b,c,d){if(c)return null;var e,f={vertices:null,indices:null,colors:null,normals:null,uvs:[],attrs:[],lineWidth:1};if(d){var h;b.version>1?(f.vertexCount=a.readU16(),e=a.readU16(),h=a.readU16(),b.version>2&&(f.lineWidth=a.readF32())):(f.vertexCount=a.readU32V(),e=a.readU32V(),h=a.readU32V()),f.isLines=!0}else f.vertexCount=a.readU16(),e=a.readU16(),f.pointSize=a.readF32(),f.isPoints=!0;var i=0!=a.stream.getUint8();f.vbstride=3,i&&(f.vbstride+=3),f.vblayout={};var j=0;f.vblayout.position={offset:j,itemSize:3},j+=3,i&&(f.vblayout.color={offset:j,itemSize:3}),f.vb=new Float32Array(f.vertexCount*f.vbstride);var k=f.vb,m=f.vbstride,n=a.stream;n.getVector3Array(k,f.vertexCount,f.vblayout.position.offset,m);var o,p;if(i)for(o=0,j=f.vblayout.color.offset,p=f.vertexCount;o<p;o++,j+=m)k[j]=n.getFloat32(),k[j+1]=n.getFloat32(),k[j+2]=n.getFloat32(),n.getFloat32();var q=function(a){return a.buffer.slice(a.byteOffset,a.byteOffset+a.length)};if(d){var r,s;b.version>1?(r=new Uint16Array(q(n.getBytes(2*e))),s=new Uint16Array(q(n.getBytes(2*h)))):(r=new Int32Array(q(n.getBytes(4*e))),s=new Int32Array(q(n.getBytes(4*h))));var t=s[h-1]-h+1;f.indices=new Uint16Array(2*t);for(var u=0,v=0;v+1<h;v++)for(var w=s[v];w+1<s[v+1];w++)f.indices[u++]=r[w],f.indices[u++]=r[w+1]}else f.indices=new Uint16Array(q(n.getBytes(2*e)));return 1!=f.lineWidth&&l(f,m,k,t,j),g.VBUtils.computeBounds3D(f),f},o=function(a,b,c){return n(a,b,c,!0)},p=function(a,b,c){return n(a,b,c,!1)}},function(a,b,c){"use strict";function d(a,b){function c(a,b){var c=0|a.x*l,d=0|a.y*l,e=0|a.z*l,g=f[c];g||(f[c]=g={});var h=g[d];h||(g[d]=h={});var i=h[e];return void 0===i&&(h[e]=i=b),i}function d(a,b){var d=c(a,b);e[b]=d}var e=[],f={},h=1;if(a.boundingBox||b){var j=(new i.LmvBox3).copy(a.boundingBox||b),k=j.size();h=Math.max(k.x,Math.max(k.y,k.z))}var l=65536/h;return(0,g.enumMeshVertices)(a,d),e}function e(a,b){function c(a,b){d[3*b]=a.x,d[3*b+1]=a.y,d[3*b+2]=a.z}var d=new Float32Array(3*(0,g.getVertexCount)(a));return(0,g.enumMeshVertices)(a,c,b),d}function f(a,b,c,f){function i(a,b){b.x=n[3*a],b.y=n[3*a+1],b.z=n[3*a+2]}function j(a,b,c,d){i(a,q),i(b,r),i(c,s),r.sub(q),s.sub(q),r.cross(s),d.copy(r).normalize()}function k(a,b,c){var d=m[a],e=m[b],g=m[c];if(d!==e&&d!==g&&e!==g){var h=!1;if(d>e){var i=d;d=e,e=i,h=!0}var k=o[d];if(k){var l=k[e];if(void 0===l)k[e]=h?-c-1:c;else{if(f)p.push(a),p.push(b);else{j(a,b,c,t),l<0?j(e,d,m[-l-1],u):j(d,e,m[l],u);var n=t.dot(u);Math.abs(n)<.25&&(p.push(a),p.push(b))}delete k[e]}}else o[d]={},o[d][e]=c}}function l(a,b,c,d,e,f){k(d,e,f),k(e,f,d),k(f,d,e)}if(!a.isLines&&!a.iblines){var m=d(a,c),n=e(a,b),o={},p=[],q=new h.LmvVector3,r=new h.LmvVector3,s=new h.LmvVector3,t=new h.LmvVector3,u=new h.LmvVector3;(0,g.enumMeshTriangles)(a,l);for(var v in o)for(var w in o[v])p.push(parseInt(v)),p.push(parseInt(w));p.length>1&&(a.iblines=new Uint16Array(p.length),a.iblines.set(p))}}Object.defineProperty(b,"__esModule",{value:!0}),b.createWireframe=f;var g=c(55),h=c(28),i=c(29)},function(a,b,c){"use strict";function d(a){return a.vb?a.vb.length/a.vbstride:a.attributes.positions?a.attributes.positions.count:0}function e(a,b,c){var d,e=a.attributes,f=a.vb||e.position.array,g=a.vb?a.vbstride:3;if(a.vblayout){if(!a.vblayout.position)return;d=a.vblayout.position.offset}else{if(!e.position)return;d=e.position.itemOffset||0}var h=f.length/g;i||(i=new r.LmvVector3);for(var j=d,k=0;k<h;k++,j+=g)i.set(f[j],f[j+1],f[j+2]),c&&i.applyMatrix4(c),b(i,k)}function f(a,b){var c,d,e,f=a.attributes;j||(j=new r.LmvVector3,k=new r.LmvVector3,l=new r.LmvVector3,m=new r.LmvVector3,n=new r.LmvVector3,o=new r.LmvVector3);var g,h=a.vb||f.position.array,i=a.vb||f.normal&&f.normal.array,p=a.vb?a.vbstride:3;if(a.vblayout){if(!a.vblayout.position)return;g=a.vblayout.position.offset}else{if(!f.position)return;g=f.position.itemOffset||0}var q=0,s=a.vblayout?a.vblayout.normal:f.normal||null;s?q=s.offset||s.itemOffset||0:i=null,!s||3===s.itemSize&&4===s.bytesPerItem||(i=null);var t=a.ib||a.indices||(f.index?f.index.array:null);if(t){var u=a.offsets;u&&0!==u.length||(u=[{start:0,count:t.length,index:0}]);for(var v=0,w=u.length;v<w;++v)for(var x=u[v].start,y=u[v].count,z=u[v].index,A=x,B=x+y;A<B;A+=3){c=z+t[A],d=z+t[A+1],e=z+t[A+2];var C=c*p+g,D=d*p+g,E=e*p+g;if(j.x=h[C],j.y=h[C+1],j.z=h[C+2],k.x=h[D],k.y=h[D+1],k.z=h[D+2],l.x=h[E],l.y=h[E+1],l.z=h[E+2],i){var F=c*p+q,G=d*p+q,H=e*p+q;m.x=i[F],m.y=i[F+1],m.z=i[F+2],n.x=i[G],n.y=i[G+1],n.z=i[G+2],o.x=i[H],o.y=i[H+1],o.z=i[H+2],b(j,k,l,c,d,e,m,n,o)}else b(j,k,l,c,d,e)}}else for(var I=a.vb?a.vb.length/a.vbstride:h.length/3,A=0;A<I;A++){c=3*A,d=3*A+1,e=3*A+2;var C=c*p+g,D=d*p+g,E=e*p+g;if(j.x=h[C],j.y=h[C+1],j.z=h[C+2],k.x=h[D],k.y=h[D+1],k.z=h[D+2],l.x=h[E],l.y=h[E+1],l.z=h[E+2],i){var F=c*p+q,G=d*p+q,H=e*p+q;m.x=i[F],m.y=i[F+1],m.z=i[F+2],n.x=i[G],n.y=i[G+1],n.z=i[G+2],o.x=i[H],o.y=i[H+1],o.z=i[H+2],b(j,k,l,c,d,e,m,n,o)}else b(j,k,l,c,d,e)}}function g(a,b){var c,d,e=a.attributes;p||(p=new r.LmvVector3,q=new r.LmvVector3);var f=2;a.lineWidth&&(f=6);var g=a.ib||a.indices||(e.index?e.index.array:null);if(g){var h=a.vb?a.vb:e.position.array,i=a.vb?a.vbstride:3,j=a.offsets;j&&0!==j.length||(j=[{start:0,count:g.length,index:0}]);for(var k=0,l=j.length;k<l;++k)for(var m=j[k].start,n=j[k].count,o=j[k].index,s=m,t=m+n;s<t;s+=f)c=o+g[s],d=o+g[s+1],p.x=h[c*i],p.y=h[c*i+1],p.z=h[c*i+2],q.x=h[d*i],q.y=h[d*i+1],q.z=h[d*i+2],b(p,q,c,d)}else for(var h=a.vb?a.vb:e.position.array,i=a.vb?a.vbstride:3,s=0,t=h.length;s<t;s+=f)c=s,d=s+1,p.x=h[c*i],p.y=h[c*i+1],p.z=h[c*i+2],q.x=h[d*i],q.y=h[d*i+1],q.z=h[d*i+2],b(p,q,c,d)}function h(a,b){var c,d,e=a.attributes;p||(p=new r.LmvVector3,q=new r.LmvVector3);var f=a.iblines;if(f){var g=a.vb?a.vb:e.position.array,h=a.vb?a.vbstride:3,i=a.offsets;i&&0!==i.length||(i=[{start:0,count:f.length,index:0}]);for(var j=0,k=i.length;j<k;++j)for(var l=i[j].start,m=i[j].count,n=i[j].index,o=l,s=l+m;o<s;o+=2)c=n+f[o],d=n+f[o+1],p.x=g[c*h],p.y=g[c*h+1],p.z=g[c*h+2],q.x=g[d*h],q.y=g[d*h+1],q.z=g[d*h+2],b(p,q,c,d)}}Object.defineProperty(b,"__esModule",{value:!0}),b.VertexEnumerator=void 0,b.getVertexCount=d,b.enumMeshVertices=e,b.enumMeshTriangles=f,b.enumMeshLines=g,b.enumMeshEdges=h;var i,j,k,l,m,n,o,p,q,r=c(28);b.VertexEnumerator={getVertexCount:d,enumMeshVertices:e,enumMeshTriangles:f,enumMeshLines:g,enumMeshEdges:h}},function(a,b,c){"use strict";function d(a,b,c,d){k.ViewingService.getItem(a,b,d,a.onFailureCallback,{asynchronous:!0,responseType:c||"arraybuffer"})}function e(a,b){this.min.x=a[b],this.min.y=a[b+1],this.min.z=a[b+2],this.max.x=a[b+3],this.max.y=a[b+4],this.max.z=a[b+5]}function f(a,b){a[b]=this.min.x,a[b+1]=this.min.y,a[b+2]=this.min.z,a[b+3]=this.max.x,a[b+4]=this.max.y,a[b+5]=this.max.z}function g(a,b,c,d){var g=a[1]<<16|a[0];if(g||(g=28),this.boxStride=g/4,this.count=a.byteLength/g-1,this.count){this.boxes=new Float32Array(a.buffer,g),this.flags=new Int32Array(a.buffer,g);var h=this.boxes;if(c)for(var i=new m.LmvBox3,j=0,k=0;k<this.count;k++,j+=this.boxStride)e.call(i,h,j),i.applyMatrix4(b),f.call(i,h,j);else if(d&&(d.x||d.y||d.z))for(var j=0,k=0;k<this.count;k++,j+=this.boxStride)h[j]-=d.x,h[j+1]-=d.y,h[j+2]-=d.z,h[j+3]-=d.x,h[j+4]-=d.y,h[j+5]-=d.z}this.hasPolygonCounts=!0,this.wantSort=!1}function h(a){a.fragments_extra&&d(a,a.fragments_extra,"",function(b){if(b&&b.length){var c=new g(b,a.placementWithOffset,a.placementTransform,a.globalOffset);if(c.count){var d=new l.BVHBuilder(null,null,c);d.build(a.bvhOptions);var e={nodes:d.nodes.getRawData(),primitives:d.primitives};a.worker.postMessage({bvh:e},[e.nodes,e.primitives.buffer])}}})}function i(a){}function j(a){a.register("LOAD_OTG_BVH",{doOperation:h}),a.register("LOAD_OTG_MATS",{doOperation:i})}Object.defineProperty(b,"__esModule",{value:!0}),b.OtgFragInfo=void 0,b.register=j;var k=c(2),l=c(32),m=c(29);g.prototype.getCount=function(){return this.count},g.prototype.isTransparent=function(a){return!!(this.flags[a*this.boxStride+6]>>24)},g.prototype.getPolygonCount=function(a){return 16777215&this.flags[a*this.boxStride+6]},b.OtgFragInfo=g},function(a,b,c){"use strict";function d(a){return a.worker.ctx||(a.worker.ctx={requestQueue:[],numRequests:0,inprogress:{},authorizeUrns:{},_wsUsable:!a.disableWebSocket&&"undefined"!=typeof WebSocket&&!!a.otg_ws,_pendingCallbacks:[],_pendingMdata:[],_pendingTranserList:[]}),a.worker.ctx}function e(a,b){a._pendingCallbacks.forEach(function(a){a(b)}),a._pendingCallbacks=[]}function f(a,b){var c=d(a);if(!c._wsUsable)return void(b&&b(null));if(b&&c._pendingCallbacks.push(b),!c._opening){var f=g(a);if(f)return a.authorizeUrns&&a.authorizeUrns.forEach(function(a){f.send("/auth/"+a)}),void e(c,f);c._opening=!0,f=new WebSocket(a.otg_ws.replace("https:","wss:").replace("http:","ws:").replace(":7124",":7125")),f.addEventListener("open",function(){c._opening=!1,c.ws=f,f.binaryType="arraybuffer";for(var a in c.authorizeUrns)f.send("/auth/"+a);e(c,f)}),f.addEventListener("message",function(a){var b=new Uint8Array(a.data),d=(0,z.getHexString)(b,0,20),e=new Uint8Array(b.buffer,20),f=c.inprogress[d];f&&f(e,!1),delete c.inprogress[d]}),f.addEventListener("close",function(a,b){console.log("Socket close"),c._opening=!1,c.ws=null}),f.addEventListener("error",function(a){console.log("ws error, reverting to plain http.",a),c._opening=!1,c.ws=null,c._wsUsable=!1,e(c,f)})}}function g(a){var b=d(a);if(!b._wsUsable)return null;var c=b.ws;return c&&1===c.readyState?c:c&&0===c.readyState?(console.warn("Reentry into getWebSocket. Should not happen."),null):null}function h(a,b){var c={raiseError:function(c,d,e){e.hash=b,a.raiseError(c,d,e)}};return function(){t.ViewingService.defaultFailureCallback.apply(c,arguments),d(a).numRequests--,n(a)}}function i(a,b,c,d){31===a[0]&&139===a[1]&&(a=A.ungzip(a));var e=!c,f=w.readLmvBufferGeom(a,e);return f?(f.hash=b,c&&!f.mesh.iblines&&(0,u.createWireframe)(f.mesh,(new x.LmvMatrix4).fromArray(c)),f):void console.error("Failed to parse geometry",b)}function j(a,b,c,d){return i(a,b,c,d)}function k(a,b){Array.isArray(b)||(b=[b]);for(var c=[],e=0;e<b.length;e++){var f=b[e].mesh;if(f){var g=f.vb.buffer;c.push(g),f.indices&&f.indices.buffer!==g&&c.push(f.indices.buffer),f.iblines&&f.iblines.buffer!==g&&c.push(f.iblines.buffer)}}var h=d(a);h._pendingMdata.push.apply(h._pendingMdata,b),h._pendingTranserList.push.apply(h._pendingTranserList,c)}function l(a,b){k(a,b),d(a).numRequests--,n(a)}function m(a,b,c,e){var f=d(e),i=function(a,d){d||f.localCache.store(b,a);var g=j(a,b,c,e);g?l(e,g):h(e,b)(-1,"",{})};f.localCache.get(b,function(c,d){if(d)i(d,!0);else{var j=g(e);if(j){var k=a.slice(a.indexOf("/cdn/")+5);f.inprogress[b]=i,j.send(k)}else t.ViewingService.getItem(e.isCDN?{}:e,a,i,h(e,b),{asynchronous:!0,responseType:"arraybuffer",withCredentials:!1})}})}function n(a){for(var b=d(a),c=b.requestQueue;b.numRequests<B&&c.length>0;)for(var e=c.shift(),f=e.urls,g=e.hashes,h=e.sampleWorldMatrices,i=0;i<f.length;i++)b.numRequests++,m(f[i],g[i],h[i],a)}function o(a){var b=d(a).requestQueue,c={urls:a.urls,hashes:a.hashes,geomIds:a.geomIds,sampleWorldMatrices:a.sampleWorldMatrices};b.push(c),f(a,function(b){n(a)})}function p(a){var b=d(a);b._pendingMdata.length&&(a.worker.postMessage(b._pendingMdata,b._pendingTranserList),b._pendingMdata=[],b._pendingTranserList=[])}function q(a){var b=d(a);a.authorizeUrns&&a.authorizeUrns.forEach(function(a){b.authorizeUrns[a]=1}),b.localCache?f(a):(b.localCache=new y.LocalDbCache,b.localCache.open(function(){f(a)},a.disableIndexedDb)),b.workerId=a.workerId,b.flushMessages=setInterval(function(){p(a)},66)}function r(a){var b=d(a);b.flushMessages&&(p(a),clearInterval(b.flushMessages),b.flushMessages=null),b.localCache&&b.localCache.updatePendingTimestamps()}function s(a){a.register("LOAD_GEOMETRY_OTG",{doOperation:o}),a.register("INIT_WORKER_OTG",{doOperation:q}),a.register("UPDATE_MRU_TIMESTAMPS_OTG",{doOperation:r})}Object.defineProperty(b,"__esModule",{value:!0}),b.register=s;var t=c(2),u=c(54),v=c(58),w=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(v),x=c(30),y=c(59),z=c(7),A=c(8),B=200},function(a,b,c){"use strict";function d(a){var b=a[0];a[0]=a[1],a[1]=a[2],a[2]=b}function e(a){for(var b=[],c=0;c<a.length;c+=3)b.push([a[c],a[c+1],a[c+2]]);for(var c=0;c<b.length;c++)for(var e=b[c];e[0]>e[1]||e[0]>e[2];)d(e);b.sort(function(a,b){return a[0]-b[0]});var e=b[0],f=0;a[f]=e[0],a[f+1]=e[1]-e[0],a[f+2]=e[2]-e[0],f+=3;for(var c=1;c<b.length;c++,f+=3)e=b[c],a[f]=e[0]-b[c-1][0],a[f+1]=e[1]-e[0],a[f+2]=e[2]-e[0]}function f(a){for(var b=[],c=0;c<a.length;c+=2)b.push([a[c],a[c+1]]);for(var c=0;c<b.length;c++){var d=b[c];if(d[0]>d[1]){var e=d[0];d[0]=d[1],d[1]=e}}b.sort(function(a,b){return a[0]-b[0]});var d=b[0],f=0;a[f]=d[0],a[f+1]=d[1]-d[0],f+=2;for(var c=1;c<b.length;c++,f+=2)d=b[c],a[f]=d[0]-b[c-1][0],a[f+1]=d[1]-d[0]}function g(a){if(a.length){a[1]+=a[0],a[2]+=a[0];for(var b=3;b<a.length;b+=3)a[b]+=a[b-3],a[b+1]+=a[b],a[b+2]+=a[b]}}function h(a){if(a.length){a[1]+=a[0];for(var b=2;b<a.length;b+=2)a[b]+=a[b-2],a[b+1]+=a[b]}}function i(a){var b=w[a];return void 0!==b?b:0===a.indexOf("uv")?t.TextureUV:(console.warn("Unknown attribute name"),t.TextureUV)}function j(a){var b=x[a];return b||(console.error("Unknown vertex attribute"),t.TextureUV)}function k(a){var b=u.FLOAT,c=a.bytesPerItem||4;return 1===c?b=a.normalize?u.UBYTE_NORM:u.UBYTE:2===c&&(b=a.normalize?u.USHORT_NORM:u.USHORT),b<<4|15&a.itemSize}function l(a){var b=u.USHORT,c=a.bytesPerItem||2;return 1===c?b=u.UBYTE:2===c?b=u.USHORT:4===c&&(b=u.UINT),b<<4|15&a.itemSize}function m(){}function n(a){this.buffer=a,this.readOffset=0,this.meshFlag=0,this.numBuffers=0,this.numAttributes=0,this.bufferOffsets=[],this.attributes=[],this.buffers=[]}function o(a){var b=new m,c=[];if(!a.vb)return console.error("Unexpected non-interleaved vertex buffer"),null;c=[a.vb.byteLength,a.ib.byteLength],a.iblines&&c.push(a.iblines.byteLength);var d=Object.keys(a.attributes),g=0;a.isLines&&(g|=v.LINES),a.isWideLines&&(g|=v.WIDE_LINES),a.isPoints&&(g|=v.POINTS),b.beginHeader(g,d.length,c);for(var h=0;h<d.length;h++){var j=a.attributes[d[h]],k=i(d[h]);"index"===d[h]?b.addAttribute(k,j,0,1):"indexlines"===d[h]?b.addAttribute(k,j,0,2):b.addAttribute(k,j,a.vbstride,0)}b.endHeader();var l=Buffer.from(a.vb.buffer,a.vb.byteOffset,a.vb.byteLength);return b.addBuffer(l),a.isLines?f(a.ib):e(a.ib),l=Buffer.from(a.ib.buffer,a.ib.byteOffset,a.ib.byteLength),b.addBuffer(l),a.iblines&&(f(a.iblines),l=Buffer.from(a.iblines.buffer,a.iblines.byteOffset,a.iblines.byteLength),b.addBuffer(l)),b.end()}function p(a,b){var c=new n(a);if(!c.read())return console.error("Failed to parse OTG geometry"),null;for(var d={vblayout:{},vb:new Float32Array(c.buffers[0].buffer,c.buffers[0].byteOffset,c.buffers[0].byteLength/4),isLines:(3&c.meshFlag)===v.LINES,isWideLines:(3&c.meshFlag)===v.WIDE_LINES,isPoints:(3&c.meshFlag)===v.POINTS,boundingBox:z,boundingSphere:A},e=0;e<c.attributes.length;e++){var f=c.attributes[e];if(f.name===t.Index){var i=c.buffers[1];1===f.bytesPerItem?d.indices=i:2===f.bytesPerItem?d.indices=new Uint16Array(i.buffer,i.byteOffset,i.byteLength/f.bytesPerItem):4===f.bytesPerItem&&(d.indices=new Uint32Array(i.buffer,i.byteOffset,i.byteLength/f.bytesPerItem)),d.isLines?h(d.indices):g(d.indices)}else if(f.name===t.IndexEdges){if(!b){var k=c.buffers[2];1===f.bytesPerItem?d.iblines=k:2===f.bytesPerItem?d.iblines=new Uint16Array(k.buffer,k.byteOffset,k.byteLength/f.bytesPerItem):4===f.bytesPerItem&&(d.iblines=new Uint32Array(k.buffer,k.byteOffset,k.byteLength/f.bytesPerItem)),h(d.iblines)}}else{var l=j(f.name);d.vbstride?d.vbstride!==f.itemStride&&console.error("Unexpected vertex buffer stride mismatch."):d.vbstride=f.itemStride,d.vblayout[l]={bytesPerItem:f.bytesPerItem,offset:f.itemOffset,normalize:f.normalize,itemSize:f.itemSize}}}return{mesh:d,packId:0,meshIndex:0}}Object.defineProperty(b,"__esModule",{value:!0}),b.serializeLmvBufferGeom=o,b.readLmvBufferGeom=p;var q=c(4),r=c(33),s=c(29),t={Index:0,IndexEdges:1,Position:2,Normal:3,TextureUV:4,Color:5},u={BYTE:0,SHORT:1,UBYTE:2,USHORT:3,BYTE_NORM:4,SHORT_NORM:5,UBYTE_NORM:6,USHORT_NORM:7,FLOAT:8,INT:9,UINT:10},v={TRIANGLES:0,LINES:1,POINTS:2,WIDE_LINES:3},w={position:t.Position,normal:t.Normal,index:t.Index,indexlines:t.IndexEdges,color:t.Color},x={};x[t.Position]="position",x[t.Normal]="normal",x[t.Index]="index",x[t.IndexEdges]="indexlines",x[t.Color]="color",x[t.TextureUV]="uv";var y={};y[u.BYTE]=1,y[u.SHORT]=2,y[u.UBYTE]=1,y[u.USHORT]=2,y[u.BYTE_NORM]=1,y[u.SHORT_NORM]=2,y[u.UBYTE_NORM]=1,y[u.USHORT_NORM]=2,y[u.FLOAT]=4,y[u.INT]=4,y[u.UINT]=4,
m.prototype.beginHeader=function(a,b,c){var d=8,e=c.length;for(d+=4*(e-1),d+=5*b;d%4!=0;)d++;for(var f=0,g=0;g<c.length;g++)f+=c[g];this.buffer=new Buffer(d+f),this.writeOffset=0;for(var h="OTG0",g=0;g<4;g++)this.writeOffset=this.buffer.writeUInt8(h.charCodeAt(g),this.writeOffset);this.writeOffset=this.buffer.writeUInt16LE(a,this.writeOffset),this.writeOffset=this.buffer.writeUInt8(e,this.writeOffset),this.writeOffset=this.buffer.writeUInt8(b,this.writeOffset);for(var i=c[0],g=1;g<c.length;g++)this.writeOffset=this.buffer.writeUInt32LE(i,this.writeOffset),i+=c[g]},m.prototype.addAttribute=function(a,b,c,d){this.writeOffset=this.buffer.writeUInt8(a,this.writeOffset),a===t.Index||a===t.IndexEdges?(this.writeOffset=this.buffer.writeUInt8(l(b),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(4*(b.itemOffset||0),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(4*(c||0),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(d,this.writeOffset)):(this.writeOffset=this.buffer.writeUInt8(k(b),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(4*(b.itemOffset||0),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(4*(c||0),this.writeOffset),this.writeOffset=this.buffer.writeUInt8(d,this.writeOffset))},m.prototype.endHeader=function(){for(;this.writeOffset%4!=0;)this.writeOffset=this.buffer.writeUInt8(0,this.writeOffset)},m.prototype.addBuffer=function(a){a.copy(this.buffer,this.writeOffset),this.writeOffset+=a.length},m.prototype.end=function(){return this.writeOffset!==this.buffer.length&&console.error("Incorrect encoding buffer size"),this.buffer},n.prototype.readNodeJS=function(){if("OTG0"!==this.buffer.toString("ascii",0,4))return console.error("Invalid OTG header"),!1;if(this.readOffset=4,this.meshFlag=this.buffer.readUInt16LE(this.readOffset),this.readOffset+=2,this.numBuffers=this.buffer.readUInt8(this.readOffset),this.readOffset++,this.numAttributes=this.buffer.readUInt8(this.readOffset),this.readOffset++,this.numBuffers){this.bufferOffsets.push(0);for(var a=1;a<this.numBuffers;a++){var b=this.buffer.readUInt32LE(this.readOffset);this.readOffset+=4,this.bufferOffsets.push(b)}}for(var a=0;a<this.numAttributes;a++){var c={};c.name=this.buffer.readUInt8(this.readOffset),this.readOffset++;var d=this.buffer.readUInt8(this.readOffset);this.readOffset++,c.itemSize=15&d,c.type=d>>4,c.bytesPerItem=y[c.type],c.normalize=c.type===u.BYTE_NORM||c.type===u.SHORT_NORM||c.type===u.UBYTE_NORM||c.type===u.USHORT_NORM,c.itemOffset=this.buffer.readUInt8(this.readOffset)/4,this.readOffset++,c.itemStride=this.buffer.readUInt8(this.readOffset)/4,this.readOffset++,c.bufferIndex=this.buffer.readUInt8(this.readOffset),this.readOffset++,this.attributes.push(c)}for(;this.readOffset%4!=0;)this.readOffset++;for(var a=0;a<this.bufferOffsets.length;a++){var e,f=this.readOffset+this.bufferOffsets[a];e=a<this.bufferOffsets.length-1?this.readOffset+this.bufferOffsets[a+1]:this.buffer.length,this.buffers.push(this.buffer.slice(f,e))}return!0},n.prototype.readWeb=function(){var a=new r.InputStream(this.buffer);if("OTG0"!==a.getString(4))return console.error("Invalid OTG header"),!1;if(this.meshFlag=a.getUint16(),this.numBuffers=a.getUint8(),this.numAttributes=a.getUint8(),this.numBuffers){this.bufferOffsets.push(0);for(var b=1;b<this.numBuffers;b++){var c=a.getUint32();this.bufferOffsets.push(c)}}for(var b=0;b<this.numAttributes;b++){var d={};d.name=a.getUint8();var e=a.getUint8();d.itemSize=15&e,d.type=e>>4,d.bytesPerItem=y[d.type],d.normalize=d.type===u.BYTE_NORM||d.type===u.SHORT_NORM||d.type===u.UBYTE_NORM||d.type===u.USHORT_NORM,d.itemOffset=a.getUint8()/4,d.itemStride=a.getUint8()/4,d.bufferIndex=a.getUint8(),this.attributes.push(d)}for(;a.offset%4!=0;)a.offset++;for(var b=0;b<this.bufferOffsets.length;b++){var f,g=a.offset+this.bufferOffsets[b];f=b<this.bufferOffsets.length-1?a.offset+this.bufferOffsets[b+1]:a.byteLength,this.buffers.push(this.buffer.subarray(g,f))}return!0},n.prototype.read=function(){return(0,q.isNodeJS)()?this.readNodeJS():this.readWeb()};var z=new s.LmvBox3;z.min.x=-.5,z.min.y=-.5,z.min.z=-.5,z.max.x=.5,z.max.y=.5,z.max.z=.5;var A={center:{x:0,y:0,z:0},radius:Math.sqrt(.75)}},function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0}),b.LocalDbCache=void 0;var e=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=(c(7),c(4)),g=c(8),h="otg-content",i="otg-lru";b.LocalDbCache=function(){function a(){d(this,a),this.db=null,this.readTransaction=null,this.loaded=!1,this.storeName=h,this.storeNameTimestamp=i,this.bothStoreNames=[this.storeName,this.storeNameTimestamp],this.useCompression=!0,this.pendingTimestampUpdates={},this.pendingTimestampCount=0,this.pendingStores=[]}return e(a,[{key:"open",value:function(a,b){var c=this;if(b||(0,f.isSafari)()||(0,f.isMobileDevice)()||(0,f.isNodeJS)()||"undefined"==typeof indexedDB)return console.log("IndexedDb disabled"),void(a&&a());var d=indexedDB.open("otg",1);d.onerror=function(b){console.error("Failed to open or create cache database."),a&&a(b)},d.onsuccess=function(b){c.db=b.target.result,c.db.onerror=function(a){console.error("Database error",a)},c.loaded=!0,a&&a(null,c.db)},d.onupgradeneeded=function(a){console.log("Db upgrade",c.storeName);var b=a.target.result;b.createObjectStore(h),b.createObjectStore(i).createIndex(i+"-index","t",{unique:!1})}}},{key:"deleteOld",value:function(a){var b=this;if(!this.db)return void a();if(!this.deleteInProgress){this.deleteInProgress=!0;var c=IDBKeyRange.upperBound(Date.now()-3e5,!0),d=[];this.db.transaction([this.storeNameTimestamp]).objectStore(this.storeNameTimestamp).index(this.storeNameTimestamp+"-index").openCursor(c).onsuccess=function(c){var e=c.target.result;if(e&&d.length<200)return d.push(e.primaryKey),void e.continue();if(d.length){console.log("Deleting old objects.",d.length);var f=b.db.transaction(b.bothStoreNames,"readwrite");f.oncomplete=function(c){b.deleteInProgress=!1,console.log("Delete done"),a&&a()},f.onerror=function(a){b.deleteInProgress=!1,console.error("Transaction error.",a)},f.onabort=function(a){b.deleteInProgress=!1;var c=a.target.error;console.log("Failed to delete cached objects",c)};for(var g=f.objectStore(b.storeName),h=f.objectStore(b.storeNameTimestamp),i=0;i<d.length;i++)g.delete(d[i]),h.delete(d[i])}}}}},{key:"flush",value:function(a){var b=this;if(!this.pendingStores.length)return void(a&&a());if(!this.writeTransaction){var c=this.db.transaction(this.bothStoreNames,"readwrite");a&&(c.oncomplete=function(b){a()}),c.onerror=function(b){console.error("Transaction error.",b),a&&a(b.target.error)},c.onabort=function(c){"QuotaExceededError"===c.target.error.name&&b.deleteOld(function(){}),a&&a(c.target.error)},this.writeTransaction=c}for(var d=0;d<this.pendingStores.length;d+=2){var e=this.pendingStores[d],f=this.pendingStores[d+1];if(f instanceof Uint8Array&&this.useCompression)if(31===f[0]&&139===f[1]);else try{f=g.gzip(f)}catch(a){console.error("Compression failed.")}this.writeTransaction.objectStore(this.storeName).put(f,e).onerror=function(a){console.error("Object store error.",a)};this.writeTransaction.objectStore(this.storeNameTimestamp).put({t:Date.now()},e)}this.pendingStores=[],this.writeTransaction=null}},{key:"store",value:function(a,b,c){return this.db?(this.pendingStores.push(a),this.pendingStores.push(b),this.pendingStores.length<200?void(c&&c()):void this.flush(c)):void(c&&c())}},{key:"flushTimestamps",value:function(a){var b=this,c=this.db.transaction([this.storeNameTimestamp],"readwrite");a&&(c.oncomplete=function(b){a()}),c.onerror=function(b){console.error("Transaction error.",b),a&&a(b.target.error)},c.onabort=function(c){"QuotaExceededError"===c.target.error.name&&(console.log("Quota exceeded"),b.deleteOld(function(){})),a&&a(c.target.error)};var d=c.objectStore(this.storeNameTimestamp);for(var e in this.pendingTimestampUpdates)d.put({t:this.pendingTimestampUpdates[e]},e);this.pendingTimestampUpdates={},this.pendingTimestampCount=0}},{key:"_createReadTransaction",value:function(){var a=this,b=this.readTransaction=this.db.transaction(this.storeName);b.oncomplete=function(b){a.readTransaction=null},b.onerror=function(b){console.error("Transaction error.",comment,b),a.readTransaction=null},b.onabort=function(b){console.warn("Transaction abort",comment,b),a.readTransaction=null}}},{key:"get",value:function(a,b){var c=this;if(!this.db)return void b(-1,null);this.readTransaction||this._createReadTransaction();var d=void 0;try{d=this.readTransaction.objectStore(this.storeName).get(a)}catch(b){this._createReadTransaction(),d=this.readTransaction.objectStore(this.storeName).get(a)}d.onsuccess=function(d){if(!d.target.result)return void b(-1,null);var e=d.target.result;if(31===e[0]&&139===e[1])try{e=g.ungzip(e)}catch(a){return console.error("Failed to decompress.",a),void b(a,null)}b(null,e),c.pendingTimestampUpdates[a]=Date.now(),c.pendingTimestampCount++},d.onerror=function(a){b(a.target.errorCode)}}},{key:"updatePendingTimestamps",value:function(){var a=this;this.db&&this.flush(function(b){b||a.flushTimestamps()})}},{key:"size",value:function(a){if(!this.db)return void a();var b=0,c=0,d=this.db.transaction([this.storeName]).objectStore(this.storeName).openCursor();d.onsuccess=function(d){var e=d.target.result;if(e){var f=e.value;b+=f.length,c++,e.continue()}else a(null,{size:b,items:c})},d.onerror=function(b){a(b)}}}]),a}()},function(a,b,c){"use strict";function d(a,b){this.pdb=null,this.waitingCallbacks=[],this.error=!1,this.dbPath=a,this.dbFiles=null,this.isShared=b}function e(a){this.data=a,this.refCount=1}function f(a,b,c){function e(a){if(m--,a||n++,!m)if(n)for(f.error=!0,c(null);f.waitingCallbacks.length;)f.waitingCallbacks.shift()(null);else{k.forEach(function(a){a.storage=null});try{f.pdb=new s.PropertyDatabase(j),f.pdb.refCount=0,f.loaded=!0,f.dbFiles=k;for(var b in j.dbid){var d=j.dbid[b];f.dbidOldToNew=new Int32Array(d.buffer,d.byteOffset,d.byteLength/4);break}for(c(f.pdb,f.dbidOldToNew);f.waitingCallbacks.length;)f.waitingCallbacks.shift()(f.pdb)}catch(a){c(null)}}}a.worker.pdbCache||(a.worker.pdbCache={},a.worker.fileCache={});var f=a.worker.pdbCache[a.dbPath],h=!1;if(f?h=!0:a.worker.pdbCache[a.dbPath]=f=new d(a.dbPath,a.sharedDbPath),f.pdb)return void c(f.pdb,f.dbidOldToNew);if(f.error)return void c(null);if(h)return void f.waitingCallbacks.push(c);var i=a.propertydb;if(!i)return a.worker.propdbFailed=!0,void c(null);var j={},k=[];if(i.avs.length)for(var l in i)j[l]={},k.push({filename:i[l][0],storage:j[l]});else j={ids:{},attrs:{},offsets:{},values:{},avs:{}},k.push({filename:i.attrs.length?i.attrs[0]:"objects_attrs.json.gz",storage:j.attrs}),k.push({filename:i.values.length?i.values[0]:"objects_vals.json.gz",storage:j.values}),k.push({filename:i.avs.length?i.avs[0]:"objects_avs.json.gz",storage:j.avs}),k.push({filename:i.offsets.length?i.offsets[0]:"objects_offs.json.gz",storage:j.offsets}),k.push({filename:i.ids.length?i.ids[0]:"objects_ids.json.gz",storage:j.ids});var m=k.length,n=0;k.forEach(function(b){g(b.filename,a,e,b.storage)})}function g(a,b,c,d){function f(a,d,e){404!==a&&b.onFailureCallback(a,d,e),c(null)}var g;g=-1!==a.indexOf("://")||0===a.indexOf("urn:")?a:(b.dbPath||"")+a;var h=r.ViewingService.generateUrl(b.endpoint,"items",g),i=function(a){b.worker.fileCache[h]=new e(a),d[h]=a,c(a)},j=b.worker.fileCache[h];j?(j.refCount++,i(j.data)):r.ViewingService.getItem(b,g,i,f)}function h(a){function b(b,d){if(!b)return void c.postMessage({cbId:a.cbId,error:{instanceTree:null,maxTreeDepth:0}});b.refCount++,b.rootsDone||(b.idroots=b.findRootNodes(),b.objCount=b.getObjectCount(),b.rootsDone=!0);var e,f,g=[0],h=[],i=a.fragToDbId;if(a.needsDbIdRemap)if(d)if(i){for(var j=d,k=[],l=0;l<i.length;l++){var m=i[l];if(Array.isArray(m)){k[l]=[];for(var n=0;n<m.length;n++)k[l][n]=j[m[n]]}else k[l]=j[m]}i=k}else console.warn("No frag->dbid mapping!.");else console.warn("ID remap required, but not loaded.");var o=b.idroots;if(o&&o.length){if(f=new t.InstanceTreeStorage(b.getObjectCount(),i?i.length:0),1==o.length)e=o[0],b.buildObjectTree(e,i,g,f);else{e=-1e10;for(var p=[],l=0;l<o.length;l++)b.buildObjectTree(o[l],i,g,f),p.push(o[l]);f.setNode(e,0,"",0,p,!1)}if(f.flatten(),h.push(f.nodes.buffer),h.push(f.children.buffer),h.push(f.strings.buf.buffer),h.push(f.strings.idx.buffer),a.fragBoxes){var q=new t.InstanceTreeAccess(f,e);q.computeBoxes(a.fragBoxes),h.push(q.nodeBoxes.buffer)}}c.postMessage({cbId:a.cbId,result:{rootId:e,instanceTreeStorage:f,instanceBoxes:q?q.nodeBoxes:void 0,dbidOldToNew:a.needsDbIdRemap?d:null,maxTreeDepth:g[0],objectCount:b.objCount}},h)}var c=a.worker;f(a,null,b)}function i(a){var b=a.worker,c=b.pdbCache&&b.pdbCache[a.dbPath];if(c&&c.pdb){var d=a.searchText,e=c.pdb.bruteForceSearch(d,a.attributeNames);b.postMessage({cbId:a.cbId,result:e})}}function j(a){var b=a.worker,c=b.pdbCache&&b.pdbCache[a.dbPath],d=b.pdbCache&&b.pdbCache[a.dbPath2],e=c&&c.pdb,f=d&&d.pdb;if(e&&f){var g=e.findDifferences(f,a.diffOptions);b.postMessage({cbId:a.cbId,result:g})}}function k(a){var b=a.worker,c=b.pdbCache&&b.pdbCache[a.dbPath];if(c&&c.pdb){var d=c.pdb.bruteForceFind(a.propertyName);b.postMessage({cbId:a.cbId,result:d})}}function l(a){var b=a.worker,c=b.pdbCache&&b.pdbCache[a.dbPath];if(c&&c.pdb){var d=c.pdb.findLayers();b.postMessage({cbId:a.cbId,result:d})}}function m(a){var b=a.worker,c=b.pdbCache&&b.pdbCache[a.dbPath];if(!c||!c.pdb)return void a.worker.postMessage({cbId:a.cbId,error:{msg:"Properties are not available."}});var d=a.dbId,e=a.dbIds,f=a.propFilter,g=a.ignoreHidden;if(void 0!==e){var h=[];if(e&&e.length)for(var i=0;i<e.length;i++){var j=c.pdb.getObjectProperties(e[i],f,g);j&&h.push(j)}else for(var i=1,k=c.pdb.getObjectCount();i<=k;i++){var j=c.pdb.getObjectProperties(i,f,g);j&&h.push(j)}a.worker.postMessage({cbId:a.cbId,result:h})}else{var j=c.pdb.getObjectProperties(d,f);a.worker.postMessage({cbId:a.cbId,result:j})}}function n(a){var b=a.worker,c=b.pdbCache&&b.pdbCache[a.dbPath];if(c&&c.pdb){var d=c.pdb.getExternalIdMapping();b.postMessage({cbId:a.cbId,result:d})}}function o(a){var b=a.worker,c=b.pdbCache&&b.pdbCache[a.dbPath];if(c&&c.pdb){var d=c.pdb.getLayerToNodeIdMapping();b.postMessage({cbId:a.cbId,result:d})}}function p(a){var b=a.worker;if(a.clearCaches)return b.pdbCache={},void(b.fileCache={});var c=b.pdbCache&&b.pdbCache[a.dbPath];if(c&&c.pdb&&0===--c.pdb.refCount&&(c.isShared||delete b.pdbCache[a.dbPath],!c.isShared))for(var d in c.dbFiles){var e=c.dbFiles[d];for(var f in e.storage){var g=b.fileCache[f];g&&0===--g.refCount&&delete b.fileCache[f]}}}function q(a){a.register("BUILD_EXTERNAL_ID_MAPPING",{doOperation:n}),a.register("BUILD_LAYER_TO_NODE_ID_MAPPING",{doOperation:o}),a.register("GET_PROPERTIES",{doOperation:m}),a.register("SEARCH_PROPERTIES",{doOperation:i}),a.register("DIFF_PROPERTIES",{doOperation:j}),a.register("FIND_PROPERTY",{doOperation:k}),a.register("FIND_LAYERS",{doOperation:l}),a.register("LOAD_PROPERTYDB",{doOperation:h}),a.register("UNLOAD_PROPERTYDB",{doOperation:p})}Object.defineProperty(b,"__esModule",{value:!0}),b.register=q;var r=c(2),s=c(61),t=c(63)},function(a,b,c){"use strict";function d(a,b){var c,d=0,e=0;do{c=a[b[0]++],d|=(127&c)<<e,e+=7}while(128&c);return d}function e(a){function b(a){for(var b={},c=0,d=a.length;c<d;c++){var e=a[c];Array.isArray(e)||(e=[e]);for(var f=0;f<e.length;f++){var g=e[f],h=b[g];void 0===h?b[g]=c:Array.isArray(h)?h.push(c):b[g]=[h,c]}}return b}var c,e,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this,x=!1,y=!1;for(var z in a.attrs){c=(0,f.blobToJson)(a.attrs[z]),"pdb version 2"===c[0]&&(x=!0);for(var A=1;A<c.length;A++){switch(c[A][0]){case"Layer":v=A}switch(c[A][1]){case"__parent__":p=A;break;case"__child__":o=A;break;case"__name__":q=A;break;case"__instanceof__":r=A;break;case"__viewable_in__":s=A;break;case"__externalref__":t=A;break;case"__node_flags__":u=A}x&&c[A][2]===h.DbKey&&(c[A][6]=c[A][6]|i.afDirectStorage)}break}for(var z in a.avs){var B=a.avs[z];B[0]==="[".charCodeAt(0)?j=(0,f.parseIntArray)(a.avs[z],0):(j=B,y=!0),delete a.avs;break}for(var z in a.offsets){var B=a.offsets[z];B[0]==="[".charCodeAt(0)?(e=(0,f.parseIntArray)(B,1),e[e.length-1]=j.length/2):e=new Int32Array(B.buffer,B.byteOffset,B.byteLength/4),delete a.offsets;break}for(var z in a.values){k=a.values[z],l=(0,f.findValueOffsets)(k);break}for(var z in a.ids){m=a.ids[z],n=(0,f.findValueOffsets)(m);break}this.getObjectCount=function(){return e.length-1},this.getValueAt=function(a){return(0,f.subBlobToJson)(k,l[a])},this.getIntValueAt=function(a){return(0,f.subBlobToJsonInt)(k,l[a])},this.getIdAt=function(a){return(0,f.subBlobToJson)(m,n[a])},this.getAttrValue=function(a,b,d){var e=c[a];return e[6]&i.afDirectStorage&&e[2]===h.DbKey?b:d?this.getIntValueAt(b):this.getValueAt(b)},this._getObjectProperty=function(a,b){var d=c[a],e=d[5]?d[5]:d[0],f=this.attributeHidden(a);return{displayName:e,displayValue:w.getAttrValue(a,b),displayCategory:d[1],attributeName:d[0],type:d[2],units:d[3],hidden:f,precision:d[7]||0}},this.getObjectProperties=function(a,b,d,e){var f={dbId:a,properties:[]},g=!1,h=!1;if((!b||-1!==b.indexOf("externalId"))&&(f.externalId=this.getIdAt(a),g=!0,b&&1===b.length))return f;var i=null;if(this.enumObjectProperties(a,function(a,g){if(a==r){var j=w.getObjectProperties(w.getAttrValue(a,g),b,!0,e);return void(j&&j.properties&&(i=j))}var k=c[a];if(!(b&&-1===b.indexOf(k[0])&&-1===b.indexOf(k[5])||e&&(e.indexOf(k[0])>-1||e.indexOf(k[5])>-1)))if(a==q){var l=w.getAttrValue(a,g);h=!0,f.name=l}else{var m=w.attributeHidden(a);if(d&&m)return;var n=w._getObjectProperty(a,g);f.properties.push(n)}}),i){for(var j={},k=f.properties,l=0;l<k.length;l++)j[k[l].displayName]=1;f.name||(f.name=i.name);for(var m=i.properties,l=0;l<m.length;l++)j.hasOwnProperty(m[l].displayName)||k.push(m[l])}return!b||f.properties.length||g||h?f:null},this.getExternalIdMapping=function(){var a={};if(n&&"length"in n)for(var b=1,c=n.length;b<c;++b){var d=this.getIdAt(b);a[d]=b}return a},this.findRootNodes=function(){var a=[];return this.enumObjects(function(b){var c=!1,d=!1,e=!1;w.enumObjectProperties(b,function(a,b){a==p?w.getAttrValue(a,b,!0)&&(d=!0):a==o?c=!0:a==q&&(e=!0)}),c&&e&&!d&&a.push(b)}),a},this.getNodeNameAndChildren=function(a,b){var c,d=a.dbId;return this.enumObjectProperties(d,function(d,e){var f;if(d==p);else if(d!=o||b)d==q?a.name=w.getAttrValue(d,e):d==u&&(a.flags=w.getAttrValue(d,e,!0));else{f=w.getAttrValue(d,e,!0);var g={dbId:f,parent:a.dbId};c?c.push(g):c=[g]}}),a.name||this.enumObjectProperties(d,function(b,c){if(b==r){var d={dbId:w.getAttrValue(b,c,!0),name:null};w.getNodeNameAndChildren(d,!0),d&&d.name&&!a.name&&(a.name=d.name)}}),c};this.buildObjectTree=function(a,c,d,e){var f;return c&&(f=b(c)),this.buildObjectTreeRec(a,0,f,0,d,e)},this.buildObjectTreeRec=function(a,b,c,d,e,f){d>e[0]&&(e[0]=d);var g={dbId:a},h=this.getNodeNameAndChildren(g),i=[];if(h)for(var j=0;j<h.length;j++){var k=this.buildObjectTreeRec(h[j].dbId,a,c,d+1,e,f);k&&i.push(h[j].dbId)}var l;if(c){var m=c[a];void 0!==m&&(l=Array.isArray(m)?m:[m])}var n=g.flags||0;return void 0===n&&(n=l&&l.length?6:(i.length,0)),f.setNode(a,b,g.name,n,i,l),i.length+(l?l.length:0)},this.getSearchTerms=function(a){a=a.toLowerCase();for(var b=a.match(/"[^"]+"|[^\s]+/g)||[],c=b.length;c--;)b[c]=b[c].replace(/"/g,"");for(var d=[],c=0;c<b.length;c++)b[c].length>1&&d.push(b[c]);return d},this.bruteForceSearch=function(a,b){var d=this.getSearchTerms(a);if(0===d.length)return[];for(var e=[],f=0;f<d.length;f++){for(var h=[],i=[],j=0,k=l.length;j<k;j++){var m=this.getValueAt(j);null!==m&&(-1!==m.toString().toLowerCase().indexOf(d[f])&&i.push(j))}0!==i.length?(i.sort(function(a,b){return a-b}),this.enumObjects(function(a){w.enumObjectProperties(a,function(d,e){if(!w.attributeHidden(d)&&-1!==(0,g.binarySearch)(i,e)){if(b&&b.length&&-1===b.indexOf(c[d][0]))return;return h.push(a),!0}})}),e.push(h)):e.push(h)}if(1===e.length)return e[0];for(var n={},o=e[0],j=0;j<o.length;j++)n[o[j]]=1;for(var p=1;p<e.length;p++){o=e[p];for(var q={},j=0;j<o.length;j++)1===n[o[j]]&&(q[o[j]]=1);n=q}var h=[];for(var f in n)h.push(parseInt(f));return h},this.bruteForceFind=function(a){var b=[];return this.enumObjects(function(d){var e=!1;w.enumObjectProperties(d,function(b,d){var f=c[b],g=f[0],h=f[5];if(g===a||h===a)return e=!0,!0}),e&&b.push(d)}),b},this.getLayerToNodeIdMapping=function(){var a={};return this.enumObjects(function(b){w.enumObjectProperties(b,function(c,d){if(c==v){var e=w.getAttrValue(c,d);return Array.isArray(a[e])||(a[e]=[]),a[e].push(b),!0}})}),a},this.getAttributeDef=function(a){var b=c[a];return{name:b[0],category:b[1],dataType:b[2],dataTypeContext:b[3],description:b[4],displayName:b[5],flags:b[6]}},this.enumAttributes=function(a){for(var b=1;b<c.length&&!a(b,this.getAttributeDef(b),c[b]);b++);},this.enumObjectProperties=function(a,b){if(y)for(var c=e[a],f=e[a+1],g=[c],h=0;g[0]<f;){var i=d(j,g)+h;h=i;var k=d(j,g);if(b(i,k))break}else for(var c=2*e[a],f=2*e[a+1],l=c;l<f;l+=2){var m=j[l],n=j[l+1];if(b(m,n))break}},this.findLayers=function(){var a={name:"root",id:1,index:1,children:[],isLayer:!1,childCount:0};if(void 0===v)return a;for(var b=[],c=j.length/2,d=0;d<c;++d){var e=2*d,f=j[e],g=j[e+1];if(f===v){var h=this.getValueAt(g);-1===b.indexOf(h)&&b.push(h)}}return b.sort(function(a,b){return a.localeCompare(b,void 0,{sensitivity:"base",numeric:!0})}),a.childCount=b.length,a.children=b.map(function(a,b){return{name:a,index:b+1,id:b+1,isLayer:!0}}),a},this.enumObjects=function(a,b,c){var d=e.length-1;b="number"==typeof b?Math.max(b,1):1,c="number"==typeof c?Math.min(d,c):d;for(var f=b;f<c&&!a(f);f++);},this.getAttrChild=function(){return o},this.getAttrParent=function(){return p},this.getAttrName=function(){return q},this.getAttrLayers=function(){return v},this.getAttrInstanceOf=function(){return r},this.getAttrViewableIn=function(){return s},this.getAttrXref=function(){return t},this.getAttrNodeFlags=function(){return u},this.attributeHidden=function(a){return 1&c[a][6]||a==p||a==o||a==s||a==t},this._getAttributeAndValueIds=function(a,b,c,d){var e=function(a,c){if(a===r){var e=w.getAttrValue(a,c);if(d){var f=d.result;e!==d.dbId&&(f.length=0,w._getAttributeAndValueIds(e,f,!1),d.dbId=e),b.push.apply(b,f)}else w._getAttributeAndValueIds(e,b,!1)}else w.attributeHidden(a)||b.push({attrId:a,valId:c})};if(w.enumObjectProperties(a,e),c){var f=function(a,b){return a.attrId-b.attrId};b.sort(f)}},this.findDifferences=function(a,b){var c={changedIds:[]},d=b&&b.dbIds,e=b&&b.listPropChanges;e&&(c.propChanges=[]);var f=this,g=a,h=[],i=[],j={result:[],dbId:-1},k={result:[],dbId:-1},l=function(a){var b=0,d=0;if(h.length=0,i.length=0,f._getAttributeAndValueIds(a,h,!0,j),g._getAttributeAndValueIds(a,i,!0,k),h.length&&i.length){for(var l=!1,m=void 0;b<h.length&&d<i.length;){var n=h[b],o=i[d],p=n&&n.attrId,q=n&&n.valId,r=o&&o.attrId,s=o&&o.valId;if(p!==r||q!==s){if(l=!0,!e)break;var t=void 0===p||p>r,u=void 0===r||r>p,v=void 0;t?(v=g._getObjectProperty(r,s),v.displayValueB=v.displayValue,v.displayValue=void 0,d++):u?(v=f._getObjectProperty(p,q),v.displayValueB=void 0,b++):(v=f._getObjectProperty(p,q),v.displayValueB=w.getAttrValue(r,s),b++,d++),m||(m=[]),m.push(v)}else b++,d++}l&&(c.changedIds.push(a),e&&c.propChanges.push(m))}};if(d)for(var m=0;m<d.length;m++){var n=d[m];l(n)}else for(var o=Math.min(f.getObjectCount(),this.getObjectCount()),n=1;n<o;n++)l(n);return c},this.dtor=function(){c=null,e=null,j=null,k=null,l=null,m=null,n=null,o=0,p=0,q=0,r=0,s=0,t=0,u=0}}Object.defineProperty(b,"__esModule",{value:!0}),b.PropertyDatabase=e;var f=c(7),g=c(62),h={Unknown:0,Boolean:1,Integer:2,Double:3,Float:4,BLOB:10,DbKey:11,String:20,LocalizableString:21,DateTime:22,GeoLocation:23,Position:24},i={afHidden:1,afDontIndex:2,afDirectStorage:4}},function(a,b){"use strict";function c(a,b){for(var c=0,d=a.length-1,e=void 0;c<=d;){if(e=(c+d)/2|0,b===a[e])return e;b<a[e]?d=e-1:c=e+1}return-1}Object.defineProperty(b,"__esModule",{value:!0}),b.binarySearch=c},function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){this.nodes=[],this.nextNode=0,this.children=[],this.nextChild=0,this.dbIdToIndex={},this.names=[],this.s2i={},this.strings=new j,this.nameSuffixes=[],this.getIndex(0)}function f(a){var b=new Int32Array(a.length);return b.set(a),b}function g(a,b,c){this.nodes=a.nodes,this.children=a.children,this.dbIdToIndex=a.dbIdToIndex,this.names=a.names,this.nameSuffixes=a.nameSuffixes,this.strings=new j(a.strings),this.rootId=b,this.numNodes=this.nodes.length/k,this.visibleIds=null,this.nodeBoxes=c}Object.defineProperty(b,"__esModule",{value:!0}),b.FlatStringStorage=void 0;var h=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();b.InstanceTreeStorage=e,b.InstanceTreeAccess=g;var i=c(7),j=b.FlatStringStorage=function(){function a(b){d(this,a),b?(this.buf=b.buf,this.idx=b.idx,this.next=b.next):(this.buf=new Uint8Array(256),this.next=0,this.idx=[0])}return h(a,[{key:"allocate",value:function(a){if(this.buf.length-this.next<a){var b=Math.max(3*this.buf.length/2,this.buf.length+a),c=new Uint8Array(b);c.set(this.buf),this.buf=c}}},{key:"add",value:function(a){if(null===a||void 0===a)return 0;if(!a.length)return this.idx.push(this.next),this.idx.length-1;var b=(0,i.utf16to8)(a,null);return this.allocate(b),this.next+=(0,i.utf16to8)(a,this.buf,this.next),this.idx.push(this.next),this.idx.length-1}},{key:"get",value:function(a){if(a){var b=this.idx[a-1],c=this.idx[a];return b===c?"":(0,i.utf8BlobToStr)(this.buf,b,c-b)}}},{key:"flatten",value:function(){this.idx=f(this.idx)}}]),a}(),k=5;e.prototype.getIndex=function(a){var b=this.dbIdToIndex[a];if(b)return b;b=this.nextNode++,this.nodes.push(a);for(var c=1;c<k;c++)this.nodes.push(0);return this.dbIdToIndex[a]=b,b},e.prototype.setNode=function(a,b,c,d,e,f){var g=this.getIndex(a),h=g*k,i=e.length,j=f&&f.length;j&&(i+=f.length),this.nodes[h+1]=b,this.nodes[h+2]=this.nextChild,this.nodes[h+3]=j?-i:i,this.nodes[h+4]=d;var l;for(l=0;l<e.length;l++)this.children[this.nextChild++]=this.getIndex(e[l]);if(j)for(l=0;l<f.length;l++)this.children[this.nextChild++]=-f[l]-1;this.nextChild>this.children.length&&console.error("Child index out of bounds -- should not happen"),this.processName(g,c)},e.prototype.processName=function(a,b){var c,d,e=-1,f=-1;if(b&&(f=b.lastIndexOf("]"),-1!==(e=b.lastIndexOf("["))&&-1!==f||(e=b.lastIndexOf(":"),f=b.length)),e>=0&&f>e){c=b.slice(0,e+1);var g=b.slice(e+1,f);d=parseInt(g,10),d&&d+""===g||(c=b,d=0)}else c=b,d=0;var h=this.s2i[c];void 0===h&&(h=this.strings.add(c),this.s2i[c]=h),this.names[a]=h,this.nameSuffixes[a]=d},e.prototype.flatten=function(a,b,c,d,e,g){this.nodes=f(this.nodes),this.children=f(this.children),this.names=f(this.names),this.nameSuffixes=f(this.nameSuffixes),this.strings.flatten(),this.s2i=null},g.prototype.getNumNodes=function(){return this.numNodes},g.prototype.getIndex=function(a){return this.dbIdToIndex[a]},g.prototype.name=function(a){var b=this.dbIdToIndex[a],c=this.strings.get(this.names[b]),d=this.nameSuffixes[b];if(d){return"["===c.charAt(c.length-1)?c+d+"]":c+d}return c},g.prototype.getParentId=function(a){var b=this.dbIdToIndex[a];return this.nodes[b*k+1]},g.prototype.getNodeFlags=function(a){var b=this.dbIdToIndex[a];return this.nodes[b*k+4]},g.prototype.setNodeFlags=function(a,b){var c=this.dbIdToIndex[a];c&&(this.nodes[c*k+4]=b)},g.prototype.getNumChildren=function(a){var b=this.dbIdToIndex[a],c=this.nodes[b*k+3];if(c>=0)return c;var d=this.nodes[b*k+2];c=Math.abs(c);for(var e=0,f=0;f<c;f++){if(this.children[d+f]<0)break;e++}return e},g.prototype.getNumFragments=function(a){var b=this.dbIdToIndex[a],c=this.nodes[b*k+3];if(c>=0)return 0;var d=this.nodes[b*k+2];c=Math.abs(c);for(var e=0,f=c-1;f>=0;f--){if(this.children[d+f]>=0)break;e++}return e},g.prototype.getNodeBox=function(a,b){for(var c=this.getIndex(a),d=6*c,e=0;e<6;e++)b[e]=this.nodeBoxes[d+e]},g.prototype.getVisibleIds=function(){return this.visibleIds||(this.visibleIds=Object.keys(this.dbIdToIndex).map(function(a){return parseInt(a)})),this.visibleIds},g.prototype.enumNodeChildren=function(a,b){var c=this.dbIdToIndex[a],d=this.nodes[c*k+2],e=this.nodes[c*k+3];e=Math.abs(e);for(var f=0;f<e;f++){var g=this.children[d+f];if(g<0)break;if(b(this.nodes[g*k+0],a,c))return a}},g.prototype.enumNodeFragments=function(a,b){var c=this.dbIdToIndex[a],d=this.nodes[c*k+2],e=this.nodes[c*k+3];if(e<0){e=-e;for(var f=0;f<e;f++){var g=this.children[d+f];if(!(g>0)&&b(-g-1,a,c))return a}}},g.prototype.computeBoxes=function(a){function b(a,b,c){var f=e.getIndex(a);d(a,f);for(var h=6*c,i=6*f,j=0;j<3;j++)g[h+j]>g[i+j]&&(g[h+j]=g[i+j]),g[h+j+3]<g[i+j+3]&&(g[h+j+3]=g[i+j+3])}function c(b,c,d){for(var e=6*b,f=6*d,h=0;h<3;h++)g[f+h]>a[e+h]&&(g[f+h]=a[e+h]),g[f+h+3]<a[e+h+3]&&(g[f+h+3]=a[e+h+3])}function d(a,d){var f=6*d;g[f]=g[f+1]=g[f+2]=1/0,g[f+3]=g[f+4]=g[f+5]=-1/0,e.getNumChildren(a)&&e.enumNodeChildren(a,b,!0),e.getNumFragments(a)&&e.enumNodeFragments(a,c)}this.nodeBoxes||(this.nodeBoxes=new Float32Array(6*this.numNodes));var e=this,f=e.getIndex(e.rootId),g=e.nodeBoxes;d(e.rootId,f)}},function(a,b,c){"use strict";function d(a){for(var b=[],c=Array.isArray(a.image)?a.image:[a.image],d=0;d<c.length;d++)for(var e=c[d],f=0;f<e.mipmaps.length;f++){var g=e.mipmaps[f];b.push(g.data.buffer)}return b}function e(a){(0,g.DecodeEnvMap)(a.map,a.exposure,a.useHalfFloat),self.postMessage({map:a.map,id:a.id},d(a.map))}function f(a){a.register("DECODE_ENVMAP",{doOperation:e})}Object.defineProperty(b,"__esModule",{value:!0}),b.register=f;var g=c(65)},function(a,b,c){"use strict";function d(a,b){for(var c=255*a.x,d=255*a.y,e=255*a.z,f=255*b.x,g=255*b.y,h=255*b.z,i=new Uint8Array(16),k=new Uint8Array(16),l=new Uint8Array(16),m=0;m<4;m++)i[4*m]=c,i[4*m+1]=d,i[4*m+2]=e,i[4*m+3]=255,k[4*m]=f,k[4*m+1]=g,k[4*m+2]=h,k[4*m+3]=255,m>1?(l[4*m]=c,l[4*m+1]=d,l[4*m+2]=e,l[4*m+3]=255):(l[4*m]=f,l[4*m+1]=g,l[4*m+2]=h,l[4*m+3]=255);var n=new j.DataTexture(l,2,2,j.RGBAFormat),o=new j.DataTexture(l,2,2,j.RGBAFormat),p=new j.DataTexture(k,2,2,j.RGBAFormat),q=new j.DataTexture(i,2,2,j.RGBAFormat),r=new j.DataTexture(l,2,2,j.RGBAFormat),s=new j.DataTexture(l,2,2,j.RGBAFormat),t=new j.Texture(null,j.CubeReflectionMapping,j.RepeatWrapping,j.RepeatWrapping,j.LinearFilter,j.LinearFilter,j.RGBAFormat);return t.image=[o,n,q,p,s,r],t.needsUpdate=!0,t}function e(a,b){var c=255*b[2]+b[3],d=Math.pow(2,(c-127)/2),e=d/b[1],f=b[0]*e,g=m[0]*f+m[3]*d+m[6]*e,h=m[1]*f+m[4]*d+m[7]*e,i=m[2]*f+m[5]*d+m[8]*e;g<0&&(g=0),h<0&&(h=0),i<0&&(i=0),a[0]=g,a[1]=h,a[2]=i}function f(a,b,c){var d=.0625*Math.sqrt(b[0]*c),e=.0625*Math.sqrt(b[1]*c),f=.0625*Math.sqrt(b[2]*c),g=Math.max(Math.max(d,e),Math.max(f,1e-6));g>1&&(g=1);var h=Math.ceil(255*g)/255;d>1&&(d=1),e>1&&(e=1),f>1&&(f=1),a[3]=h;var i=1/h;a[0]=d*i,a[1]=e*i,a[2]=f*i}function g(a,b,c){var d=Math.sqrt(b[0]*c),e=Math.sqrt(b[1]*c),f=Math.sqrt(b[2]*c);d>65504&&(d=65504),e>65504&&(e=65504),f>65504&&(f=65504),a[0]=d,a[1]=e,a[2]=f}function h(a,b,c,d){if(!a.LogLuv)return void l.logger.warn("Environment map expected to be in LogLuv format.");for(var h=Math.pow(2,b),i=Array.isArray(a.image)?a.image:[a.image],m=0;m<i.length;m++)for(var p=i[m],q=0;q<p.mipmaps.length;q++){var r,s=p.mipmaps[q],t=s.data;c?(r=new Uint16Array(t.length/4*3),s.data=r):r=t.buffer;for(var u=0,v=0;v<t.length;v+=4)n[0]=t[v]/255,n[1]=t[v+1]/255,n[2]=t[v+2]/255,n[3]=t[v+3]/255,e(o,n),c?(g(n,o,h),r[u++]=(0,k.FloatToHalf)(n[0]),r[u++]=(0,k.FloatToHalf)(n[1]),r[u++]=(0,k.FloatToHalf)(n[2])):(f(n,o,h),t[v]=Math.round(255*n[0]),t[v+1]=Math.round(255*n[1]),
t[v+2]=Math.round(255*n[2]),t[v+3]=Math.round(255*n[3]))}a.LogLuv=!1,c?(a.type=j.HalfFloatType,a.format=j.RGBFormat,a.RGBM=!1,a.GammaEncoded=!0):a.RGBM=!0,d&&d(a)}Object.defineProperty(b,"__esModule",{value:!0}),b.CreateCubeMapFromColors=d,b.DecodeEnvMap=h;var i=c(66),j=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(i),k=c(68),l=c(3),m=[6.0014,-2.7008,-1.7996,-1.332,3.1029,-5.7721,.3008,-1.0882,5.6268],n=new Float32Array(4),o=new Float32Array(4)},function(a,b,c){(function(a){"use strict";var b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},c={REVISION:"71"};"object"===b(a)&&(a.exports=c),void 0===Math.sign&&(Math.sign=function(a){return a<0?-1:a>0?1:+a}),c.log=function(){console.log.apply(console,arguments)},c.warn=function(){console.warn.apply(console,arguments)},c.error=function(){console.error.apply(console,arguments)},c.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},c.CullFaceNone=0,c.CullFaceBack=1,c.CullFaceFront=2,c.CullFaceFrontBack=3,c.FrontFaceDirectionCW=0,c.FrontFaceDirectionCCW=1,c.BasicShadowMap=0,c.PCFShadowMap=1,c.PCFSoftShadowMap=2,c.FrontSide=0,c.BackSide=1,c.DoubleSide=2,c.NoShading=0,c.FlatShading=1,c.SmoothShading=2,c.NoColors=0,c.FaceColors=1,c.VertexColors=2,c.NoBlending=0,c.NormalBlending=1,c.AdditiveBlending=2,c.SubtractiveBlending=3,c.MultiplyBlending=4,c.CustomBlending=5,c.AddEquation=100,c.SubtractEquation=101,c.ReverseSubtractEquation=102,c.MinEquation=103,c.MaxEquation=104,c.ZeroFactor=200,c.OneFactor=201,c.SrcColorFactor=202,c.OneMinusSrcColorFactor=203,c.SrcAlphaFactor=204,c.OneMinusSrcAlphaFactor=205,c.DstAlphaFactor=206,c.OneMinusDstAlphaFactor=207,c.DstColorFactor=208,c.OneMinusDstColorFactor=209,c.SrcAlphaSaturateFactor=210,c.MultiplyOperation=0,c.MixOperation=1,c.AddOperation=2,c.UVMapping=300,c.CubeReflectionMapping=301,c.CubeRefractionMapping=302,c.EquirectangularReflectionMapping=303,c.EquirectangularRefractionMapping=304,c.SphericalReflectionMapping=305,c.RepeatWrapping=1e3,c.ClampToEdgeWrapping=1001,c.MirroredRepeatWrapping=1002,c.NearestFilter=1003,c.NearestMipMapNearestFilter=1004,c.NearestMipMapLinearFilter=1005,c.LinearFilter=1006,c.LinearMipMapNearestFilter=1007,c.LinearMipMapLinearFilter=1008,c.UnsignedByteType=1009,c.ByteType=1010,c.ShortType=1011,c.UnsignedShortType=1012,c.IntType=1013,c.UnsignedIntType=1014,c.FloatType=1015,c.HalfFloatType=1025,c.UnsignedShort4444Type=1016,c.UnsignedShort5551Type=1017,c.UnsignedShort565Type=1018,c.AlphaFormat=1019,c.RGBFormat=1020,c.RGBAFormat=1021,c.LuminanceFormat=1022,c.LuminanceAlphaFormat=1023,c.RGBEFormat=c.RGBAFormat,c.RGB_S3TC_DXT1_Format=2001,c.RGBA_S3TC_DXT1_Format=2002,c.RGBA_S3TC_DXT3_Format=2003,c.RGBA_S3TC_DXT5_Format=2004,c.RGB_PVRTC_4BPPV1_Format=2100,c.RGB_PVRTC_2BPPV1_Format=2101,c.RGBA_PVRTC_4BPPV1_Format=2102,c.RGBA_PVRTC_2BPPV1_Format=2103,c.Projector=function(){c.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(a,b){c.warn("THREE.Projector: .projectVector() is now vector.project()."),a.project(b)},this.unprojectVector=function(a,b){c.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),a.unproject(b)},this.pickingRay=function(a,b){c.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}},c.CanvasRenderer=function(){c.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElement("canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},c.Quaternion=function(a,b,c,d){this._x=a||0,this._y=b||0,this._z=c||0,this._w=void 0!==d?d:1},c.Quaternion.prototype={constructor:c.Quaternion,_x:0,_y:0,_z:0,_w:0,get x(){return this._x},set x(a){this._x=a,this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a,this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a,this.onChangeCallback()},get w(){return this._w},set w(a){this._w=a,this.onChangeCallback()},set:function(a,b,c,d){return this._x=a,this._y=b,this._z=c,this._w=d,this.onChangeCallback(),this},copy:function(a){return this._x=a.x,this._y=a.y,this._z=a.z,this._w=a.w,this.onChangeCallback(),this},setFromEuler:function(a,b){if(a instanceof c.Euler==!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var d=Math.cos(a._x/2),e=Math.cos(a._y/2),f=Math.cos(a._z/2),g=Math.sin(a._x/2),h=Math.sin(a._y/2),i=Math.sin(a._z/2);return"XYZ"===a.order?(this._x=g*e*f+d*h*i,this._y=d*h*f-g*e*i,this._z=d*e*i+g*h*f,this._w=d*e*f-g*h*i):"YXZ"===a.order?(this._x=g*e*f+d*h*i,this._y=d*h*f-g*e*i,this._z=d*e*i-g*h*f,this._w=d*e*f+g*h*i):"ZXY"===a.order?(this._x=g*e*f-d*h*i,this._y=d*h*f+g*e*i,this._z=d*e*i+g*h*f,this._w=d*e*f-g*h*i):"ZYX"===a.order?(this._x=g*e*f-d*h*i,this._y=d*h*f+g*e*i,this._z=d*e*i-g*h*f,this._w=d*e*f+g*h*i):"YZX"===a.order?(this._x=g*e*f+d*h*i,this._y=d*h*f+g*e*i,this._z=d*e*i-g*h*f,this._w=d*e*f-g*h*i):"XZY"===a.order&&(this._x=g*e*f-d*h*i,this._y=d*h*f-g*e*i,this._z=d*e*i+g*h*f,this._w=d*e*f+g*h*i),!1!==b&&this.onChangeCallback(),this},setFromAxisAngle:function(a,b){var c=b/2,d=Math.sin(c);return this._x=a.x*d,this._y=a.y*d,this._z=a.z*d,this._w=Math.cos(c),this.onChangeCallback(),this},setFromRotationMatrix:function(a){var b,c=a.elements,d=c[0],e=c[4],f=c[8],g=c[1],h=c[5],i=c[9],j=c[2],k=c[6],l=c[10],m=d+h+l;return m>0?(b=.5/Math.sqrt(m+1),this._w=.25/b,this._x=(k-i)*b,this._y=(f-j)*b,this._z=(g-e)*b):d>h&&d>l?(b=2*Math.sqrt(1+d-h-l),this._w=(k-i)/b,this._x=.25*b,this._y=(e+g)/b,this._z=(f+j)/b):h>l?(b=2*Math.sqrt(1+h-d-l),this._w=(f-j)/b,this._x=(e+g)/b,this._y=.25*b,this._z=(i+k)/b):(b=2*Math.sqrt(1+l-d-h),this._w=(g-e)/b,this._x=(f+j)/b,this._y=(i+k)/b,this._z=.25*b),this.onChangeCallback(),this},setFromUnitVectors:function(){var a,b;return function(d,e){return void 0===a&&(a=new c.Vector3),b=d.dot(e)+1,b<1e-6?(b=0,Math.abs(d.x)>Math.abs(d.z)?a.set(-d.y,d.x,0):a.set(0,-d.z,d.y)):a.crossVectors(d,e),this._x=a.x,this._y=a.y,this._z=a.z,this._w=b,this.normalize(),this}}(),inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();return 0===a?(this._x=0,this._y=0,this._z=0,this._w=1):(a=1/a,this._x=this._x*a,this._y=this._y*a,this._z=this._z*a,this._w=this._w*a),this.onChangeCallback(),this},multiply:function(a,b){return void 0!==b?(c.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},multiplyQuaternions:function(a,b){var c=a._x,d=a._y,e=a._z,f=a._w,g=b._x,h=b._y,i=b._z,j=b._w;return this._x=c*j+f*g+d*i-e*h,this._y=d*j+f*h+e*g-c*i,this._z=e*j+f*i+c*h-d*g,this._w=f*j-c*g-d*h-e*i,this.onChangeCallback(),this},multiplyVector3:function(a){return c.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),a.applyQuaternion(this)},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this._x,d=this._y,e=this._z,f=this._w,g=f*a._w+c*a._x+d*a._y+e*a._z;if(g<0?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a),g>=1)return this._w=f,this._x=c,this._y=d,this._z=e,this;var h=Math.acos(g),i=Math.sqrt(1-g*g);if(Math.abs(i)<.001)return this._w=.5*(f+this._w),this._x=.5*(c+this._x),this._y=.5*(d+this._y),this._z=.5*(e+this._z),this;var j=Math.sin((1-b)*h)/i,k=Math.sin(b*h)/i;return this._w=f*j+this._w*k,this._x=c*j+this._x*k,this._y=d*j+this._y*k,this._z=e*j+this._z*k,this.onChangeCallback(),this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,b){return void 0===b&&(b=0),this._x=a[b],this._y=a[b+1],this._z=a[b+2],this._w=a[b+3],this.onChangeCallback(),this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,a[b+3]=this._w,a},onChange:function(a){return this.onChangeCallback=a,this},onChangeCallback:function(){},clone:function(){return new c.Quaternion(this._x,this._y,this._z,this._w)}},c.Quaternion.slerp=function(a,b,c,d){return c.copy(a).slerp(b,d)},c.Vector2=function(a,b){this.x=a||0,this.y=b||0},c.Vector2.prototype={constructor:c.Vector2,set:function(a,b){return this.x=a,this.y=b,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw new Error("index is out of range: "+a)}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+a)}},copy:function(a){return this.x=a.x,this.y=a.y,this},add:function(a,b){return void 0!==b?(c.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b)):(this.x+=a.x,this.y+=a.y,this)},addScalar:function(a){return this.x+=a,this.y+=a,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this},sub:function(a,b){return void 0!==b?(c.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b)):(this.x-=a.x,this.y-=a.y,this)},subScalar:function(a){return this.x-=a,this.y-=a,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this},multiply:function(a){return this.x*=a.x,this.y*=a.y,this},multiplyScalar:function(a){return this.x*=a,this.y*=a,this},divide:function(a){return this.x/=a.x,this.y/=a.y,this},divideScalar:function(a){if(0!==a){var b=1/a;this.x*=b,this.y*=b}else this.x=0,this.y=0;return this},min:function(a){return this.x>a.x&&(this.x=a.x),this.y>a.y&&(this.y=a.y),this},max:function(a){return this.x<a.x&&(this.x=a.x),this.y<a.y&&(this.y=a.y),this},clamp:function(a,b){return this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x),this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y),this},clampScalar:function(){var a,b;return function(d,e){return void 0===a&&(a=new c.Vector2,b=new c.Vector2),a.set(d,d),b.set(e,e),this.clamp(a,b)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;return b*b+c*c},setLength:function(a){var b=this.length();return 0!==b&&a!==b&&this.multiplyScalar(a/b),this},lerp:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a),this},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a,b){return void 0===b&&(b=0),this.x=a[b],this.y=a[b+1],this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.x,a[b+1]=this.y,a},fromAttribute:function(a,b,c){return void 0===c&&(c=0),b=b*a.itemSize+c,this.x=a.array[b],this.y=a.array[b+1],this},clone:function(){return new c.Vector2(this.x,this.y)}},c.Vector3=function(a,b,c){this.x=a||0,this.y=b||0,this.z=c||0},c.Vector3.prototype={constructor:c.Vector3,set:function(a,b,c){return this.x=a,this.y=b,this.z=c,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setZ:function(a){return this.z=a,this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw new Error("index is out of range: "+a)}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+a)}},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this},add:function(a,b){return void 0!==b?(c.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b)):(this.x+=a.x,this.y+=a.y,this.z+=a.z,this)},addScalar:function(a){return this.x+=a,this.y+=a,this.z+=a,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this},sub:function(a,b){return void 0!==b?(c.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b)):(this.x-=a.x,this.y-=a.y,this.z-=a.z,this)},subScalar:function(a){return this.x-=a,this.y-=a,this.z-=a,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this},multiply:function(a,b){return void 0!==b?(c.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b)):(this.x*=a.x,this.y*=a.y,this.z*=a.z,this)},multiplyScalar:function(a){return this.x*=a,this.y*=a,this.z*=a,this},multiplyVectors:function(a,b){return this.x=a.x*b.x,this.y=a.y*b.y,this.z=a.z*b.z,this},applyEuler:function(){var a;return function(b){return b instanceof c.Euler==!1&&c.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order."),void 0===a&&(a=new c.Quaternion),this.applyQuaternion(a.setFromEuler(b)),this}}(),applyAxisAngle:function(){var a;return function(b,d){return void 0===a&&(a=new c.Quaternion),this.applyQuaternion(a.setFromAxisAngle(b,d)),this}}(),applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[3]*c+e[6]*d,this.y=e[1]*b+e[4]*c+e[7]*d,this.z=e[2]*b+e[5]*c+e[8]*d,this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[4]*c+e[8]*d+e[12],this.y=e[1]*b+e[5]*c+e[9]*d+e[13],this.z=e[2]*b+e[6]*c+e[10]*d+e[14],this},applyProjection:function(a){var b=this.x,c=this.y,d=this.z,e=a.elements,f=1/(e[3]*b+e[7]*c+e[11]*d+e[15]);return this.x=(e[0]*b+e[4]*c+e[8]*d+e[12])*f,this.y=(e[1]*b+e[5]*c+e[9]*d+e[13])*f,this.z=(e[2]*b+e[6]*c+e[10]*d+e[14])*f,this},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z,h=a.w,i=h*b+f*d-g*c,j=h*c+g*b-e*d,k=h*d+e*c-f*b,l=-e*b-f*c-g*d;return this.x=i*h+l*-e+j*-g-k*-f,this.y=j*h+l*-f+k*-e-i*-g,this.z=k*h+l*-g+i*-f-j*-e,this},project:function(){var a;return function(b){return void 0===a&&(a=new c.Matrix4),a.multiplyMatrices(b.projectionMatrix,a.getInverse(b.matrixWorld)),this.applyProjection(a)}}(),unproject:function(){var a;return function(b){return void 0===a&&(a=new c.Matrix4),a.multiplyMatrices(b.matrixWorld,a.getInverse(b.projectionMatrix)),this.applyProjection(a)}}(),transformDirection:function(a){var b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[4]*c+e[8]*d,this.y=e[1]*b+e[5]*c+e[9]*d,this.z=e[2]*b+e[6]*c+e[10]*d,this.normalize(),this},divide:function(a){return this.x/=a.x,this.y/=a.y,this.z/=a.z,this},divideScalar:function(a){if(0!==a){var b=1/a;this.x*=b,this.y*=b,this.z*=b}else this.x=0,this.y=0,this.z=0;return this},min:function(a){return this.x>a.x&&(this.x=a.x),this.y>a.y&&(this.y=a.y),this.z>a.z&&(this.z=a.z),this},max:function(a){return this.x<a.x&&(this.x=a.x),this.y<a.y&&(this.y=a.y),this.z<a.z&&(this.z=a.z),this},clamp:function(a,b){return this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x),this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y),this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z),this},clampScalar:function(){var a,b;return function(d,e){return void 0===a&&(a=new c.Vector3,b=new c.Vector3),a.set(d,d,d),b.set(e,e,e),this.clamp(a,b)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();return 0!==b&&a!==b&&this.multiplyScalar(a/b),this},lerp:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a),this},cross:function(a,b){if(void 0!==b)return c.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b);var d=this.x,e=this.y,f=this.z;return this.x=e*a.z-f*a.y,this.y=f*a.x-d*a.z,this.z=d*a.y-e*a.x,this},crossVectors:function(a,b){var c=a.x,d=a.y,e=a.z,f=b.x,g=b.y,h=b.z;return this.x=d*h-e*g,this.y=e*f-c*h,this.z=c*g-d*f,this},projectOnVector:function(){var a,b;return function(d){return void 0===a&&(a=new c.Vector3),a.copy(d).normalize(),b=this.dot(a),this.copy(a).multiplyScalar(b)}}(),projectOnPlane:function(){var a;return function(b){return void 0===a&&(a=new c.Vector3),a.copy(this).projectOnVector(b),this.sub(a)}}(),reflect:function(){var a;return function(b){return void 0===a&&(a=new c.Vector3),this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),angleTo:function(a){var b=this.dot(a)/(this.length()*a.length());return Math.acos(c.Math.clamp(b,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y,d=this.z-a.z;return b*b+c*c+d*d},setEulerFromRotationMatrix:function(a,b){c.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(a,b){c.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(a){return c.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){return c.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,b){return c.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(a,b)},setFromMatrixPosition:function(a){return this.x=a.elements[12],this.y=a.elements[13],this.z=a.elements[14],this},setFromMatrixScale:function(a){var b=this.set(a.elements[0],a.elements[1],a.elements[2]).length(),c=this.set(a.elements[4],a.elements[5],a.elements[6]).length(),d=this.set(a.elements[8],a.elements[9],a.elements[10]).length();return this.x=b,this.y=c,this.z=d,this},setFromMatrixColumn:function(a,b){var c=4*a,d=b.elements;return this.x=d[c],this.y=d[c+1],this.z=d[c+2],this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){return void 0===b&&(b=0),this.x=a[b],this.y=a[b+1],this.z=a[b+2],this},toArray:function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a},fromAttribute:function(a,b,c){return void 0===c&&(c=0),b=b*a.itemSize+c,this.x=a.array[b],this.y=a.array[b+1],this.z=a.array[b+2],this},clone:function(){return new c.Vector3(this.x,this.y,this.z)}},c.Box2=function(a,b){this.min=void 0!==a?a:new c.Vector2(1/0,1/0),this.max=void 0!==b?b:new c.Vector2(-1/0,-1/0)},c.Box2.prototype={constructor:c.Box2,set:function(a,b){return this.min.copy(a),this.max.copy(b),this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new c.Vector2;return function(b,c){var d=a.copy(c).multiplyScalar(.5);return this.min.copy(b).sub(d),this.max.copy(b).add(d),this}}(),copy:function(a){return this.min.copy(a.min),this.max.copy(a.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(a){return(a||new c.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(a){return(a||new c.Vector2).subVectors(this.max,this.min)},expandByPoint:function(a){return this.min.min(a),this.max.max(a),this},expandByVector:function(a){return this.min.sub(a),this.max.add(a),this},expandByScalar:function(a){return this.min.addScalar(-a),this.max.addScalar(a),this},containsPoint:function(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y)},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y},getParameter:function(a,b){return(b||new c.Vector2).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y)},clampPoint:function(a,b){return(b||new c.Vector2).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new c.Vector2;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){return this.min.max(a.min),this.max.min(a.max),this},union:function(a){return this.min.min(a.min),this.max.max(a.max),this},translate:function(a){return this.min.add(a),this.max.add(a),this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new c.Box2).copy(this)}},c.Box3=function(a,b){this.min=void 0!==a?a:new c.Vector3(1/0,1/0,1/0),this.max=void 0!==b?b:new c.Vector3(-1/0,-1/0,-1/0)},c.Box3.prototype={constructor:c.Box3,set:function(a,b){return this.min.copy(a),this.max.copy(b),this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new c.Vector3;return function(b,c){var d=a.copy(c).multiplyScalar(.5);return this.min.copy(b).sub(d),this.max.copy(b).add(d),this}}(),setFromObject:function(){var a=new c.Vector3;return function(b){var d=this;return b.updateMatrixWorld(!0),this.makeEmpty(),b.traverse(function(b){var e=b.geometry;if(void 0!==e)if(e instanceof c.Geometry)for(var f=e.vertices,g=0,h=f.length;g<h;g++)a.copy(f[g]),a.applyMatrix4(b.matrixWorld),d.expandByPoint(a);else if(e instanceof c.BufferGeometry&&void 0!==e.attributes.position)for(var i=e.attributes.position.array,g=0,h=i.length;g<h;g+=3)a.set(i[g],i[g+1],i[g+2]),a.applyMatrix4(b.matrixWorld),d.expandByPoint(a)}),this}}(),copy:function(a){return this.min.copy(a.min),this.max.copy(a.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(a){return(a||new c.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(a){return(a||new c.Vector3).subVectors(this.max,this.min)},expandByPoint:function(a){return this.min.min(a),this.max.max(a),this},expandByVector:function(a){return this.min.sub(a),this.max.add(a),this},expandByScalar:function(a){return this.min.addScalar(-a),this.max.addScalar(a),this},containsPoint:function(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z)},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z},getParameter:function(a,b){return(b||new c.Vector3).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z)},clampPoint:function(a,b){return(b||new c.Vector3).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new c.Vector3;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=new c.Vector3;return function(b){var d=b||new c.Sphere;return d.center=this.center(),d.radius=.5*this.size(a).length(),d}}(),intersect:function(a){return this.min.max(a.min),this.max.min(a.max),this},union:function(a){return this.min.min(a.min),this.max.max(a.max),this},applyMatrix4:function(){var a=[new c.Vector3,new c.Vector3,new c.Vector3,new c.Vector3,new c.Vector3,new c.Vector3,new c.Vector3,new c.Vector3];return function(b){return a[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(b),a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b),a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b),a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b),a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b),a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b),a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b),a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b),this.makeEmpty(),this.setFromPoints(a),this}}(),translate:function(a){return this.min.add(a),this.max.add(a),this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new c.Box3).copy(this)}},c.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0&&c.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")},c.Matrix3.prototype={constructor:c.Matrix3,set:function(a,b,c,d,e,f,g,h,i){var j=this.elements;return j[0]=a,j[3]=b,j[6]=c,j[1]=d,j[4]=e,j[7]=f,j[2]=g,j[5]=h,j[8]=i,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(a){var b=a.elements;return this.set(b[0],b[3],b[6],b[1],b[4],b[7],b[2],b[5],b[8]),this},multiplyVector3:function(a){return c.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),a.applyMatrix3(this)},multiplyVector3Array:function(a){return c.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(a)},applyToVector3Array:function(){var a=new c.Vector3;return function(b,c,d){void 0===c&&(c=0),void 0===d&&(d=b.length);for(var e=0,f=c;e<d;e+=3,f+=3)a.x=b[f],a.y=b[f+1],a.z=b[f+2],a.applyMatrix3(this),b[f]=a.x,b[f+1]=a.y,b[f+2]=a.z;return b}}(),multiplyScalar:function(a){var b=this.elements;return b[0]*=a,b[3]*=a,b[6]*=a,b[1]*=a,b[4]*=a,b[7]*=a,b[2]*=a,b[5]*=a,b[8]*=a,this},determinant:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8];return b*f*j-b*g*i-c*e*j+c*g*h+d*e*i-d*f*h},getInverse:function(a,b){var d=a.elements,e=this.elements;e[0]=d[10]*d[5]-d[6]*d[9],e[1]=-d[10]*d[1]+d[2]*d[9],e[2]=d[6]*d[1]-d[2]*d[5],e[3]=-d[10]*d[4]+d[6]*d[8],e[4]=d[10]*d[0]-d[2]*d[8],e[5]=-d[6]*d[0]+d[2]*d[4],e[6]=d[9]*d[4]-d[5]*d[8],e[7]=-d[9]*d[0]+d[1]*d[8],e[8]=d[5]*d[0]-d[1]*d[4];var f=d[0]*e[0]+d[1]*e[3]+d[2]*e[6];if(0===f){var g="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(b)throw new Error(g);return c.warn(g),this.identity(),this}return this.multiplyScalar(1/f),this},transpose:function(){var a,b=this.elements;return a=b[1],b[1]=b[3],b[3]=a,a=b[2],b[2]=b[6],b[6]=a,a=b[5],b[5]=b[7],b[7]=a,this},flattenToArrayOffset:function(a,b){var c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a},getNormalMatrix:function(a){return this.getInverse(a).transpose(),this},transposeIntoArray:function(a){var b=this.elements;return a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8],this},fromArray:function(a){return this.elements.set(a),this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8]]},clone:function(){return(new c.Matrix3).fromArray(this.elements)}},c.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&c.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},c.Matrix4.prototype={constructor:c.Matrix4,set:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this.elements;return q[0]=a,q[4]=b,q[8]=c,q[12]=d,q[1]=e,q[5]=f,q[9]=g,q[13]=h,q[2]=i,q[6]=j,q[10]=k,q[14]=l,q[3]=m,q[7]=n,q[11]=o,q[15]=p,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(a){return this.elements.set(a.elements),this},extractPosition:function(a){return c.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(a)},copyPosition:function(a){var b=this.elements,c=a.elements;return b[12]=c[12],b[13]=c[13],b[14]=c[14],this},extractBasis:function(a,b,c){var d=this.elements;return a.set(d[0],d[1],d[2]),b.set(d[4],d[5],d[6]),c.set(d[8],d[9],d[10]),this},makeBasis:function(a,b,c){return this.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1),this},extractRotation:function(){var a=new c.Vector3;return function(b){var c=this.elements,d=b.elements,e=1/a.set(d[0],d[1],d[2]).length(),f=1/a.set(d[4],d[5],d[6]).length(),g=1/a.set(d[8],d[9],d[10]).length();return c[0]=d[0]*e,c[1]=d[1]*e,c[2]=d[2]*e,c[4]=d[4]*f,c[5]=d[5]*f,c[6]=d[6]*f,c[8]=d[8]*g,c[9]=d[9]*g,c[10]=d[10]*g,this}}(),makeRotationFromEuler:function(a){a instanceof c.Euler==!1&&c.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var b=this.elements,d=a.x,e=a.y,f=a.z,g=Math.cos(d),h=Math.sin(d),i=Math.cos(e),j=Math.sin(e),k=Math.cos(f),l=Math.sin(f);if("XYZ"===a.order){var m=g*k,n=g*l,o=h*k,p=h*l;b[0]=i*k,b[4]=-i*l,b[8]=j,b[1]=n+o*j,b[5]=m-p*j,b[9]=-h*i,b[2]=p-m*j,b[6]=o+n*j,b[10]=g*i}else if("YXZ"===a.order){var q=i*k,r=i*l,s=j*k,t=j*l;b[0]=q+t*h,b[4]=s*h-r,b[8]=g*j,b[1]=g*l,b[5]=g*k,b[9]=-h,b[2]=r*h-s,b[6]=t+q*h,b[10]=g*i}else if("ZXY"===a.order){var q=i*k,r=i*l,s=j*k,t=j*l;b[0]=q-t*h,b[4]=-g*l,b[8]=s+r*h,b[1]=r+s*h,b[5]=g*k,b[9]=t-q*h,b[2]=-g*j,b[6]=h,b[10]=g*i}else if("ZYX"===a.order){var m=g*k,n=g*l,o=h*k,p=h*l;b[0]=i*k,b[4]=o*j-n,b[8]=m*j+p,b[1]=i*l,b[5]=p*j+m,b[9]=n*j-o,b[2]=-j,b[6]=h*i,b[10]=g*i}else if("YZX"===a.order){var u=g*i,v=g*j,w=h*i,x=h*j;b[0]=i*k,b[4]=x-u*l,b[8]=w*l+v,b[1]=l,b[5]=g*k,b[9]=-h*k,b[2]=-j*k,b[6]=v*l+w,b[10]=u-x*l}else if("XZY"===a.order){var u=g*i,v=g*j,w=h*i,x=h*j;b[0]=i*k,b[4]=-l,b[8]=j*k,b[1]=u*l+x,b[5]=g*k,b[9]=v*l-w,b[2]=w*l-v,b[6]=h*k,b[10]=x*l+u}return b[3]=0,b[7]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this},setRotationFromQuaternion:function(a){return c.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(a)},makeRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,g=c+c,h=d+d,i=e+e,j=c*g,k=c*h,l=c*i,m=d*h,n=d*i,o=e*i,p=f*g,q=f*h,r=f*i;return b[0]=1-(m+o),b[4]=k-r,b[8]=l+q,b[1]=k+r,b[5]=1-(j+o),b[9]=n-p,b[2]=l-q,b[6]=n+p,b[10]=1-(j+m),b[3]=0,b[7]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this},lookAt:function(){
var a=new c.Vector3,b=new c.Vector3,d=new c.Vector3;return function(c,e,f){var g=this.elements;return d.subVectors(c,e).normalize(),0===d.length()&&(d.z=1),a.crossVectors(f,d).normalize(),0===a.length()&&(d.x+=1e-4,a.crossVectors(f,d).normalize()),b.crossVectors(d,a),g[0]=a.x,g[4]=b.x,g[8]=d.x,g[1]=a.y,g[5]=b.y,g[9]=d.y,g[2]=a.z,g[6]=b.z,g[10]=d.z,this}}(),multiply:function(a,b){return void 0!==b?(c.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[4],h=c[8],i=c[12],j=c[1],k=c[5],l=c[9],m=c[13],n=c[2],o=c[6],p=c[10],q=c[14],r=c[3],s=c[7],t=c[11],u=c[15],v=d[0],w=d[4],x=d[8],y=d[12],z=d[1],A=d[5],B=d[9],C=d[13],D=d[2],E=d[6],F=d[10],G=d[14],H=d[3],I=d[7],J=d[11],K=d[15];return e[0]=f*v+g*z+h*D+i*H,e[4]=f*w+g*A+h*E+i*I,e[8]=f*x+g*B+h*F+i*J,e[12]=f*y+g*C+h*G+i*K,e[1]=j*v+k*z+l*D+m*H,e[5]=j*w+k*A+l*E+m*I,e[9]=j*x+k*B+l*F+m*J,e[13]=j*y+k*C+l*G+m*K,e[2]=n*v+o*z+p*D+q*H,e[6]=n*w+o*A+p*E+q*I,e[10]=n*x+o*B+p*F+q*J,e[14]=n*y+o*C+p*G+q*K,e[3]=r*v+s*z+t*D+u*H,e[7]=r*w+s*A+t*E+u*I,e[11]=r*x+s*B+t*F+u*J,e[15]=r*y+s*C+t*G+u*K,this},multiplyToArray:function(a,b,c){var d=this.elements;return this.multiplyMatrices(a,b),c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c[6]=d[6],c[7]=d[7],c[8]=d[8],c[9]=d[9],c[10]=d[10],c[11]=d[11],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15],this},multiplyScalar:function(a){var b=this.elements;return b[0]*=a,b[4]*=a,b[8]*=a,b[12]*=a,b[1]*=a,b[5]*=a,b[9]*=a,b[13]*=a,b[2]*=a,b[6]*=a,b[10]*=a,b[14]*=a,b[3]*=a,b[7]*=a,b[11]*=a,b[15]*=a,this},multiplyVector3:function(a){return c.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),a.applyProjection(this)},multiplyVector4:function(a){return c.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},multiplyVector3Array:function(a){return c.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(a)},applyToVector3Array:function(){var a=new c.Vector3;return function(b,c,d){void 0===c&&(c=0),void 0===d&&(d=b.length);for(var e=0,f=c;e<d;e+=3,f+=3)a.x=b[f],a.y=b[f+1],a.z=b[f+2],a.applyMatrix4(this),b[f]=a.x,b[f+1]=a.y,b[f+2]=a.z;return b}}(),rotateAxis:function(a){c.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),a.transformDirection(this)},crossVector:function(a){return c.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],i=a[13],j=a[2],k=a[6],l=a[10],m=a[14];return a[3]*(+e*h*k-d*i*k-e*g*l+c*i*l+d*g*m-c*h*m)+a[7]*(+b*h*m-b*i*l+e*f*l-d*f*m+d*i*j-e*h*j)+a[11]*(+b*i*k-b*g*m-e*f*k+c*f*m+e*g*j-c*i*j)+a[15]*(-d*g*j-b*h*k+b*g*l+d*f*k-c*f*l+c*h*j)},transpose:function(){var a,b=this.elements;return a=b[1],b[1]=b[4],b[4]=a,a=b[2],b[2]=b[8],b[8]=a,a=b[6],b[6]=b[9],b[9]=a,a=b[3],b[3]=b[12],b[12]=a,a=b[7],b[7]=b[13],b[13]=a,a=b[11],b[11]=b[14],b[14]=a,this},flattenToArrayOffset:function(a,b){var c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a[b+9]=c[9],a[b+10]=c[10],a[b+11]=c[11],a[b+12]=c[12],a[b+13]=c[13],a[b+14]=c[14],a[b+15]=c[15],a},getPosition:function(){var a=new c.Vector3;return function(){c.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var b=this.elements;return a.set(b[12],b[13],b[14])}}(),setPosition:function(a){var b=this.elements;return b[12]=a.x,b[13]=a.y,b[14]=a.z,this},getInverse:function(a,b){var d=this.elements,e=a.elements,f=e[0],g=e[4],h=e[8],i=e[12],j=e[1],k=e[5],l=e[9],m=e[13],n=e[2],o=e[6],p=e[10],q=e[14],r=e[3],s=e[7],t=e[11],u=e[15];d[0]=l*q*s-m*p*s+m*o*t-k*q*t-l*o*u+k*p*u,d[4]=i*p*s-h*q*s-i*o*t+g*q*t+h*o*u-g*p*u,d[8]=h*m*s-i*l*s+i*k*t-g*m*t-h*k*u+g*l*u,d[12]=i*l*o-h*m*o-i*k*p+g*m*p+h*k*q-g*l*q,d[1]=m*p*r-l*q*r-m*n*t+j*q*t+l*n*u-j*p*u,d[5]=h*q*r-i*p*r+i*n*t-f*q*t-h*n*u+f*p*u,d[9]=i*l*r-h*m*r-i*j*t+f*m*t+h*j*u-f*l*u,d[13]=h*m*n-i*l*n+i*j*p-f*m*p-h*j*q+f*l*q,d[2]=k*q*r-m*o*r+m*n*s-j*q*s-k*n*u+j*o*u,d[6]=i*o*r-g*q*r-i*n*s+f*q*s+g*n*u-f*o*u,d[10]=g*m*r-i*k*r+i*j*s-f*m*s-g*j*u+f*k*u,d[14]=i*k*n-g*m*n-i*j*o+f*m*o+g*j*q-f*k*q,d[3]=l*o*r-k*p*r-l*n*s+j*p*s+k*n*t-j*o*t,d[7]=g*p*r-h*o*r+h*n*s-f*p*s-g*n*t+f*o*t,d[11]=h*k*r-g*l*r-h*j*s+f*l*s+g*j*t-f*k*t,d[15]=g*l*n-h*k*n+h*j*o-f*l*o-g*j*p+f*k*p;var v=f*d[0]+j*d[4]+n*d[8]+r*d[12];if(0==v){var w="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(b)throw new Error(w);return c.warn(w),this.identity(),this}return this.multiplyScalar(1/v),this},translate:function(a){c.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(a){c.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(a){c.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(a){c.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(a,b){c.error("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z;return b[0]*=c,b[4]*=d,b[8]*=e,b[1]*=c,b[5]*=d,b[9]*=e,b[2]*=c,b[6]*=d,b[10]*=e,b[3]*=c,b[7]*=d,b[11]*=e,this},getMaxScaleOnAxis:function(){var a=this.elements,b=a[0]*a[0]+a[1]*a[1]+a[2]*a[2],c=a[4]*a[4]+a[5]*a[5]+a[6]*a[6],d=a[8]*a[8]+a[9]*a[9]+a[10]*a[10];return Math.sqrt(Math.max(b,Math.max(c,d)))},makeTranslation:function(a,b,c){return this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1),this},makeRotationX:function(a){var b=Math.cos(a),c=Math.sin(a);return this.set(1,0,0,0,0,b,-c,0,0,c,b,0,0,0,0,1),this},makeRotationY:function(a){var b=Math.cos(a),c=Math.sin(a);return this.set(b,0,c,0,0,1,0,0,-c,0,b,0,0,0,0,1),this},makeRotationZ:function(a){var b=Math.cos(a),c=Math.sin(a);return this.set(b,-c,0,0,c,b,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,i=e*f,j=e*g;return this.set(i*f+c,i*g-d*h,i*h+d*g,0,i*g+d*h,j*g+c,j*h-d*f,0,i*h-d*g,j*h+d*f,e*h*h+c,0,0,0,0,1),this},makeScale:function(a,b,c){return this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1),this},compose:function(a,b,c){return this.makeRotationFromQuaternion(b),this.scale(c),this.setPosition(a),this},decompose:function(){var a=new c.Vector3,b=new c.Matrix4;return function(c,d,e){var f=this.elements,g=a.set(f[0],f[1],f[2]).length(),h=a.set(f[4],f[5],f[6]).length(),i=a.set(f[8],f[9],f[10]).length();this.determinant()<0&&(g=-g),c.x=f[12],c.y=f[13],c.z=f[14],b.elements.set(this.elements);var j=1/g,k=1/h,l=1/i;return b.elements[0]*=j,b.elements[1]*=j,b.elements[2]*=j,b.elements[4]*=k,b.elements[5]*=k,b.elements[6]*=k,b.elements[8]*=l,b.elements[9]*=l,b.elements[10]*=l,d.setFromRotationMatrix(b),e.x=g,e.y=h,e.z=i,this}}(),makeFrustum:function(a,b,c,d,e,f){var g=this.elements,h=2*e/(b-a),i=2*e/(d-c),j=(b+a)/(b-a),k=(d+c)/(d-c),l=-(f+e)/(f-e),m=-2*f*e/(f-e);return g[0]=h,g[4]=0,g[8]=j,g[12]=0,g[1]=0,g[5]=i,g[9]=k,g[13]=0,g[2]=0,g[6]=0,g[10]=l,g[14]=m,g[3]=0,g[7]=0,g[11]=-1,g[15]=0,this},makePerspective:function(a,b,d,e){var f=d*Math.tan(c.Math.degToRad(.5*a)),g=-f,h=g*b,i=f*b;return this.makeFrustum(h,i,g,f,d,e)},makeOrthographic:function(a,b,c,d,e,f){var g=this.elements,h=b-a,i=c-d,j=f-e,k=(b+a)/h,l=(c+d)/i,m=(f+e)/j;return g[0]=2/h,g[4]=0,g[8]=0,g[12]=-k,g[1]=0,g[5]=2/i,g[9]=0,g[13]=-l,g[2]=0,g[6]=0,g[10]=-2/j,g[14]=-m,g[3]=0,g[7]=0,g[11]=0,g[15]=1,this},fromArray:function(a){return this.elements.set(a),this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]},clone:function(){return(new c.Matrix4).fromArray(this.elements)}},c.Sphere=function(a,b){this.center=void 0!==a?a:new c.Vector3,this.radius=void 0!==b?b:0},c.Sphere.prototype={constructor:c.Sphere,set:function(a,b){return this.center.copy(a),this.radius=b,this},setFromPoints:function(){var a=new c.Box3;return function(b,c){var d=this.center;void 0!==c?d.copy(c):a.setFromPoints(b).center(d);for(var e=0,f=0,g=b.length;f<g;f++)e=Math.max(e,d.distanceToSquared(b[f]));return this.radius=Math.sqrt(e),this}}(),copy:function(a){return this.center.copy(a.center),this.radius=a.radius,this},empty:function(){return this.radius<=0},containsPoint:function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},clampPoint:function(a,b){var d=this.center.distanceToSquared(a),e=b||new c.Vector3;return e.copy(a),d>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(a){var b=a||new c.Box3;return b.set(this.center,this.center),b.expandByScalar(this.radius),b},applyMatrix4:function(a){return this.center.applyMatrix4(a),this.radius=this.radius*a.getMaxScaleOnAxis(),this},translate:function(a){return this.center.add(a),this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius},clone:function(){return(new c.Sphere).copy(this)}},c.Frustum=function(a,b,d,e,f,g){this.planes=[void 0!==a?a:new c.Plane,void 0!==b?b:new c.Plane,void 0!==d?d:new c.Plane,void 0!==e?e:new c.Plane,void 0!==f?f:new c.Plane,void 0!==g?g:new c.Plane]},c.Frustum.prototype={constructor:c.Frustum,set:function(a,b,c,d,e,f){var g=this.planes;return g[0].copy(a),g[1].copy(b),g[2].copy(c),g[3].copy(d),g[4].copy(e),g[5].copy(f),this},copy:function(a){for(var b=this.planes,c=0;c<6;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements,d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],i=c[5],j=c[6],k=c[7],l=c[8],m=c[9],n=c[10],o=c[11],p=c[12],q=c[13],r=c[14],s=c[15];return b[0].setComponents(g-d,k-h,o-l,s-p).normalize(),b[1].setComponents(g+d,k+h,o+l,s+p).normalize(),b[2].setComponents(g+e,k+i,o+m,s+q).normalize(),b[3].setComponents(g-e,k-i,o-m,s-q).normalize(),b[4].setComponents(g-f,k-j,o-n,s-r).normalize(),b[5].setComponents(g+f,k+j,o+n,s+r).normalize(),this},intersectsObject:function(){var a=new c.Sphere;return function(b){var c=b.geometry;return null===c.boundingSphere&&c.computeBoundingSphere(),a.copy(c.boundingSphere),a.applyMatrix4(b.matrixWorld),this.intersectsSphere(a)}}(),intersectsSphere:function(a){for(var b=this.planes,c=a.center,d=-a.radius,e=0;e<6;e++){if(b[e].distanceToPoint(c)<d)return!1}return!0},intersectsBox:function(){var a=new c.Vector3,b=new c.Vector3;return function(c){for(var d=this.planes,e=0;e<6;e++){var f=d[e];a.x=f.normal.x>0?c.min.x:c.max.x,b.x=f.normal.x>0?c.max.x:c.min.x,a.y=f.normal.y>0?c.min.y:c.max.y,b.y=f.normal.y>0?c.max.y:c.min.y,a.z=f.normal.z>0?c.min.z:c.max.z,b.z=f.normal.z>0?c.max.z:c.min.z;var g=f.distanceToPoint(a),h=f.distanceToPoint(b);if(g<0&&h<0)return!1}return!0}}(),containsPoint:function(a){for(var b=this.planes,c=0;c<6;c++)if(b[c].distanceToPoint(a)<0)return!1;return!0},clone:function(){return(new c.Frustum).copy(this)}},c.Plane=function(a,b){this.normal=void 0!==a?a:new c.Vector3(1,0,0),this.constant=void 0!==b?b:0},c.Plane.prototype={constructor:c.Plane,set:function(a,b){return this.normal.copy(a),this.constant=b,this},setComponents:function(a,b,c,d){return this.normal.set(a,b,c),this.constant=d,this},setFromNormalAndCoplanarPoint:function(a,b){return this.normal.copy(a),this.constant=-b.dot(this.normal),this},setFromCoplanarPoints:function(){var a=new c.Vector3,b=new c.Vector3;return function(c,d,e){var f=a.subVectors(e,d).cross(b.subVectors(c,d)).normalize();return this.setFromNormalAndCoplanarPoint(f,c),this}}(),copy:function(a){return this.normal.copy(a.normal),this.constant=a.constant,this},normalize:function(){var a=1/this.normal.length();return this.normal.multiplyScalar(a),this.constant*=a,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return this.orthoPoint(a,b).sub(a).negate()},orthoPoint:function(a,b){var d=this.distanceToPoint(a);return(b||new c.Vector3).copy(this.normal).multiplyScalar(d)},isIntersectionLine:function(a){var b=this.distanceToPoint(a.start),c=this.distanceToPoint(a.end);return b<0&&c>0||c<0&&b>0},intersectLine:function(){var a=new c.Vector3;return function(b,d){var e=d||new c.Vector3,f=b.delta(a),g=this.normal.dot(f);if(0!=g){var h=-(b.start.dot(this.normal)+this.constant)/g;if(!(h<0||h>1))return e.copy(f).multiplyScalar(h).add(b.start)}else if(0==this.distanceToPoint(b.start))return e.copy(b.start)}}(),coplanarPoint:function(a){return(a||new c.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new c.Vector3,b=new c.Vector3,d=new c.Matrix3;return function(c,e){var f=e||d.getNormalMatrix(c),g=a.copy(this.normal).applyMatrix3(f),h=this.coplanarPoint(b);return h.applyMatrix4(c),this.setFromNormalAndCoplanarPoint(g,h),this}}(),translate:function(a){return this.constant=this.constant-a.dot(this.normal),this},equals:function(a){return a.normal.equals(this.normal)&&a.constant==this.constant},clone:function(){return(new c.Plane).copy(this)}},c.Math={generateUUID:function(){var a,b="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),c=new Array(36),d=0;return function(){for(var e=0;e<36;e++)8==e||13==e||18==e||23==e?c[e]="-":14==e?c[e]="4":(d<=2&&(d=33554432+16777216*Math.random()|0),a=15&d,d>>=4,c[e]=b[19==e?3&a|8:a]);return c.join("")}}(),clamp:function(a,b,c){return a<b?b:a>c?c:a},clampBottom:function(a,b){return a<b?b:a},mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},smoothstep:function(a,b,c){return a<=b?0:a>=c?1:(a=(a-b)/(c-b))*a*(3-2*a)},smootherstep:function(a,b,c){return a<=b?0:a>=c?1:(a=(a-b)/(c-b))*a*a*(a*(6*a-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(a,b){return Math.floor(this.randFloat(a,b))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(.5-Math.random())},degToRad:function(){var a=Math.PI/180;return function(b){return b*a}}(),radToDeg:function(){var a=180/Math.PI;return function(b){return b*a}}(),isPowerOfTwo:function(a){return 0==(a&a-1)&&0!==a},nextPowerOfTwo:function(a){return a--,a|=a>>1,a|=a>>2,a|=a>>4,a|=a>>8,a|=a>>16,++a}}}).call(b,c(67)(a))},function(a,b){a.exports=function(a){return a.webpackPolyfill||(a.deprecate=function(){},a.paths=[],a.children=[],a.webpackPolyfill=1),a}},function(a,b){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var c=new Float32Array(1),d=new Uint32Array(c.buffer),e=new Uint16Array(1),f=new Uint16Array(1),g=b.FloatToHalf=function(a){c[0]=a;var b=d[0],g=0;if(0==(2147483647&b))f[g++]=b>>16;else{var h=2147483648&b,i=2139095040&b,j=8388607&b;if(0===i)f[g++]=h>>16;else if(2139095040==i)f[g++]=0===j?h>>16|31744:65024;else{var k,l,m=h>>16,n=(0|i>>23)-127+15;n>=31?f[g++]=h>>16|31744:n<=0?(14-n>24?k=0:(j|=8388608,k=j>>14-n,e[0]=k,k=e[0],j>>13-n&1&&(k+=1)),f[g++]=m|k):(l=n<<10,e[0]=l,l=e[0],k=j>>13,e[0]=k,k=e[0],f[g++]=4096&j?1+(m|l|k):m|l|k)}}return f[0]},h=b.HalfToFloat=function(a){var b,e=65535&a;if(0==(32767&e))b=e<<16;else{var f=32768&e,g=31744&e,h=1023&e;if(0===g){var i=-1;do{i++,h<<=1}while(0==(1024&h));var j=f<<16,k=(g<<16>>26)-15+127-i,l=k<<23,m=(1023&h)<<13;b=j|l|m}else 31744==g?b=0===h?f<<16|2139095040:4290772992:(j=f<<16,k=(g<<16>>26)-15+127,l=k<<23,m=h<<13,b=j|l|m)}return d[0]=b,c[0]},i=b.HALF_INT_MAX=59390,j=b.IntToHalf=function(a){if(a>i-1||a<0)return console.log("out of range"),g(NaN);if(0===a)return 0;var b=!1;a>i/2-1&&(b=!0,a-=i/2-1);var c=0|Math.abs(a/1024),d=Math.pow(2,c-13),e=d+(a-1024*c)*d/1024;return b&&(e=-e),g(e)},k=b.HalfToInt=function(a){if(0===a)return 0;var b=h(a),c=!1;b<0&&(c=!0,b=-b);var d=0|Math.floor(Math.log(b)/Math.log(2)),e=Math.pow(2,d),f=(b-e)/e*1024+1024*(d+13);return c&&(f+=i/2-1),f};b.HalfTest=function(){for(var a=[-1/255,-.17,-75,-1789,-.005],b=0;b<a.length;b++)console.log("input",a[b],"encoded",g(a[b]),"decoded",h(g(a[b])));for(var b=0;b<i;b++){var c=k(j(b));c!==b&&console.log("Roundtrip failed for",b,c)}}},function(a,b,c){"use strict";function d(a){for(var b=new f.LmvMatrix4,c=new g.LmvVector3,d=[],e=0;e<a.tasks.length;e++){var i=a.tasks[e],j=h.GeomMergeTask.prototype.run.call(i,b,c);d.push(j)}for(var k=[],e=0;e<d.length;e++)k.push(d[e].vb.buffer),k.push(d[e].vertexIds.buffer);a.worker.postMessage(d,k)}function e(a){a.register("MERGE_GEOMETRY",{doOperation:d})}Object.defineProperty(b,"__esModule",{value:!0}),b.doGeomMerge=d,b.register=e;var f=c(30),g=c(28),h=c(70)},function(a,b){"use strict";function c(){return j++}function d(){this.vb=null,this.vbstride=0,this.posOffset=0,this.normalOffset=0,this.matrices=null,this.ranges=null,this.dbIds=null,this.id=c()}function e(a){a.x=.5*(1+Math.atan2(a.y,a.x)/Math.PI),a.y=.5*(1+a.z),a.z=0}function f(a){var b=2*a.x-1,c=2*a.y-1,d=Math.sin(b*Math.PI),e=Math.cos(b*Math.PI),f=Math.sqrt(1-c*c),g=c;a.x=e*f,a.y=d*f,a.z=g}function g(a,b,c){b[c++]=255&a,b[c++]=a>>8&255,b[c++]=a>>16&255,b[c]=0}function h(a,b){return b.copy(a),b[12]=0,b[13]=0,b[14]=0,b.getInverse(b).transpose()}function i(a,b,c){for(var d=16*a,e=0;e<16;e++)c.elements[e]=b[e+d]}Object.defineProperty(b,"__esModule",{value:!0}),b.GeomMergeTask=d,b.writeIdToBuffer=g;var j=1,k=function(a,b,c,d,g,i,j){for(var k=a.posOffset,l=d;l<g;l++){var m=l*a.vbstride+k;j.set(a.vb[m],a.vb[m+1],a.vb[m+2]),j.applyMatrix4(c),a.vb[m]=j.x,a.vb[m+1]=j.y,a.vb[m+2]=j.z}if(-1!==a.normalOffset){var n=2*a.vbstride,o=2*a.normalOffset,p=h(c,i);for(l=d;l<g;l++){var q=l*n+o;j.set(b[q],b[q+1],0),j.divideScalar(65535),f(j),j.applyMatrix4(p),j.normalize(),e(j),j.multiplyScalar(65535),b[q]=j.x,b[q+1]=j.y}}};d.prototype.run=function(a,b){for(var c=this.vb,d=c.length/this.vbstride,e=a.clone(),f=new Uint8Array(3*d),h=-1!==this.normalOffset,j=h?new Uint16Array(c.buffer,c.byteOffset,2*c.length):null,l=this.ranges,m=this.matrices,n=l.length-1,o=0;o<n;o++){var p=l[o],q=l[o+1];i(o,m,a),k(this,j,a,p,q,e,b);for(var r=3*p,s=q-p,t=this.dbIds[o],u=0;u<s;u++)g(t,f,r),r+=3}return{taskId:this.id,vb:this.vb,vertexIds:f}}},function(a,b,c){"use strict";function d(){function a(a,b){var c=a*m,d=e.boxes;b.min.x=d[c],b.min.y=d[c+1],b.min.z=d[c+2],b.max.x=d[c+3],b.max.y=d[c+4],b.max.z=d[c+5]}function b(){var b,c;v=g;var d=new Int32Array(g),h=new Int32Array(f);for(b=0;b<g;b++)d[b]=b;p=0;var i=r/s.areaConv;for(b=0;b<g;b++)k[b]=0;var l;for(b=0;b<f;b++){o[b]=0,a(b,q);var m=s.intersectsBox(q);m!==j.FrustumIntersector.OUTSIDE&&(l=s.projectedBoxArea(q,m===j.FrustumIntersector.CONTAINS))>i&&(k[e.packIds[b]]+=l,h[p++]=b)}for(Array.prototype.sort.call(d,function(a,b){return k[b]-k[a]}),b=0;b<g&&k[d[b]]>0;b++)n[d[b]]=b;for(v=b,c=h.subarray(0,p),b=0;b<p;b++)o[c[b]]=n[e.packIds[c[b]]];return Array.prototype.sort.call(c,function(a,b){return o[a]-o[b]}),{fragOrder:h,packOrder:d,pfVisible:v}}function c(){return b()}function d(a,b){var c;for(c=0;c<6;c++){var d=a.planes[c],e=b.planes[c];if(d.constant!==e.constant)return!1;if(!d.normal.equals(e.normal))return!1}return!0}var e,f,g,h,i,k,n,o,p,q=new l.Box3,r=1,s=new j.FrustumIntersector,t=new l.Frustum,u=!0,v=0;this.setFragments=function(a){e=a,f=a.packIds.length,h=1/0,i=-1/0;for(var b=0;b<f;b++){var c=e.packIds[b];h=Math.min(h,c),i=Math.max(i,c)}if((g=i+1)<0)return{error:"Empty fragment list"};k=new Float32Array(g),n=new Int32Array(g),o=new Float32Array(f),p=f,u=!0},this.calculateStep=function(){return u?(u=!1,c()):{}},this.setFrustum=function(a,b){return s.reset(a),u=u||!d(t,s.frustum),t.copy(s.frustum),"number"==typeof b&&r!=b&&(r=b,u=!0),!0}}function e(a,b){a.lmv_timer=0;var c=a.lmv_calculator.calculateStep();if(c){var d=c.fragOrder?c.packOrder?[c.fragOrder.buffer,c.packOrder.buffer]:[c.fragOrder.buffer]:c.packOrder?[c.packOrder.buffer]:void 0;c.id=b,a.postMessage(c,d)}else a.lmv_timer=setTimeout(e,1,a,b)}function f(a,b){b&&a.postMessage(b)}function g(a){a.lmv_timer&&(clearTimeout(a.lmv_timer),a.lmv_timer=0)}function h(a){var b=a.worker,c=b.lmv_calculator;c||(b.lmv_calculator=c=new d),g(b),a.fragments&&f(b,c.setFragments(a.fragments)),a.camera&&(c.setFrustum(a.camera,a.pixelCullingThreshold),b.lmv_timer=setTimeout(e,1,b,a.id))}function i(a){a.register("CALCULATE_LOAD_ORDER",{doOperation:h})}Object.defineProperty(b,"__esModule",{value:!0}),b.register=i;var j=c(72),k=c(66),l=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(k),m=6},function(a,b,c){"use strict";function d(){this.frustum=new h.Frustum,this.viewProj=new h.Matrix4,this.viewDir=[0,0,1],this.ar=1,this.viewport=new h.Vector3(1,1,1),this.areaConv=1,this.areaCullThreshold=1,this.eye=new h.Vector3,this.perspective=!1}function e(a,b,c){return c.x=1&b?a.max.x:a.min.x,c.y=2&b?a.max.y:a.min.y,c.z=4&b?a.max.z:a.min.z,c}function f(a,b){return a.x*b.x+a.y*b.y+a.z*b.z+b.w>1e-6}Object.defineProperty(b,"__esModule",{value:!0}),b.CONTAINMENT_UNKNOWN=b.CONTAINS=b.INTERSECTS=b.OUTSIDE=void 0,b.FrustumIntersector=d;var g=c(66),h=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(g),i=[[1,5,4,7,3,2,6],[0,3,2,1,5,4,6],[0,3,2,6,5,4,6],[0,4,7,3,2,1,6],[0,3,2,1,-1,-1,4],[0,3,2,6,5,1,6],[0,4,7,6,2,1,6],[0,3,7,6,2,1,6],[0,3,7,6,5,1,6],[0,1,5,4,7,3,6],[0,1,5,4,-1,-1,4],[0,1,2,6,5,4,6],[0,4,7,3,-1,-1,4],[-1,-1,-1,-1,-1,-1,0],[1,2,6,5,-1,-1,4],[0,4,7,6,2,3,6],[2,3,7,6,-1,-1,4],[1,2,3,7,6,5,6],[0,1,5,6,7,3,6],[0,1,5,6,7,4,6],[0,1,2,6,7,4,6],[0,4,5,6,7,3,6],[4,5,6,7,-1,-1,4],[1,2,6,7,4,5,6],[0,4,5,6,2,3,6],[2,3,7,4,5,6,6],[1,2,3,7,4,5,6]],j=b.OUTSIDE=0,k=b.INTERSECTS=1,l=b.CONTAINS=2,m=b.CONTAINMENT_UNKNOWN=-1;d.OUTSIDE=j,d.INTERSECTS=k,d.CONTAINS=l,d.CONTAINMENT_UNKNOWN=m,d.prototype.reset=function(a,b){this.viewProj.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),this.perspective=a.isPerspective,this.frustum.setFromMatrix(this.viewProj);var c=a.matrixWorldInverse.elements;this.ar=a.aspect,this.viewDir[0]=-c[2],this.viewDir[1]=-c[6],this.viewDir[2]=-c[10],this.eye.x=a.position.x,this.eye.y=a.position.y,this.eye.z=a.position.z,this.areaConv=a.clientWidth*a.clientHeight/4,this.cutPlanes=b},d.prototype.projectedArea=function(){function a(){c||(c=[new h.Vector3,new h.Vector3,new h.Vector3,new h.Vector3,new h.Vector3,new h.Vector3,new h.Vector3,new h.Vector3],d=new h.Box2)}function b(a,b){var c=a.x,d=a.y,e=a.z,f=b.elements,g=f[3]*c+f[7]*d+f[11]*e+f[15];g<0&&(g=-g);var h=1/g;a.x=(f[0]*c+f[4]*d+f[8]*e+f[12])*h,a.y=(f[1]*c+f[5]*d+f[9]*e+f[13])*h}var c,d;return function(e){if(e.empty())return 0;a();var f=this.viewProj;c[0].set(e.min.x,e.min.y,e.min.z),c[1].set(e.min.x,e.min.y,e.max.z),c[2].set(e.min.x,e.max.y,e.min.z),c[3].set(e.min.x,e.max.y,e.max.z),c[4].set(e.max.x,e.min.y,e.min.z),c[5].set(e.max.x,e.min.y,e.max.z),c[6].set(e.max.x,e.max.y,e.min.z),c[7].set(e.max.x,e.max.y,e.max.z);for(var g=0;g<8;g++)b(c[g],f);return d.makeEmpty(),d.setFromPoints(c),d.min.x<-1&&(d.min.x=-1),d.min.x>1&&(d.min.x=1),d.min.y<-1&&(d.min.y=-1),d.min.y>1&&(d.min.y=1),d.max.x>1&&(d.max.x=1),d.max.x<-1&&(d.max.x=-1),d.max.y>1&&(d.max.y=1),d.max.y<-1&&(d.max.y=-1),(d.max.x-d.min.x)*(d.max.y-d.min.y)}}(),d.prototype.projectedBoxArea=function(){function a(){if(!d){d=[],e=[];for(var a=0;a<10;a++)d.push(new h.Vector3),e.push(new h.Vector3)}}function b(a,b){var c=a.x,d=a.y,e=a.z,f=b.elements,g=f[3]*c+f[7]*d+f[11]*e+f[15];g<0&&(g=-g);var h=1/g;a.x=(f[0]*c+f[4]*d+f[8]*e+f[12])*h,a.y=(f[1]*c+f[5]*d+f[9]*e+f[13])*h}function c(a,b){var c,d,g,h,i,j,k,l,m=a,n=e,o=function(a){switch(k){case 0:return a.x>=-1;case 1:return a.x<=1;case 2:return a.y>=-1;case 3:return a.y<=1}},p=function(a){n[l].x=a.x,n[l++].y=a.y},q=function(){var a,b;switch(k){case 0:a=-1,b=d.y+(g.y-d.y)*(a-d.x)/(g.x-d.x);break;case 1:a=1,b=d.y+(g.y-d.y)*(a-d.x)/(g.x-d.x);break;case 2:b=-1,a=d.x+(g.x-d.x)*(b-d.y)/(g.y-d.y);break;case 3:b=1,a=d.x+(g.x-d.x)*(b-d.y)/(g.y-d.y)}n[l].x=a,n[l++].y=b};for(k=0;k<4&&b>2;k++){for(l=0,d=m[b-1],h=o(d),j=0;j<b;j++)g=m[j],i=o(g),h?i?p(g):q():i&&(q(),p(g)),d=g,h=i;b=l,c=m,m=n,n=c}return f=b,m}var d,e,f;return function(e,g){if(e.empty())return 0;a();var h,j=this.viewProj;if(this.perspective?(h=this.eye.x>=e.min.x?this.eye.x>e.max.x?2:1:0,this.eye.y>=e.min.y&&(h+=this.eye.y>e.max.y?6:3),this.eye.z>=e.min.z&&(h+=this.eye.z>e.max.z?18:9)):(h=this.viewDir[0]<=0?this.viewDir[0]<0?2:1:0,this.viewDir[1]<=0&&(h+=this.viewDir[1]<0?6:3),this.viewDir[2]<=0&&(h+=this.viewDir[2]<0?18:9)),13===h)return 4;var k,l=i[h][6];for(k=0;k<l;k++){var m=i[h][k];d[k].set((m+1)%4<2?e.min.x:e.max.x,m%4<2?e.min.y:e.max.y,m<4?e.min.z:e.max.z),b(d[k],j)}var n=0;if(g)for(n=(d[l-1].x-d[0].x)*(d[l-1].y+d[0].y),k=0;k<l-1;k++)n+=(d[k].x-d[k+1].x)*(d[k].y+d[k+1].y);else{var o=c(d,l);if(f>=3)for(n=(o[f-1].x-o[0].x)*(o[f-1].y+o[0].y),k=0;k<f-1;k++)n+=(o[k].x-o[k+1].x)*(o[k].y+o[k+1].y)}return Math.abs(.5*n)}}(),d.prototype.estimateDepth=function(a){var b=this.viewProj.elements,c=(a.min.x+a.max.x)/2,d=(a.min.y+a.max.y)/2,e=(a.min.z+a.max.z)/2,f=1/(b[3]*c+b[7]*d+b[11]*e+b[15]);return(b[2]*c+b[6]*d+b[10]*e+b[14])*f},d.prototype.intersectsBox=function(){function a(){b||(b=new h.Vector3,c=new h.Vector3)}var b,c;return function(e){a();for(var f=this.frustum.planes,g=0,h=0;h<6;h++){var i=f[h];b.x=i.normal.x>0?e.min.x:e.max.x,c.x=i.normal.x>0?e.max.x:e.min.x,b.y=i.normal.y>0?e.min.y:e.max.y,c.y=i.normal.y>0?e.max.y:e.min.y,b.z=i.normal.z>0?e.min.z:e.max.z,c.z=i.normal.z>0?e.max.z:e.min.z;var j=i.distanceToPoint(b),k=i.distanceToPoint(c);if(j<0&&k<0)return d.OUTSIDE;j>0&&k>0&&g++}return 6==g?d.CONTAINS:d.INTERSECTS}}();var n=function(){var a;return function(b,c){a||(a=new h.Vector3);for(var d=0;d<8;d++){if(!f(e(b,d,a),c))return!1}return!0}}();d.prototype.boxOutsideCutPlanes=function(a){if(!this.cutPlanes)return!1;for(var b=0;b<this.cutPlanes.length;b++){var c=this.cutPlanes[b];if(n(a,c))return!0}return!1}},function(a,b,c){"use strict";function d(a){var b=a.worker,c=g.decode(a.delta);c=c.split("").map(function(a){return a.charCodeAt(0)});for(var d=h.inflate(c),e="",f=0;f<d.length;f++)e+=String.fromCharCode(d[f]);e=JSON.parse(e),b.postMessage({cbId:a.cbId,index:a.index,res:e})}function e(a){a.register("DECOMPRESS_DELTA",{doOperation:d})}Object.defineProperty(b,"__esModule",{value:!0}),b.doDecompressDelta=d,b.register=e;var f=c(74),g=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}(f),h=c(8)},function(a,b,c){var d;(function(a,e){"use strict";var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};!function(g){var h="object"==f(b)&&b,i="object"==f(a)&&a&&a.exports==h&&a,j="object"==(void 0===e?"undefined":f(e))&&e;j.global!==j&&j.window!==j||(g=j);var k=function(a){this.message=a};k.prototype=new Error,k.prototype.name="InvalidCharacterError";var l=function(a){throw new k(a)},m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=/<%= spaceCharacters %>/g,o=function(a){a=String(a).replace(n,"");var b=a.length;b%4==0&&(a=a.replace(/==?$/,""),b=a.length),(b%4==1||/[^+a-zA-Z0-9\/]/.test(a))&&l("Invalid character: the string to be decoded is not correctly encoded.");for(var c,d,e=0,f="",g=-1;++g<b;)d=m.indexOf(a.charAt(g)),c=e%4?64*c+d:d,e++%4&&(f+=String.fromCharCode(255&c>>(-2*e&6)));return f},p=function(a){a=String(a),/[^\0-\xFF]/.test(a)&&l("The string to be encoded contains characters outside of the Latin1 range.");for(var b,c,d,e,f=a.length%3,g="",h=-1,i=a.length-f;++h<i;)b=a.charCodeAt(h)<<16,c=a.charCodeAt(++h)<<8,d=a.charCodeAt(++h),e=b+c+d,g+=m.charAt(e>>18&63)+m.charAt(e>>12&63)+m.charAt(e>>6&63)+m.charAt(63&e);return 2==f?(b=a.charCodeAt(h)<<8,c=a.charCodeAt(++h),e=b+c,g+=m.charAt(e>>10)+m.charAt(e>>4&63)+m.charAt(e<<2&63)+"="):1==f&&(e=a.charCodeAt(h),g+=m.charAt(e>>2)+m.charAt(e<<4&63)+"=="),g},q={encode:p,decode:o,version:"<%= version %>"};if("object"==f(c(75))&&c(75))void 0!==(d=function(){return q}.call(b,c,b,a))&&(a.exports=d);else if(h&&!h.nodeType)if(i)i.exports=q;else for(var r in q)q.hasOwnProperty(r)&&(h[r]=q[r]);else g.base64=q}(void 0)}).call(b,c(67)(a),function(){return this}())},function(a,b){(function(b){a.exports=b}).call(b,{})},function(a,b,c){"use strict";function d(a,b){try{b()}catch(b){a.worker.raiseError(i.ErrorCodes.BAD_DATA,"Unhandled exception while loading Scalaris data",{url:a.url,exception:b.toString(),stack:b.stack}),a.worker.postMessage(null)}}function e(a){function b(b){d(a,function(){var d=g(a,b);if(d){var e={geometry:{indices:d.attributes.index.array.buffer,normals:d.attributes.normal.array.buffer,vertices:d.attributes.position.array.buffer,meshCount:1,offsets:d.offsets,min:d.min,max:d.max,stressMin:d.stressMin,stressMax:d.stressMax,stressData:d.stressData}};self.postMessage(e,[e.geometry.indices,e.geometry.normals,e.geometry.vertices])}c.postMessage({progress:1})})}var c=a.worker;c.postMessage({progress:.01});var e=a.url.split("?"),f=e[0];a.queryParams=a.queryParams?a.queryParams+"&"+e[1]:e[1];var h={responseType:"arraybuffer"};(function(a){return new Promise(function(b,c){l.load(a,function(a,c){b(c)})})})(a.scalarisProtoPath).then(function(d){c.root=d,j.ViewingService.getItem(a,f,b,a.onFailureCallback,h)})}function f(a,b){var c=new m(0,!0,!1);c.buffer=b.buffer,c.offset=0,c.limit=b.byteLength,c.view=b.byteLength>0?new DataView(b.buffer):null;var d=new o(a.root,function(b){a.postMessage({progress:b})});if(!d.parseData(c))return console.log("\nError: Failed to load the scalaris data"),null;if(!d.m_vertexNormals&&d.m_triangles&&d.m_triangles.length>2){d.m_vertexNormals=new Float32Array(d.m_vertices.length);for(var e=new k.LmvVector3,f=new k.LmvVector3,g=new k.LmvVector3,h=new k.LmvVector3,i=new k.LmvVector3,j=0,l=0,n=0,p=d.m_triangles.length,q=0;q<p;q+=3)j=3*d.m_triangles[q],l=3*d.m_triangles[q+1],n=3*d.m_triangles[q+2],e.set(d.m_vertices[j],d.m_vertices[j+1],d.m_vertices[j+2]),f.set(d.m_vertices[l],d.m_vertices[l+1],d.m_vertices[l+2]),g.set(d.m_vertices[n],d.m_vertices[n+1],d.m_vertices[n+2]),h.subVectors(g,f),i.subVectors(e,f),h.cross(i),h.normalize(),d.m_vertexNormals[j]=d.m_vertexNormals[l]=d.m_vertexNormals[n]=h.x,d.m_vertexNormals[j+1]=d.m_vertexNormals[l+1]=d.m_vertexNormals[n+1]=h.y,d.m_vertexNormals[j+2]=d.m_vertexNormals[l+2]=d.m_vertexNormals[n+2]=h.z}return d.m_vertices&&d.m_vertices.length?{attributes:{index:{itemSize:1,array:d.m_triangles},position:{itemSize:3,array:d.m_vertices},normal:{itemSize:3,array:d.m_vertexNormals}},min:d.m_min,max:d.m_max,stressMin:d.m_stressMin,stressMax:d.m_stressMax,stressData:d.m_vmStress,offsets:[]}:null}function g(a,b){return f(a.worker,b)}function h(a){a.register("LOAD_SCALARIS",{doOperation:e})}Object.defineProperty(b,"__esModule",{value:!0}),b.register=h;var i=c(6),j=c(2),k=c(28),l=c(77),m=c(121),n={0:"Mesh",1:"ElementData",2:"NodeData",3:"Scalar",4:"ValueData",5:"StringData",6:"Texture"},o=function(a,b){this.m_protoRoot=a,this.m_prefixParsed=!1,this.m_headerParsed=!1,this.m_data=null,this.m_onProgress=function(){if(this.m_data&&b){var a=this.m_data.offset/this.m_data.limit;b(Math.max(.01,Math.min(a,.999)))}},this.m_vertices=null,this.m_triangles=null,this.m_vertexNormals=null,this.m_faceNormals=null,this.m_vertexColors=null,this.m_vmStress=null,this.m_min=new k.LmvVector3(1/0,1/0,1/0),this.m_max=new k.LmvVector3(-1/0,-1/0,-1/0),this.m_stressMin=1/0,this.m_stressMax=-1/0,this.m_refs={}};o.prototype.constructor=o,o.prototype.parseData=function(a){return this.m_data=a,
this.doParseData(!1)},o.prototype.flush=function(){this.doParseData(!0)},o.prototype.doParseData=function(a){if(!(this.m_prefixParsed||this.doParsePrefix(a)&&this.m_data.remaining()))return!1;if(!(this.m_headerParsed||this.doParseHeader(a)&&this.m_data.remaining()))return!1;for(;this.m_data.remaining()&&(a||!(this.m_data.remaining()<32));){var b=!1,c=this.m_data.readVarint32(),d=this.m_data.readVarint32();if(d<=this.m_data.remaining()&&(this.handleMessage(c,d),b=!0),!b)break;this.m_data.skip(d),this.m_onProgress()}return!0},o.prototype.doParsePrefix=function(a){if(!a&&this.m_data.remaining()<8)return!1;if(6514!==this.m_data.readUint32())return console.log("\n Invalid Scalaris file."),!1;var b=this.m_data.readUint32();return b<=this.m_data.remaining()&&(this.m_data.skip(b),this.m_prefixParsed=!0),!0},o.prototype.doParseHeader=function(a){if(!a&&this.m_data.remaining()<24)return!1;var b=this.m_data.readVarint32();return b<=this.m_data.remaining()&&(this.m_data.skip(b),this.m_headerParsed=!0),!0},o.prototype.handleMessage=function(a,b){try{var c=n[a],d=this.m_protoRoot.lookupType("Scalaris."+c),e=d.decode(new Uint8Array(this.m_data.buffer,this.m_data.offset,b));switch(c){case"Mesh":this.m_refs[e.ref]=e;break;case"NodeData":this._parseNodeDataMsg(e);break;case"ElementData":this._parseElementDataMsg(e);break;case"Scalar":this.m_refs[e.ref]=e;break;case"ValueData":this._parseValueDataMsg(e)}}catch(a){console.log("Error: failed to parse message of type",d.name,a)}},o.prototype._parseNodeDataMsg=function(a){var b=this.m_refs[a.ref],c=b.nodes,d=a.offset||0;d||(this.m_vertices=new Float32Array(3*c));for(var e=a.data.length,f=0;f<e;f++){for(var g=a.data[f].values,h=3*(d+f),i=0;i<3;i++)this.m_vertices[h+i]=g[i];this._updateBBox(g)}},o.prototype._parseElementDataMsg=function(a){var b=this.m_refs[a.ref],c=b.elements,d=a.offset||0;d||(this.m_triangles=new Uint32Array(3*c));for(var e=a.data.length,f=0;f<e;f++){var g=a.data[f];if(5===g.type)for(var h=3*(d+f),i=0;i<3;i++)this.m_triangles[h+i]=g.nodes[i]}},o.prototype._updateBBox=function(a){a[0]<this.m_min.x&&(this.m_min.x=a[0]),a[0]>this.m_max.x&&(this.m_max.x=a[0]),a[1]<this.m_min.y&&(this.m_min.y=a[1]),a[1]>this.m_max.y&&(this.m_max.y=a[1]),a[2]<this.m_min.z&&(this.m_min.z=a[2]),a[2]>this.m_max.z&&(this.m_max.z=a[2])},o.prototype._updateVMStress=function(a){a<this.m_stressMin&&(this.m_stressMin=a),a>this.m_stressMax&&(this.m_stressMax=a)},o.prototype._parseValueData=function(a,b,c){var d=b.offset||0,e=b.data.length,f=c.components,g=!1;"VMStress"===c.name&&(g=!0);for(var h=0;h<e;h++)for(var i=(d+h)*f,j=0;j<f;j++){var k=b.data[h].values[j];a[i+j]=k,g&&this._updateVMStress(k)}},o.prototype._parseValueDataMsg=function(a){var b=this.m_refs[a.ref],c=b.tuples,d=b.components,e=a.offset||0,f=null;switch(b.name){case"Normals":2===b.parent&&(e||(this.m_vertexNormals=new Float32Array(c*d)),f=this.m_vertexNormals);break;case"Colors":break;case"VMStress":2===b.parent&&(e||(this.m_vmStress=new Float32Array(c*d)),f=this.m_vmStress)}f&&this._parseValueData(f,a,b)}},function(a,b,c){"use strict";a.exports=c(78)},function(a,b,c){"use strict";var d=a.exports=c(79);d.build="full",d.tokenize=c(118),d.parse=c(119),d.common=c(120),d.Root._configure(d.Type,d.parse,d.common)},function(a,b,c){"use strict";function d(a,b,c){return"function"==typeof b?(c=b,b=new f.Root):b||(b=new f.Root),b.load(a,c)}function e(a,b){return b||(b=new f.Root),b.loadSync(a)}var f=a.exports=c(80);f.build="light",f.load=d,f.loadSync=e,f.encoder=c(97),f.decoder=c(113),f.verifier=c(114),f.converter=c(115),f.ReflectionObject=c(99),f.Namespace=c(105),f.Root=c(117),f.Enum=c(98),f.Type=c(104),f.Field=c(106),f.OneOf=c(108),f.MapField=c(109),f.Service=c(110),f.Method=c(111),f.Message=c(112),f.wrappers=c(116),f.types=c(107),f.util=c(100),f.ReflectionObject._configure(f.Root),f.Namespace._configure(f.Type,f.Service,f.Enum),f.Root._configure(f.Type),f.Field._configure(f.Type)},function(a,b,c){"use strict";function d(){e.Reader._configure(e.BufferReader),e.util._configure()}var e=b;e.build="minimal",e.Writer=c(81),e.BufferWriter=c(91),e.Reader=c(92),e.BufferReader=c(93),e.util=c(82),e.rpc=c(94),e.roots=c(96),e.configure=d,e.Writer._configure(e.BufferWriter),d()},function(a,b,c){"use strict";function d(a,b,c){this.fn=a,this.len=b,this.next=void 0,this.val=c}function e(){}function f(a){this.head=a.head,this.tail=a.tail,this.len=a.len,this.next=a.states}function g(){this.len=0,this.head=new d(e,0,0),this.tail=this.head,this.states=null}function h(a,b,c){b[c]=255&a}function i(a,b,c){for(;a>127;)b[c++]=127&a|128,a>>>=7;b[c]=a}function j(a,b){this.len=a,this.next=void 0,this.val=b}function k(a,b,c){for(;a.hi;)b[c++]=127&a.lo|128,a.lo=(a.lo>>>7|a.hi<<25)>>>0,a.hi>>>=7;for(;a.lo>127;)b[c++]=127&a.lo|128,a.lo=a.lo>>>7;b[c++]=a.lo}function l(a,b,c){b[c]=255&a,b[c+1]=a>>>8&255,b[c+2]=a>>>16&255,b[c+3]=a>>>24}a.exports=g;var m,n=c(82),o=n.LongBits,p=n.base64,q=n.utf8;g.create=n.Buffer?function(){return(g.create=function(){return new m})()}:function(){return new g},g.alloc=function(a){return new n.Array(a)},n.Array!==Array&&(g.alloc=n.pool(g.alloc,n.Array.prototype.subarray)),g.prototype._push=function(a,b,c){return this.tail=this.tail.next=new d(a,b,c),this.len+=b,this},j.prototype=Object.create(d.prototype),j.prototype.fn=i,g.prototype.uint32=function(a){return this.len+=(this.tail=this.tail.next=new j((a>>>=0)<128?1:a<16384?2:a<2097152?3:a<268435456?4:5,a)).len,this},g.prototype.int32=function(a){return a<0?this._push(k,10,o.fromNumber(a)):this.uint32(a)},g.prototype.sint32=function(a){return this.uint32((a<<1^a>>31)>>>0)},g.prototype.uint64=function(a){var b=o.from(a);return this._push(k,b.length(),b)},g.prototype.int64=g.prototype.uint64,g.prototype.sint64=function(a){var b=o.from(a).zzEncode();return this._push(k,b.length(),b)},g.prototype.bool=function(a){return this._push(h,1,a?1:0)},g.prototype.fixed32=function(a){return this._push(l,4,a>>>0)},g.prototype.sfixed32=g.prototype.fixed32,g.prototype.fixed64=function(a){var b=o.from(a);return this._push(l,4,b.lo)._push(l,4,b.hi)},g.prototype.sfixed64=g.prototype.fixed64,g.prototype.float=function(a){return this._push(n.float.writeFloatLE,4,a)},g.prototype.double=function(a){return this._push(n.float.writeDoubleLE,8,a)};var r=n.Array.prototype.set?function(a,b,c){b.set(a,c)}:function(a,b,c){for(var d=0;d<a.length;++d)b[c+d]=a[d]};g.prototype.bytes=function(a){var b=a.length>>>0;if(!b)return this._push(h,1,0);if(n.isString(a)){var c=g.alloc(b=p.length(a));p.decode(a,c,0),a=c}return this.uint32(b)._push(r,b,a)},g.prototype.string=function(a){var b=q.length(a);return b?this.uint32(b)._push(q.write,b,a):this._push(h,1,0)},g.prototype.fork=function(){return this.states=new f(this),this.head=this.tail=new d(e,0,0),this.len=0,this},g.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new d(e,0,0),this.len=0),this},g.prototype.ldelim=function(){var a=this.head,b=this.tail,c=this.len;return this.reset().uint32(c),c&&(this.tail.next=a.next,this.tail=b,this.len+=c),this},g.prototype.finish=function(){for(var a=this.head.next,b=this.constructor.alloc(this.len),c=0;a;)a.fn(a.val,b,c),c+=a.len,a=a.next;return b},g._configure=function(a){m=a}},function(a,b,c){(function(a){"use strict";function d(a,b,c){for(var d=Object.keys(b),e=0;e<d.length;++e)void 0!==a[d[e]]&&c||(a[d[e]]=b[d[e]]);return a}function e(a){function b(a,c){if(!(this instanceof b))return new b(a,c);Object.defineProperty(this,"message",{get:function(){return a}}),Error.captureStackTrace?Error.captureStackTrace(this,b):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),c&&d(this,c)}return(b.prototype=Object.create(Error.prototype)).constructor=b,Object.defineProperty(b.prototype,"name",{get:function(){return a}}),b.prototype.toString=function(){return this.name+": "+this.message},b}var f=b;f.asPromise=c(83),f.base64=c(84),f.EventEmitter=c(85),f.float=c(86),f.inquire=c(87),f.utf8=c(88),f.pool=c(89),f.LongBits=c(90),f.global="undefined"!=typeof window&&window||void 0!==a&&a||"undefined"!=typeof self&&self||this,f.emptyArray=Object.freeze?Object.freeze([]):[],f.emptyObject=Object.freeze?Object.freeze({}):{},f.isNode=Boolean(f.global.process&&f.global.process.versions&&f.global.process.versions.node),f.isInteger=Number.isInteger||function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a},f.isString=function(a){return"string"==typeof a||a instanceof String},f.isObject=function(a){return a&&"object"==typeof a},f.isset=f.isSet=function(a,b){var c=a[b];return!(null==c||!a.hasOwnProperty(b))&&("object"!=typeof c||(Array.isArray(c)?c.length:Object.keys(c).length)>0)},f.Buffer=function(){try{var a=f.inquire("buffer").Buffer;return a.prototype.utf8Write?a:null}catch(a){return null}}(),f._Buffer_from=null,f._Buffer_allocUnsafe=null,f.newBuffer=function(a){return"number"==typeof a?f.Buffer?f._Buffer_allocUnsafe(a):new f.Array(a):f.Buffer?f._Buffer_from(a):"undefined"==typeof Uint8Array?a:new Uint8Array(a)},f.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,f.Long=f.global.dcodeIO&&f.global.dcodeIO.Long||f.global.Long||f.inquire("long"),f.key2Re=/^true|false|0|1$/,f.key32Re=/^-?(?:0|[1-9][0-9]*)$/,f.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,f.longToHash=function(a){return a?f.LongBits.from(a).toHash():f.LongBits.zeroHash},f.longFromHash=function(a,b){var c=f.LongBits.fromHash(a);return f.Long?f.Long.fromBits(c.lo,c.hi,b):c.toNumber(Boolean(b))},f.merge=d,f.lcFirst=function(a){return a.charAt(0).toLowerCase()+a.substring(1)},f.newError=e,f.ProtocolError=e("ProtocolError"),f.oneOfGetter=function(a){for(var b={},c=0;c<a.length;++c)b[a[c]]=1;return function(){for(var a=Object.keys(this),c=a.length-1;c>-1;--c)if(1===b[a[c]]&&void 0!==this[a[c]]&&null!==this[a[c]])return a[c]}},f.oneOfSetter=function(a){return function(b){for(var c=0;c<a.length;++c)a[c]!==b&&delete this[a[c]]}},f.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},f._configure=function(){var a=f.Buffer;if(!a)return void(f._Buffer_from=f._Buffer_allocUnsafe=null);f._Buffer_from=a.from!==Uint8Array.from&&a.from||function(b,c){return new a(b,c)},f._Buffer_allocUnsafe=a.allocUnsafe||function(b){return new a(b)}}}).call(b,function(){return this}())},function(a,b){"use strict";function c(a,b){for(var c=new Array(arguments.length-1),d=0,e=2,f=!0;e<arguments.length;)c[d++]=arguments[e++];return new Promise(function(e,g){c[d]=function(a){if(f)if(f=!1,a)g(a);else{for(var b=new Array(arguments.length-1),c=0;c<b.length;)b[c++]=arguments[c];e.apply(null,b)}};try{a.apply(b||null,c)}catch(a){f&&(f=!1,g(a))}})}a.exports=c},function(a,b){"use strict";var c=b;c.length=function(a){var b=a.length;if(!b)return 0;for(var c=0;--b%4>1&&"="===a.charAt(b);)++c;return Math.ceil(3*a.length)/4-c};for(var d=new Array(64),e=new Array(123),f=0;f<64;)e[d[f]=f<26?f+65:f<52?f+71:f<62?f-4:f-59|43]=f++;c.encode=function(a,b,c){for(var e,f=null,g=[],h=0,i=0;b<c;){var j=a[b++];switch(i){case 0:g[h++]=d[j>>2],e=(3&j)<<4,i=1;break;case 1:g[h++]=d[e|j>>4],e=(15&j)<<2,i=2;break;case 2:g[h++]=d[e|j>>6],g[h++]=d[63&j],i=0}h>8191&&((f||(f=[])).push(String.fromCharCode.apply(String,g)),h=0)}return i&&(g[h++]=d[e],g[h++]=61,1===i&&(g[h++]=61)),f?(h&&f.push(String.fromCharCode.apply(String,g.slice(0,h))),f.join("")):String.fromCharCode.apply(String,g.slice(0,h))};c.decode=function(a,b,c){for(var d,f=c,g=0,h=0;h<a.length;){var i=a.charCodeAt(h++);if(61===i&&g>1)break;if(void 0===(i=e[i]))throw Error("invalid encoding");switch(g){case 0:d=i,g=1;break;case 1:b[c++]=d<<2|(48&i)>>4,d=i,g=2;break;case 2:b[c++]=(15&d)<<4|(60&i)>>2,d=i,g=3;break;case 3:b[c++]=(3&d)<<6|i,g=0}}if(1===g)throw Error("invalid encoding");return c-f},c.test=function(a){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(a)}},function(a,b){"use strict";function c(){this._listeners={}}a.exports=c,c.prototype.on=function(a,b,c){return(this._listeners[a]||(this._listeners[a]=[])).push({fn:b,ctx:c||this}),this},c.prototype.off=function(a,b){if(void 0===a)this._listeners={};else if(void 0===b)this._listeners[a]=[];else for(var c=this._listeners[a],d=0;d<c.length;)c[d].fn===b?c.splice(d,1):++d;return this},c.prototype.emit=function(a){var b=this._listeners[a];if(b){for(var c=[],d=1;d<arguments.length;)c.push(arguments[d++]);for(d=0;d<b.length;)b[d].fn.apply(b[d++].ctx,c)}return this}},function(a,b){"use strict";function c(a){return"undefined"!=typeof Float32Array?function(){function b(a,b,c){f[0]=a,b[c]=g[0],b[c+1]=g[1],b[c+2]=g[2],b[c+3]=g[3]}function c(a,b,c){f[0]=a,b[c]=g[3],b[c+1]=g[2],b[c+2]=g[1],b[c+3]=g[0]}function d(a,b){return g[0]=a[b],g[1]=a[b+1],g[2]=a[b+2],g[3]=a[b+3],f[0]}function e(a,b){return g[3]=a[b],g[2]=a[b+1],g[1]=a[b+2],g[0]=a[b+3],f[0]}var f=new Float32Array([-0]),g=new Uint8Array(f.buffer),h=128===g[3];a.writeFloatLE=h?b:c,a.writeFloatBE=h?c:b,a.readFloatLE=h?d:e,a.readFloatBE=h?e:d}():function(){function b(a,b,c,d){var e=b<0?1:0;if(e&&(b=-b),0===b)a(1/b>0?0:2147483648,c,d);else if(isNaN(b))a(2143289344,c,d);else if(b>3.4028234663852886e38)a((e<<31|2139095040)>>>0,c,d);else if(b<1.1754943508222875e-38)a((e<<31|Math.round(b/1.401298464324817e-45))>>>0,c,d);else{var f=Math.floor(Math.log(b)/Math.LN2),g=8388607&Math.round(b*Math.pow(2,-f)*8388608);a((e<<31|f+127<<23|g)>>>0,c,d)}}function c(a,b,c){var d=a(b,c),e=2*(d>>31)+1,f=d>>>23&255,g=8388607&d;return 255===f?g?NaN:e*(1/0):0===f?1.401298464324817e-45*e*g:e*Math.pow(2,f-150)*(g+8388608)}a.writeFloatLE=b.bind(null,d),a.writeFloatBE=b.bind(null,e),a.readFloatLE=c.bind(null,f),a.readFloatBE=c.bind(null,g)}(),"undefined"!=typeof Float64Array?function(){function b(a,b,c){f[0]=a,b[c]=g[0],b[c+1]=g[1],b[c+2]=g[2],b[c+3]=g[3],b[c+4]=g[4],b[c+5]=g[5],b[c+6]=g[6],b[c+7]=g[7]}function c(a,b,c){f[0]=a,b[c]=g[7],b[c+1]=g[6],b[c+2]=g[5],b[c+3]=g[4],b[c+4]=g[3],b[c+5]=g[2],b[c+6]=g[1],b[c+7]=g[0]}function d(a,b){return g[0]=a[b],g[1]=a[b+1],g[2]=a[b+2],g[3]=a[b+3],g[4]=a[b+4],g[5]=a[b+5],g[6]=a[b+6],g[7]=a[b+7],f[0]}function e(a,b){return g[7]=a[b],g[6]=a[b+1],g[5]=a[b+2],g[4]=a[b+3],g[3]=a[b+4],g[2]=a[b+5],g[1]=a[b+6],g[0]=a[b+7],f[0]}var f=new Float64Array([-0]),g=new Uint8Array(f.buffer),h=128===g[7];a.writeDoubleLE=h?b:c,a.writeDoubleBE=h?c:b,a.readDoubleLE=h?d:e,a.readDoubleBE=h?e:d}():function(){function b(a,b,c,d,e,f){var g=d<0?1:0;if(g&&(d=-d),0===d)a(0,e,f+b),a(1/d>0?0:2147483648,e,f+c);else if(isNaN(d))a(0,e,f+b),a(2146959360,e,f+c);else if(d>1.7976931348623157e308)a(0,e,f+b),a((g<<31|2146435072)>>>0,e,f+c);else{var h;if(d<2.2250738585072014e-308)h=d/5e-324,a(h>>>0,e,f+b),a((g<<31|h/4294967296)>>>0,e,f+c);else{var i=Math.floor(Math.log(d)/Math.LN2);1024===i&&(i=1023),h=d*Math.pow(2,-i),a(4503599627370496*h>>>0,e,f+b),a((g<<31|i+1023<<20|1048576*h&1048575)>>>0,e,f+c)}}}function c(a,b,c,d,e){var f=a(d,e+b),g=a(d,e+c),h=2*(g>>31)+1,i=g>>>20&2047,j=4294967296*(1048575&g)+f;return 2047===i?j?NaN:h*(1/0):0===i?5e-324*h*j:h*Math.pow(2,i-1075)*(j+4503599627370496)}a.writeDoubleLE=b.bind(null,d,0,4),a.writeDoubleBE=b.bind(null,e,4,0),a.readDoubleLE=c.bind(null,f,0,4),a.readDoubleBE=c.bind(null,g,4,0)}(),a}function d(a,b,c){b[c]=255&a,b[c+1]=a>>>8&255,b[c+2]=a>>>16&255,b[c+3]=a>>>24}function e(a,b,c){b[c]=a>>>24,b[c+1]=a>>>16&255,b[c+2]=a>>>8&255,b[c+3]=255&a}function f(a,b){return(a[b]|a[b+1]<<8|a[b+2]<<16|a[b+3]<<24)>>>0}function g(a,b){return(a[b]<<24|a[b+1]<<16|a[b+2]<<8|a[b+3])>>>0}a.exports=c(c)},function(module,exports){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(a){}return null}module.exports=inquire},function(a,b){"use strict";var c=b;c.length=function(a){for(var b=0,c=0,d=0;d<a.length;++d)c=a.charCodeAt(d),c<128?b+=1:c<2048?b+=2:55296==(64512&c)&&56320==(64512&a.charCodeAt(d+1))?(++d,b+=4):b+=3;return b},c.read=function(a,b,c){if(c-b<1)return"";for(var d,e=null,f=[],g=0;b<c;)d=a[b++],d<128?f[g++]=d:d>191&&d<224?f[g++]=(31&d)<<6|63&a[b++]:d>239&&d<365?(d=((7&d)<<18|(63&a[b++])<<12|(63&a[b++])<<6|63&a[b++])-65536,f[g++]=55296+(d>>10),f[g++]=56320+(1023&d)):f[g++]=(15&d)<<12|(63&a[b++])<<6|63&a[b++],g>8191&&((e||(e=[])).push(String.fromCharCode.apply(String,f)),g=0);return e?(g&&e.push(String.fromCharCode.apply(String,f.slice(0,g))),e.join("")):String.fromCharCode.apply(String,f.slice(0,g))},c.write=function(a,b,c){for(var d,e,f=c,g=0;g<a.length;++g)d=a.charCodeAt(g),d<128?b[c++]=d:d<2048?(b[c++]=d>>6|192,b[c++]=63&d|128):55296==(64512&d)&&56320==(64512&(e=a.charCodeAt(g+1)))?(d=65536+((1023&d)<<10)+(1023&e),++g,b[c++]=d>>18|240,b[c++]=d>>12&63|128,b[c++]=d>>6&63|128,b[c++]=63&d|128):(b[c++]=d>>12|224,b[c++]=d>>6&63|128,b[c++]=63&d|128);return c-f}},function(a,b){"use strict";function c(a,b,c){var d=c||8192,e=d>>>1,f=null,g=d;return function(c){if(c<1||c>e)return a(c);g+c>d&&(f=a(d),g=0);var h=b.call(f,g,g+=c);return 7&g&&(g=1+(7|g)),h}}a.exports=c},function(a,b,c){"use strict";function d(a,b){this.lo=a>>>0,this.hi=b>>>0}a.exports=d;var e=c(82),f=d.zero=new d(0,0);f.toNumber=function(){return 0},f.zzEncode=f.zzDecode=function(){return this},f.length=function(){return 1};var g=d.zeroHash="\0\0\0\0\0\0\0\0";d.fromNumber=function(a){if(0===a)return f;var b=a<0;b&&(a=-a);var c=a>>>0,e=(a-c)/4294967296>>>0;return b&&(e=~e>>>0,c=~c>>>0,++c>4294967295&&(c=0,++e>4294967295&&(e=0))),new d(c,e)},d.from=function(a){if("number"==typeof a)return d.fromNumber(a);if(e.isString(a)){if(!e.Long)return d.fromNumber(parseInt(a,10));a=e.Long.fromString(a)}return a.low||a.high?new d(a.low>>>0,a.high>>>0):f},d.prototype.toNumber=function(a){if(!a&&this.hi>>>31){var b=1+~this.lo>>>0,c=~this.hi>>>0;return b||(c=c+1>>>0),-(b+4294967296*c)}return this.lo+4294967296*this.hi},d.prototype.toLong=function(a){return e.Long?new e.Long(0|this.lo,0|this.hi,Boolean(a)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(a)}};var h=String.prototype.charCodeAt;d.fromHash=function(a){return a===g?f:new d((h.call(a,0)|h.call(a,1)<<8|h.call(a,2)<<16|h.call(a,3)<<24)>>>0,(h.call(a,4)|h.call(a,5)<<8|h.call(a,6)<<16|h.call(a,7)<<24)>>>0)},d.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},d.prototype.zzEncode=function(){var a=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^a)>>>0,this.lo=(this.lo<<1^a)>>>0,this},d.prototype.zzDecode=function(){var a=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^a)>>>0,this.hi=(this.hi>>>1^a)>>>0,this},d.prototype.length=function(){var a=this.lo,b=(this.lo>>>28|this.hi<<4)>>>0,c=this.hi>>>24;return 0===c?0===b?a<16384?a<128?1:2:a<2097152?3:4:b<16384?b<128?5:6:b<2097152?7:8:c<128?9:10}},function(a,b,c){"use strict";function d(){f.call(this)}function e(a,b,c){a.length<40?g.utf8.write(a,b,c):b.utf8Write(a,c)}a.exports=d;var f=c(81);(d.prototype=Object.create(f.prototype)).constructor=d;var g=c(82),h=g.Buffer;d.alloc=function(a){return(d.alloc=g._Buffer_allocUnsafe)(a)};var i=h&&h.prototype instanceof Uint8Array&&"set"===h.prototype.set.name?function(a,b,c){b.set(a,c)}:function(a,b,c){if(a.copy)a.copy(b,c,0,a.length);else for(var d=0;d<a.length;)b[c++]=a[d++]};d.prototype.bytes=function(a){g.isString(a)&&(a=g._Buffer_from(a,"base64"));var b=a.length>>>0;return this.uint32(b),b&&this._push(i,b,a),this},d.prototype.string=function(a){var b=h.byteLength(a);return this.uint32(b),b&&this._push(e,b,a),this}},function(a,b,c){"use strict";function d(a,b){return RangeError("index out of range: "+a.pos+" + "+(b||1)+" > "+a.len)}function e(a){this.buf=a,this.pos=0,this.len=a.length}function f(){var a=new k(0,0),b=0;if(!(this.len-this.pos>4)){for(;b<3;++b){if(this.pos>=this.len)throw d(this);if(a.lo=(a.lo|(127&this.buf[this.pos])<<7*b)>>>0,this.buf[this.pos++]<128)return a}return a.lo=(a.lo|(127&this.buf[this.pos++])<<7*b)>>>0,a}for(;b<4;++b)if(a.lo=(a.lo|(127&this.buf[this.pos])<<7*b)>>>0,this.buf[this.pos++]<128)return a;if(a.lo=(a.lo|(127&this.buf[this.pos])<<28)>>>0,a.hi=(a.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return a;if(b=0,this.len-this.pos>4){for(;b<5;++b)if(a.hi=(a.hi|(127&this.buf[this.pos])<<7*b+3)>>>0,this.buf[this.pos++]<128)return a}else for(;b<5;++b){if(this.pos>=this.len)throw d(this);if(a.hi=(a.hi|(127&this.buf[this.pos])<<7*b+3)>>>0,this.buf[this.pos++]<128)return a}throw Error("invalid varint encoding")}function g(a,b){return(a[b-4]|a[b-3]<<8|a[b-2]<<16|a[b-1]<<24)>>>0}function h(){if(this.pos+8>this.len)throw d(this,8);return new k(g(this.buf,this.pos+=4),g(this.buf,this.pos+=4))}a.exports=e;var i,j=c(82),k=j.LongBits,l=j.utf8,m="undefined"!=typeof Uint8Array?function(a){if(a instanceof Uint8Array||Array.isArray(a))return new e(a);throw Error("illegal buffer")}:function(a){if(Array.isArray(a))return new e(a);throw Error("illegal buffer")};e.create=j.Buffer?function(a){return(e.create=function(a){return j.Buffer.isBuffer(a)?new i(a):m(a)})(a)}:m,e.prototype._slice=j.Array.prototype.subarray||j.Array.prototype.slice,e.prototype.uint32=function(){var a=4294967295;return function(){if(a=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return a;if(a=(a|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return a;if(a=(a|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return a;if(a=(a|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return a;if(a=(a|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return a;if((this.pos+=5)>this.len)throw this.pos=this.len,d(this,10);return a}}(),e.prototype.int32=function(){return 0|this.uint32()},e.prototype.sint32=function(){var a=this.uint32();return a>>>1^-(1&a)|0},e.prototype.bool=function(){return 0!==this.uint32()},e.prototype.fixed32=function(){if(this.pos+4>this.len)throw d(this,4);return g(this.buf,this.pos+=4)},e.prototype.sfixed32=function(){if(this.pos+4>this.len)throw d(this,4);return 0|g(this.buf,this.pos+=4)},e.prototype.float=function(){if(this.pos+4>this.len)throw d(this,4);var a=j.float.readFloatLE(this.buf,this.pos);return this.pos+=4,a},e.prototype.double=function(){if(this.pos+8>this.len)throw d(this,4);var a=j.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,a},e.prototype.bytes=function(){var a=this.uint32(),b=this.pos,c=this.pos+a;if(c>this.len)throw d(this,a);return this.pos+=a,Array.isArray(this.buf)?this.buf.slice(b,c):b===c?new this.buf.constructor(0):this._slice.call(this.buf,b,c)},e.prototype.string=function(){var a=this.bytes();return l.read(a,0,a.length)},e.prototype.skip=function(a){if("number"==typeof a){if(this.pos+a>this.len)throw d(this,a);this.pos+=a}else do{if(this.pos>=this.len)throw d(this)}while(128&this.buf[this.pos++]);return this},e.prototype.skipType=function(a){switch(a){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(a=7&this.uint32());)this.skipType(a);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+a+" at offset "+this.pos)}return this},e._configure=function(a){i=a;var b=j.Long?"toLong":"toNumber";j.merge(e.prototype,{int64:function(){return f.call(this)[b](!1)},uint64:function(){return f.call(this)[b](!0)},sint64:function(){return f.call(this).zzDecode()[b](!1)},fixed64:function(){return h.call(this)[b](!0)},sfixed64:function(){return h.call(this)[b](!1)}})}},function(a,b,c){"use strict";function d(a){e.call(this,a)}a.exports=d;var e=c(92);(d.prototype=Object.create(e.prototype)).constructor=d;var f=c(82);f.Buffer&&(d.prototype._slice=f.Buffer.prototype.slice),d.prototype.string=function(){var a=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+a,this.len))}},function(a,b,c){"use strict";b.Service=c(95)},function(a,b,c){"use strict";function d(a,b,c){if("function"!=typeof a)throw TypeError("rpcImpl must be a function");e.EventEmitter.call(this),this.rpcImpl=a,this.requestDelimited=Boolean(b),this.responseDelimited=Boolean(c)}a.exports=d;var e=c(82);(d.prototype=Object.create(e.EventEmitter.prototype)).constructor=d,d.prototype.rpcCall=function a(b,c,d,f,g){if(!f)throw TypeError("request must be specified");var h=this;if(!g)return e.asPromise(a,h,b,c,d,f);if(!h.rpcImpl)return void setTimeout(function(){g(Error("already ended"))},0);try{return h.rpcImpl(b,c[h.requestDelimited?"encodeDelimited":"encode"](f).finish(),function(a,c){if(a)return h.emit("error",a,b),g(a);if(null===c)return void h.end(!0);if(!(c instanceof d))try{c=d[h.responseDelimited?"decodeDelimited":"decode"](c)}catch(a){return h.emit("error",a,b),g(a)}return h.emit("data",c,b),g(null,c)})}catch(a){return h.emit("error",a,b),void setTimeout(function(){g(a)},0)}},d.prototype.end=function(a){return this.rpcImpl&&(a||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(a,b){"use strict";a.exports={}},function(a,b,c){"use strict";function d(a,b,c,d){return b.resolvedType.group?a("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",c,d,(b.id<<3|3)>>>0,(b.id<<3|4)>>>0):a("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",c,d,(b.id<<3|2)>>>0)}function e(a){for(var b,c,e=h.codegen(["m","w"],a.name+"$encode")("if(!w)")("w=Writer.create()"),i=a.fieldsArray.slice().sort(h.compareFieldsById),b=0;b<i.length;++b){var j=i[b].resolve(),k=a._fieldsArray.indexOf(j),l=j.resolvedType instanceof f?"int32":j.type,m=g.basic[l];c="m"+h.safeProp(j.name),j.map?(e("if(%s!=null&&m.hasOwnProperty(%j)){",c,j.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",c)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(j.id<<3|2)>>>0,8|g.mapKey[j.keyType],j.keyType),void 0===m?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",k,c):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|m,l,c),e("}")("}")):j.repeated?(e("if(%s!=null&&%s.length){",c,c),j.packed&&void 0!==g.packed[l]?e("w.uint32(%i).fork()",(j.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",c)("w.%s(%s[i])",l,c)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",c),void 0===m?d(e,j,k,c+"[i]"):e("w.uint32(%i).%s(%s[i])",(j.id<<3|m)>>>0,l,c)),e("}")):(j.optional&&e("if(%s!=null&&m.hasOwnProperty(%j))",c,j.name),void 0===m?d(e,j,k,c):e("w.uint32(%i).%s(%s)",(j.id<<3|m)>>>0,l,c))}return e("return w")}a.exports=e;var f=c(98),g=c(107),h=c(100)},function(a,b,c){"use strict";function d(a,b,c,d,f){if(e.call(this,a,c),b&&"object"!=typeof b)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=d,this.comments=f||{},this.reserved=void 0,b)for(var g=Object.keys(b),h=0;h<g.length;++h)"number"==typeof b[g[h]]&&(this.valuesById[this.values[g[h]]=b[g[h]]]=g[h])}a.exports=d;var e=c(99);((d.prototype=Object.create(e.prototype)).constructor=d).className="Enum";var f=c(105),g=c(100);d.fromJSON=function(a,b){var c=new d(a,b.values,b.options,b.comment,b.comments);return c.reserved=b.reserved,c},d.prototype.toJSON=function(a){var b=!!a&&Boolean(a.keepComments);return g.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",b?this.comment:void 0,"comments",b?this.comments:void 0])},d.prototype.add=function(a,b,c){if(!g.isString(a))throw TypeError("name must be a string");if(!g.isInteger(b))throw TypeError("id must be an integer");if(void 0!==this.values[a])throw Error("duplicate name '"+a+"' in "+this);if(this.isReservedId(b))throw Error("id "+b+" is reserved in "+this);if(this.isReservedName(a))throw Error("name '"+a+"' is reserved in "+this);if(void 0!==this.valuesById[b]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+b+" in "+this);this.values[a]=b}else this.valuesById[this.values[a]=b]=a;return this.comments[a]=c||null,this},d.prototype.remove=function(a){if(!g.isString(a))throw TypeError("name must be a string");var b=this.values[a];if(null==b)throw Error("name '"+a+"' does not exist in "+this);return delete this.valuesById[b],delete this.values[a],delete this.comments[a],this},d.prototype.isReservedId=function(a){return f.isReservedId(this.reserved,a)},d.prototype.isReservedName=function(a){return f.isReservedName(this.reserved,a)}},function(a,b,c){"use strict";function d(a,b){if(!f.isString(a))throw TypeError("name must be a string");if(b&&!f.isObject(b))throw TypeError("options must be an object");this.options=b,this.name=a,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}a.exports=d,d.className="ReflectionObject";var e,f=c(100);Object.defineProperties(d.prototype,{root:{get:function(){for(var a=this;null!==a.parent;)a=a.parent;return a}},fullName:{get:function(){for(var a=[this.name],b=this.parent;b;)a.unshift(b.name),b=b.parent;return a.join(".")}}}),d.prototype.toJSON=function(){throw Error()},d.prototype.onAdd=function(a){this.parent&&this.parent!==a&&this.parent.remove(this),this.parent=a,this.resolved=!1;var b=a.root;b instanceof e&&b._handleAdd(this)},d.prototype.onRemove=function(a){var b=a.root;b instanceof e&&b._handleRemove(this),this.parent=null,this.resolved=!1},d.prototype.resolve=function(){return this.resolved?this:(this.root instanceof e&&(this.resolved=!0),this)},d.prototype.getOption=function(a){if(this.options)return this.options[a]},d.prototype.setOption=function(a,b,c){return c&&this.options&&void 0!==this.options[a]||((this.options||(this.options={}))[a]=b),this},d.prototype.setOptions=function(a,b){if(a)for(var c=Object.keys(a),d=0;d<c.length;++d)this.setOption(c[d],a[c[d]],b);return this},d.prototype.toString=function(){var a=this.constructor.className,b=this.fullName;return b.length?a+" "+b:a},d._configure=function(a){e=a}},function(a,b,c){"use strict";var d,e,f=a.exports=c(82),g=c(96);f.codegen=c(101),f.fetch=c(102),f.path=c(103),f.fs=f.inquire("fs"),f.toArray=function(a){if(a){for(var b=Object.keys(a),c=new Array(b.length),d=0;d<b.length;)c[d]=a[b[d++]];return c}return[]},f.toObject=function(a){for(var b={},c=0;c<a.length;){var d=a[c++],e=a[c++];void 0!==e&&(b[d]=e)}return b};var h=/\\/g,i=/"/g;f.isReserved=function(a){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(a)},f.safeProp=function(a){return!/^[$\w_]+$/.test(a)||f.isReserved(a)?'["'+a.replace(h,"\\\\").replace(i,'\\"')+'"]':"."+a},f.ucFirst=function(a){return a.charAt(0).toUpperCase()+a.substring(1)};var j=/_([a-z])/g;f.camelCase=function(a){return a.substring(0,1)+a.substring(1).replace(j,function(a,b){return b.toUpperCase()})},f.compareFieldsById=function(a,b){return a.id-b.id},f.decorateType=function(a,b){if(a.$type)return b&&a.$type.name!==b&&(f.decorateRoot.remove(a.$type),a.$type.name=b,f.decorateRoot.add(a.$type)),a.$type;d||(d=c(104));var e=new d(b||a.name);return f.decorateRoot.add(e),e.ctor=a,Object.defineProperty(a,"$type",{value:e,enumerable:!1}),Object.defineProperty(a.prototype,"$type",{value:e,enumerable:!1}),e};var k=0;f.decorateEnum=function(a){if(a.$type)return a.$type;e||(e=c(98));var b=new e("Enum"+k++,a);return f.decorateRoot.add(b),Object.defineProperty(a,"$type",{value:b,enumerable:!1}),b},Object.defineProperty(f,"decorateRoot",{get:function(){return g.decorated||(g.decorated=new(c(117)))}})},function(a,b){"use strict";function c(a,b){function d(a){if("string"!=typeof a){var b=e();if(c.verbose&&console.log("codegen: "+b),b="return "+b,a){for(var g=Object.keys(a),h=new Array(g.length+1),i=new Array(g.length),j=0;j<g.length;)h[j]=g[j],i[j]=a[g[j++]];return h[j]=b,Function.apply(null,h).apply(null,i)}return Function(b)()}for(var k=new Array(arguments.length-1),l=0;l<k.length;)k[l]=arguments[++l];if(l=0,a=a.replace(/%([%dfijs])/g,function(a,b){var c=k[l++];switch(b){case"d":case"f":return String(Number(c));case"i":return String(Math.floor(c));case"j":return JSON.stringify(c);case"s":return String(c)}return"%"}),
l!==k.length)throw Error("parameter count mismatch");return f.push(a),d}function e(c){return"function "+(c||b||"")+"("+(a&&a.join(",")||"")+"){\n  "+f.join("\n  ")+"\n}"}"string"==typeof a&&(b=a,a=void 0);var f=[];return d.toString=e,d}a.exports=c,c.verbose=!1},function(a,b,c){"use strict";function d(a,b,c){return"function"==typeof b?(c=b,b={}):b||(b={}),c?!b.xhr&&g&&g.readFile?g.readFile(a,function(e,f){return e&&"undefined"!=typeof XMLHttpRequest?d.xhr(a,b,c):e?c(e):c(null,b.binary?f:f.toString("utf8"))}):d.xhr(a,b,c):e(d,this,a,b)}a.exports=d;var e=c(83),f=c(87),g=f("fs");d.xhr=function(a,b,c){var d=new XMLHttpRequest;d.onreadystatechange=function(){if(4===d.readyState){if(0!==d.status&&200!==d.status)return c(Error("status "+d.status));if(b.binary){var a=d.response;if(!a){a=[];for(var e=0;e<d.responseText.length;++e)a.push(255&d.responseText.charCodeAt(e))}return c(null,"undefined"!=typeof Uint8Array?new Uint8Array(a):a)}return c(null,d.responseText)}},b.binary&&("overrideMimeType"in d&&d.overrideMimeType("text/plain; charset=x-user-defined"),d.responseType="arraybuffer"),d.open("GET",a),d.send()}},function(a,b){"use strict";var c=b,d=c.isAbsolute=function(a){return/^(?:\/|\w+:)/.test(a)},e=c.normalize=function(a){a=a.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var b=a.split("/"),c=d(a),e="";c&&(e=b.shift()+"/");for(var f=0;f<b.length;)".."===b[f]?f>0&&".."!==b[f-1]?b.splice(--f,2):c?b.splice(f,1):++f:"."===b[f]?b.splice(f,1):++f;return e+b.join("/")};c.resolve=function(a,b,c){return c||(b=e(b)),d(b)?b:(c||(a=e(a)),(a=a.replace(/(?:\/|^)[^\/]+$/,"")).length?e(a+"/"+b):b)}},function(a,b,c){"use strict";function d(a,b){f.call(this,a,b),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function e(a){return a._fieldsById=a._fieldsArray=a._oneofsArray=null,delete a.encode,delete a.decode,delete a.verify,a}a.exports=d;var f=c(105);((d.prototype=Object.create(f.prototype)).constructor=d).className="Type";var g=c(98),h=c(108),i=c(106),j=c(109),k=c(110),l=c(112),m=c(92),n=c(81),o=c(100),p=c(97),q=c(113),r=c(114),s=c(115),t=c(116);Object.defineProperties(d.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var a=Object.keys(this.fields),b=0;b<a.length;++b){var c=this.fields[a[b]],d=c.id;if(this._fieldsById[d])throw Error("duplicate id "+d+" in "+this);this._fieldsById[d]=c}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=o.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=o.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=d.generateConstructor(this)())},set:function(a){var b=a.prototype;b instanceof l||((a.prototype=new l).constructor=a,o.merge(a.prototype,b)),a.$type=a.prototype.$type=this,o.merge(a,l,!0),this._ctor=a;for(var c=0;c<this.fieldsArray.length;++c)this._fieldsArray[c].resolve();var d={};for(c=0;c<this.oneofsArray.length;++c)d[this._oneofsArray[c].resolve().name]={get:o.oneOfGetter(this._oneofsArray[c].oneof),set:o.oneOfSetter(this._oneofsArray[c].oneof)};c&&Object.defineProperties(a.prototype,d)}}}),d.generateConstructor=function(a){for(var b,c=o.codegen(["p"],a.name),d=0;d<a.fieldsArray.length;++d)(b=a._fieldsArray[d]).map?c("this%s={}",o.safeProp(b.name)):b.repeated&&c("this%s=[]",o.safeProp(b.name));return c("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},d.fromJSON=function(a,b){var c=new d(a,b.options);c.extensions=b.extensions,c.reserved=b.reserved;for(var e=Object.keys(b.fields),l=0;l<e.length;++l)c.add((void 0!==b.fields[e[l]].keyType?j.fromJSON:i.fromJSON)(e[l],b.fields[e[l]]));if(b.oneofs)for(e=Object.keys(b.oneofs),l=0;l<e.length;++l)c.add(h.fromJSON(e[l],b.oneofs[e[l]]));if(b.nested)for(e=Object.keys(b.nested),l=0;l<e.length;++l){var m=b.nested[e[l]];c.add((void 0!==m.id?i.fromJSON:void 0!==m.fields?d.fromJSON:void 0!==m.values?g.fromJSON:void 0!==m.methods?k.fromJSON:f.fromJSON)(e[l],m))}return b.extensions&&b.extensions.length&&(c.extensions=b.extensions),b.reserved&&b.reserved.length&&(c.reserved=b.reserved),b.group&&(c.group=!0),b.comment&&(c.comment=b.comment),c},d.prototype.toJSON=function(a){var b=f.prototype.toJSON.call(this,a),c=!!a&&Boolean(a.keepComments);return o.toObject(["options",b&&b.options||void 0,"oneofs",f.arrayToJSON(this.oneofsArray,a),"fields",f.arrayToJSON(this.fieldsArray.filter(function(a){return!a.declaringField}),a)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",b&&b.nested||void 0,"comment",c?this.comment:void 0])},d.prototype.resolveAll=function(){for(var a=this.fieldsArray,b=0;b<a.length;)a[b++].resolve();var c=this.oneofsArray;for(b=0;b<c.length;)c[b++].resolve();return f.prototype.resolveAll.call(this)},d.prototype.get=function(a){return this.fields[a]||this.oneofs&&this.oneofs[a]||this.nested&&this.nested[a]||null},d.prototype.add=function(a){if(this.get(a.name))throw Error("duplicate name '"+a.name+"' in "+this);if(a instanceof i&&void 0===a.extend){if(this._fieldsById?this._fieldsById[a.id]:this.fieldsById[a.id])throw Error("duplicate id "+a.id+" in "+this);if(this.isReservedId(a.id))throw Error("id "+a.id+" is reserved in "+this);if(this.isReservedName(a.name))throw Error("name '"+a.name+"' is reserved in "+this);return a.parent&&a.parent.remove(a),this.fields[a.name]=a,a.message=this,a.onAdd(this),e(this)}return a instanceof h?(this.oneofs||(this.oneofs={}),this.oneofs[a.name]=a,a.onAdd(this),e(this)):f.prototype.add.call(this,a)},d.prototype.remove=function(a){if(a instanceof i&&void 0===a.extend){if(!this.fields||this.fields[a.name]!==a)throw Error(a+" is not a member of "+this);return delete this.fields[a.name],a.parent=null,a.onRemove(this),e(this)}if(a instanceof h){if(!this.oneofs||this.oneofs[a.name]!==a)throw Error(a+" is not a member of "+this);return delete this.oneofs[a.name],a.parent=null,a.onRemove(this),e(this)}return f.prototype.remove.call(this,a)},d.prototype.isReservedId=function(a){return f.isReservedId(this.reserved,a)},d.prototype.isReservedName=function(a){return f.isReservedName(this.reserved,a)},d.prototype.create=function(a){return new this.ctor(a)},d.prototype.setup=function(){for(var a=this.fullName,b=[],c=0;c<this.fieldsArray.length;++c)b.push(this._fieldsArray[c].resolve().resolvedType);this.encode=p(this)({Writer:n,types:b,util:o}),this.decode=q(this)({Reader:m,types:b,util:o}),this.verify=r(this)({types:b,util:o}),this.fromObject=s.fromObject(this)({types:b,util:o}),this.toObject=s.toObject(this)({types:b,util:o});var d=t[a];if(d){var e=Object.create(this);e.fromObject=this.fromObject,this.fromObject=d.fromObject.bind(e),e.toObject=this.toObject,this.toObject=d.toObject.bind(e)}return this},d.prototype.encode=function(a,b){return this.setup().encode(a,b)},d.prototype.encodeDelimited=function(a,b){return this.encode(a,b&&b.len?b.fork():b).ldelim()},d.prototype.decode=function(a,b){return this.setup().decode(a,b)},d.prototype.decodeDelimited=function(a){return a instanceof m||(a=m.create(a)),this.decode(a,a.uint32())},d.prototype.verify=function(a){return this.setup().verify(a)},d.prototype.fromObject=function(a){return this.setup().fromObject(a)},d.prototype.toObject=function(a,b){return this.setup().toObject(a,b)},d.d=function(a){return function(b){o.decorateType(b,a)}}},function(a,b,c){"use strict";function d(a,b){if(a&&a.length){for(var c={},d=0;d<a.length;++d)c[a[d].name]=a[d].toJSON(b);return c}}function e(a,b){g.call(this,a,b),this.nested=void 0,this._nestedArray=null}function f(a){return a._nestedArray=null,a}a.exports=e;var g=c(99);((e.prototype=Object.create(g.prototype)).constructor=e).className="Namespace";var h,i,j,k=c(106),l=c(100);e.fromJSON=function(a,b){return new e(a,b.options).addJSON(b.nested)},e.arrayToJSON=d,e.isReservedId=function(a,b){if(a)for(var c=0;c<a.length;++c)if("string"!=typeof a[c]&&a[c][0]<=b&&a[c][1]>=b)return!0;return!1},e.isReservedName=function(a,b){if(a)for(var c=0;c<a.length;++c)if(a[c]===b)return!0;return!1},Object.defineProperty(e.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=l.toArray(this.nested))}}),e.prototype.toJSON=function(a){return l.toObject(["options",this.options,"nested",d(this.nestedArray,a)])},e.prototype.addJSON=function(a){var b=this;if(a)for(var c,d=Object.keys(a),f=0;f<d.length;++f)c=a[d[f]],b.add((void 0!==c.fields?h.fromJSON:void 0!==c.values?j.fromJSON:void 0!==c.methods?i.fromJSON:void 0!==c.id?k.fromJSON:e.fromJSON)(d[f],c));return this},e.prototype.get=function(a){return this.nested&&this.nested[a]||null},e.prototype.getEnum=function(a){if(this.nested&&this.nested[a]instanceof j)return this.nested[a].values;throw Error("no such enum: "+a)},e.prototype.add=function(a){if(!(a instanceof k&&void 0!==a.extend||a instanceof h||a instanceof j||a instanceof i||a instanceof e))throw TypeError("object must be a valid nested object");if(this.nested){var b=this.get(a.name);if(b){if(!(b instanceof e&&a instanceof e)||b instanceof h||b instanceof i)throw Error("duplicate name '"+a.name+"' in "+this);for(var c=b.nestedArray,d=0;d<c.length;++d)a.add(c[d]);this.remove(b),this.nested||(this.nested={}),a.setOptions(b.options,!0)}}else this.nested={};return this.nested[a.name]=a,a.onAdd(this),f(this)},e.prototype.remove=function(a){if(!(a instanceof g))throw TypeError("object must be a ReflectionObject");if(a.parent!==this)throw Error(a+" is not a member of "+this);return delete this.nested[a.name],Object.keys(this.nested).length||(this.nested=void 0),a.onRemove(this),f(this)},e.prototype.define=function(a,b){if(l.isString(a))a=a.split(".");else if(!Array.isArray(a))throw TypeError("illegal path");if(a&&a.length&&""===a[0])throw Error("path must be relative");for(var c=this;a.length>0;){var d=a.shift();if(c.nested&&c.nested[d]){if(!((c=c.nested[d])instanceof e))throw Error("path conflicts with non-namespace objects")}else c.add(c=new e(d))}return b&&c.addJSON(b),c},e.prototype.resolveAll=function(){for(var a=this.nestedArray,b=0;b<a.length;)a[b]instanceof e?a[b++].resolveAll():a[b++].resolve();return this.resolve()},e.prototype.lookup=function(a,b,c){if("boolean"==typeof b?(c=b,b=void 0):b&&!Array.isArray(b)&&(b=[b]),l.isString(a)&&a.length){if("."===a)return this.root;a=a.split(".")}else if(!a.length)return this;if(""===a[0])return this.root.lookup(a.slice(1),b);var d=this.get(a[0]);if(d){if(1===a.length){if(!b||b.indexOf(d.constructor)>-1)return d}else if(d instanceof e&&(d=d.lookup(a.slice(1),b,!0)))return d}else for(var f=0;f<this.nestedArray.length;++f)if(this._nestedArray[f]instanceof e&&(d=this._nestedArray[f].lookup(a,b,!0)))return d;return null===this.parent||c?null:this.parent.lookup(a,b)},e.prototype.lookupType=function(a){var b=this.lookup(a,[h]);if(!b)throw Error("no such type: "+a);return b},e.prototype.lookupEnum=function(a){var b=this.lookup(a,[j]);if(!b)throw Error("no such Enum '"+a+"' in "+this);return b},e.prototype.lookupTypeOrEnum=function(a){var b=this.lookup(a,[h,j]);if(!b)throw Error("no such Type or Enum '"+a+"' in "+this);return b},e.prototype.lookupService=function(a){var b=this.lookup(a,[i]);if(!b)throw Error("no such Service '"+a+"' in "+this);return b},e._configure=function(a,b,c){h=a,i=b,j=c}},function(a,b,c){"use strict";function d(a,b,c,d,f,g,k){if(i.isObject(d)?(k=f,g=d,d=f=void 0):i.isObject(f)&&(k=g,g=f,f=void 0),e.call(this,a,g),!i.isInteger(b)||b<0)throw TypeError("id must be a non-negative integer");if(!i.isString(c))throw TypeError("type must be a string");if(void 0!==d&&!j.test(d=d.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==f&&!i.isString(f))throw TypeError("extend must be a string");this.rule=d&&"optional"!==d?d:void 0,this.type=c,this.id=b,this.extend=f||void 0,this.required="required"===d,this.optional=!this.required,this.repeated="repeated"===d,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!i.Long&&void 0!==h.long[c],this.bytes="bytes"===c,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=k}a.exports=d;var e=c(99);((d.prototype=Object.create(e.prototype)).constructor=d).className="Field";var f,g=c(98),h=c(107),i=c(100),j=/^required|optional|repeated$/;d.fromJSON=function(a,b){return new d(a,b.id,b.type,b.rule,b.extend,b.options,b.comment)},Object.defineProperty(d.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),d.prototype.setOption=function(a,b,c){return"packed"===a&&(this._packed=null),e.prototype.setOption.call(this,a,b,c)},d.prototype.toJSON=function(a){var b=!!a&&Boolean(a.keepComments);return i.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",b?this.comment:void 0])},d.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=h.defaults[this.type])&&(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof f?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof g&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof g)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=i.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var a;i.base64.test(this.typeDefault)?i.base64.decode(this.typeDefault,a=i.newBuffer(i.base64.length(this.typeDefault)),0):i.utf8.write(this.typeDefault,a=i.newBuffer(i.utf8.length(this.typeDefault)),0),this.typeDefault=a}return this.map?this.defaultValue=i.emptyObject:this.repeated?this.defaultValue=i.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof f&&(this.parent.ctor.prototype[this.name]=this.defaultValue),e.prototype.resolve.call(this)},d.d=function(a,b,c,e){return"function"==typeof b?b=i.decorateType(b).name:b&&"object"==typeof b&&(b=i.decorateEnum(b).name),function(f,g){i.decorateType(f.constructor).add(new d(g,a,b,c,{default:e}))}},d._configure=function(a){f=a}},function(a,b,c){"use strict";function d(a,b){var c=0,d={};for(b|=0;c<a.length;)d[g[c+b]]=a[c++];return d}var e=b,f=c(100),g=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];e.basic=d([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),e.defaults=d([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",f.emptyArray,null]),e.long=d([0,0,0,1,1],7),e.mapKey=d([0,0,0,5,5,0,0,0,1,1,0,2],2),e.packed=d([1,5,0,0,0,5,5,0,0,0,1,1,0])},function(a,b,c){"use strict";function d(a,b,c,d){if(Array.isArray(b)||(c=b,b=void 0),f.call(this,a,c),void 0!==b&&!Array.isArray(b))throw TypeError("fieldNames must be an Array");this.oneof=b||[],this.fieldsArray=[],this.comment=d}function e(a){if(a.parent)for(var b=0;b<a.fieldsArray.length;++b)a.fieldsArray[b].parent||a.parent.add(a.fieldsArray[b])}a.exports=d;var f=c(99);((d.prototype=Object.create(f.prototype)).constructor=d).className="OneOf";var g=c(106),h=c(100);d.fromJSON=function(a,b){return new d(a,b.oneof,b.options,b.comment)},d.prototype.toJSON=function(a){var b=!!a&&Boolean(a.keepComments);return h.toObject(["options",this.options,"oneof",this.oneof,"comment",b?this.comment:void 0])},d.prototype.add=function(a){if(!(a instanceof g))throw TypeError("field must be a Field");return a.parent&&a.parent!==this.parent&&a.parent.remove(a),this.oneof.push(a.name),this.fieldsArray.push(a),a.partOf=this,e(this),this},d.prototype.remove=function(a){if(!(a instanceof g))throw TypeError("field must be a Field");var b=this.fieldsArray.indexOf(a);if(b<0)throw Error(a+" is not a member of "+this);return this.fieldsArray.splice(b,1),b=this.oneof.indexOf(a.name),b>-1&&this.oneof.splice(b,1),a.partOf=null,this},d.prototype.onAdd=function(a){f.prototype.onAdd.call(this,a);for(var b=this,c=0;c<this.oneof.length;++c){var d=a.get(this.oneof[c]);d&&!d.partOf&&(d.partOf=b,b.fieldsArray.push(d))}e(this)},d.prototype.onRemove=function(a){for(var b,c=0;c<this.fieldsArray.length;++c)(b=this.fieldsArray[c]).parent&&b.parent.remove(b);f.prototype.onRemove.call(this,a)},d.d=function(){for(var a=new Array(arguments.length),b=0;b<arguments.length;)a[b]=arguments[b++];return function(b,c){h.decorateType(b.constructor).add(new d(c,a)),Object.defineProperty(b,c,{get:h.oneOfGetter(a),set:h.oneOfSetter(a)})}}},function(a,b,c){"use strict";function d(a,b,c,d,f,h){if(e.call(this,a,b,d,void 0,void 0,f,h),!g.isString(c))throw TypeError("keyType must be a string");this.keyType=c,this.resolvedKeyType=null,this.map=!0}a.exports=d;var e=c(106);((d.prototype=Object.create(e.prototype)).constructor=d).className="MapField";var f=c(107),g=c(100);d.fromJSON=function(a,b){return new d(a,b.id,b.keyType,b.type,b.options,b.comment)},d.prototype.toJSON=function(a){var b=!!a&&Boolean(a.keepComments);return g.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",b?this.comment:void 0])},d.prototype.resolve=function(){if(this.resolved)return this;if(void 0===f.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return e.prototype.resolve.call(this)},d.d=function(a,b,c){return"function"==typeof c?c=g.decorateType(c).name:c&&"object"==typeof c&&(c=g.decorateEnum(c).name),function(e,f){g.decorateType(e.constructor).add(new d(f,a,b,c))}}},function(a,b,c){"use strict";function d(a,b){f.call(this,a,b),this.methods={},this._methodsArray=null}function e(a){return a._methodsArray=null,a}a.exports=d;var f=c(105);((d.prototype=Object.create(f.prototype)).constructor=d).className="Service";var g=c(111),h=c(100),i=c(94);d.fromJSON=function(a,b){var c=new d(a,b.options);if(b.methods)for(var e=Object.keys(b.methods),f=0;f<e.length;++f)c.add(g.fromJSON(e[f],b.methods[e[f]]));return b.nested&&c.addJSON(b.nested),c.comment=b.comment,c},d.prototype.toJSON=function(a){var b=f.prototype.toJSON.call(this,a),c=!!a&&Boolean(a.keepComments);return h.toObject(["options",b&&b.options||void 0,"methods",f.arrayToJSON(this.methodsArray,a)||{},"nested",b&&b.nested||void 0,"comment",c?this.comment:void 0])},Object.defineProperty(d.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=h.toArray(this.methods))}}),d.prototype.get=function(a){return this.methods[a]||f.prototype.get.call(this,a)},d.prototype.resolveAll=function(){for(var a=this.methodsArray,b=0;b<a.length;++b)a[b].resolve();return f.prototype.resolve.call(this)},d.prototype.add=function(a){if(this.get(a.name))throw Error("duplicate name '"+a.name+"' in "+this);return a instanceof g?(this.methods[a.name]=a,a.parent=this,e(this)):f.prototype.add.call(this,a)},d.prototype.remove=function(a){if(a instanceof g){if(this.methods[a.name]!==a)throw Error(a+" is not a member of "+this);return delete this.methods[a.name],a.parent=null,e(this)}return f.prototype.remove.call(this,a)},d.prototype.create=function(a,b,c){for(var d,e=new i.Service(a,b,c),f=0;f<this.methodsArray.length;++f){var g=h.lcFirst((d=this._methodsArray[f]).resolve().name).replace(/[^$\w_]/g,"");e[g]=h.codegen(["r","c"],h.isReserved(g)?g+"_":g)("return this.rpcCall(m,q,s,r,c)")({m:d,q:d.resolvedRequestType.ctor,s:d.resolvedResponseType.ctor})}return e}},function(a,b,c){"use strict";function d(a,b,c,d,g,h,i,j){if(f.isObject(g)?(i=g,g=h=void 0):f.isObject(h)&&(i=h,h=void 0),void 0!==b&&!f.isString(b))throw TypeError("type must be a string");if(!f.isString(c))throw TypeError("requestType must be a string");if(!f.isString(d))throw TypeError("responseType must be a string");e.call(this,a,i),this.type=b||"rpc",this.requestType=c,this.requestStream=!!g||void 0,this.responseType=d,this.responseStream=!!h||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=j}a.exports=d;var e=c(99);((d.prototype=Object.create(e.prototype)).constructor=d).className="Method";var f=c(100);d.fromJSON=function(a,b){return new d(a,b.type,b.requestType,b.responseType,b.requestStream,b.responseStream,b.options,b.comment)},d.prototype.toJSON=function(a){var b=!!a&&Boolean(a.keepComments);return f.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",b?this.comment:void 0])},d.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),e.prototype.resolve.call(this))}},function(a,b,c){"use strict";function d(a){if(a)for(var b=Object.keys(a),c=0;c<b.length;++c)this[b[c]]=a[b[c]]}a.exports=d;var e=c(82);d.create=function(a){return this.$type.create(a)},d.encode=function(a,b){return this.$type.encode(a,b)},d.encodeDelimited=function(a,b){return this.$type.encodeDelimited(a,b)},d.decode=function(a){return this.$type.decode(a)},d.decodeDelimited=function(a){return this.$type.decodeDelimited(a)},d.verify=function(a){return this.$type.verify(a)},d.fromObject=function(a){return this.$type.fromObject(a)},d.toObject=function(a,b){return this.$type.toObject(a,b)},d.prototype.toJSON=function(){return this.$type.toObject(this,e.toJSONOptions)}},function(a,b,c){"use strict";function d(a){return"missing required '"+a.name+"'"}function e(a){var b=h.codegen(["r","l"],a.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(a.fieldsArray.filter(function(a){return a.map}).length?",k":""))("while(r.pos<c){")("var t=r.uint32()");a.group&&b("if((t&7)===4)")("break"),b("switch(t>>>3){");for(var c=0;c<a.fieldsArray.length;++c){var e=a._fieldsArray[c].resolve(),i=e.resolvedType instanceof f?"int32":e.type,j="m"+h.safeProp(e.name);b("case %i:",e.id),e.map?(b("r.skip().pos++")("if(%s===util.emptyObject)",j)("%s={}",j)("k=r.%s()",e.keyType)("r.pos++"),void 0!==g.long[e.keyType]?void 0===g.basic[i]?b('%s[typeof k==="object"?util.longToHash(k):k]=types[%i].decode(r,r.uint32())',j,c):b('%s[typeof k==="object"?util.longToHash(k):k]=r.%s()',j,i):void 0===g.basic[i]?b("%s[k]=types[%i].decode(r,r.uint32())",j,c):b("%s[k]=r.%s()",j,i)):e.repeated?(b("if(!(%s&&%s.length))",j,j)("%s=[]",j),void 0!==g.packed[i]&&b("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",j,i)("}else"),void 0===g.basic[i]?b(e.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",j,c):b("%s.push(r.%s())",j,i)):void 0===g.basic[i]?b(e.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",j,c):b("%s=r.%s()",j,i),b("break")}for(b("default:")("r.skipType(t&7)")("break")("}")("}"),c=0;c<a._fieldsArray.length;++c){var k=a._fieldsArray[c];k.required&&b("if(!m.hasOwnProperty(%j))",k.name)("throw util.ProtocolError(%j,{instance:m})",d(k))}return b("return m")}a.exports=e;var f=c(98),g=c(107),h=c(100)},function(a,b,c){"use strict";function d(a,b){return a.name+": "+b+(a.repeated&&"array"!==b?"[]":a.map&&"object"!==b?"{k:"+a.keyType+"}":"")+" expected"}function e(a,b,c,e){if(b.resolvedType)if(b.resolvedType instanceof h){a("switch(%s){",e)("default:")("return%j",d(b,"enum value"));for(var f=Object.keys(b.resolvedType.values),g=0;g<f.length;++g)a("case %i:",b.resolvedType.values[f[g]]);a("break")("}")}else a("{")("var e=types[%i].verify(%s);",c,e)("if(e)")("return%j+e",b.name+".")("}");else switch(b.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":a("if(!util.isInteger(%s))",e)("return%j",d(b,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":a("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",e,e,e,e)("return%j",d(b,"integer|Long"));break;case"float":case"double":a('if(typeof %s!=="number")',e)("return%j",d(b,"number"));break;case"bool":a('if(typeof %s!=="boolean")',e)("return%j",d(b,"boolean"));break;case"string":a("if(!util.isString(%s))",e)("return%j",d(b,"string"));break;case"bytes":a('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',e,e,e)("return%j",d(b,"buffer"))}return a}function f(a,b,c){switch(b.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":a("if(!util.key32Re.test(%s))",c)("return%j",d(b,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":a("if(!util.key64Re.test(%s))",c)("return%j",d(b,"integer|Long key"));break;case"bool":a("if(!util.key2Re.test(%s))",c)("return%j",d(b,"boolean key"))}return a}function g(a){var b=i.codegen(["m"],a.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),c=a.oneofsArray,g={};c.length&&b("var p={}");for(var h=0;h<a.fieldsArray.length;++h){var j=a._fieldsArray[h].resolve(),k="m"+i.safeProp(j.name);if(j.optional&&b("if(%s!=null&&m.hasOwnProperty(%j)){",k,j.name),j.map)b("if(!util.isObject(%s))",k)("return%j",d(j,"object"))("var k=Object.keys(%s)",k)("for(var i=0;i<k.length;++i){"),f(b,j,"k[i]"),e(b,j,h,k+"[k[i]]")("}");else if(j.repeated)b("if(!Array.isArray(%s))",k)("return%j",d(j,"array"))("for(var i=0;i<%s.length;++i){",k),e(b,j,h,k+"[i]")("}");else{if(j.partOf){var l=i.safeProp(j.partOf.name);1===g[j.partOf.name]&&b("if(p%s===1)",l)("return%j",j.partOf.name+": multiple values"),g[j.partOf.name]=1,b("p%s=1",l)}e(b,j,h,k)}j.optional&&b("}")}return b("return null")}a.exports=g;var h=c(98),i=c(100)},function(a,b,c){"use strict";function d(a,b,c,d){if(b.resolvedType)if(b.resolvedType instanceof g){a("switch(d%s){",d);for(var e=b.resolvedType.values,f=Object.keys(e),h=0;h<f.length;++h)b.repeated&&e[f[h]]===b.typeDefault&&a("default:"),a("case%j:",f[h])("case %i:",e[f[h]])("m%s=%j",d,e[f[h]])("break");a("}")}else a('if(typeof d%s!=="object")',d)("throw TypeError(%j)",b.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",d,c,d);else{var i=!1;switch(b.type){case"double":case"float":a("m%s=Number(d%s)",d,d);break;case"uint32":case"fixed32":a("m%s=d%s>>>0",d,d);break;case"int32":case"sint32":case"sfixed32":a("m%s=d%s|0",d,d);break;case"uint64":i=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":a("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",d,d,i)('else if(typeof d%s==="string")',d)("m%s=parseInt(d%s,10)",d,d)('else if(typeof d%s==="number")',d)("m%s=d%s",d,d)('else if(typeof d%s==="object")',d)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",d,d,d,i?"true":"");break;case"bytes":a('if(typeof d%s==="string")',d)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",d,d,d)("else if(d%s.length)",d)("m%s=d%s",d,d);break;case"string":a("m%s=String(d%s)",d,d);break;case"bool":a("m%s=Boolean(d%s)",d,d)}}return a}function e(a,b,c,d){if(b.resolvedType)b.resolvedType instanceof g?a("d%s=o.enums===String?types[%i].values[m%s]:m%s",d,c,d,d):a("d%s=types[%i].toObject(m%s,o)",d,c,d);else{var e=!1;switch(b.type){case"double":case"float":a("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",d,d,d,d);break;case"uint64":e=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":a('if(typeof m%s==="number")',d)("d%s=o.longs===String?String(m%s):m%s",d,d,d)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",d,d,d,d,e?"true":"",d);break;case"bytes":a("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",d,d,d,d,d);break;default:a("d%s=m%s",d,d)}}return a}var f=b,g=c(98),h=c(100);f.fromObject=function(a){var b=a.fieldsArray,c=h.codegen(["d"],a.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!b.length)return c("return new this.ctor");c("var m=new this.ctor");for(var e=0;e<b.length;++e){var f=b[e].resolve(),i=h.safeProp(f.name);f.map?(c("if(d%s){",i)('if(typeof d%s!=="object")',i)("throw TypeError(%j)",f.fullName+": object expected")("m%s={}",i)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",i),d(c,f,e,i+"[ks[i]]")("}")("}")):f.repeated?(c("if(d%s){",i)("if(!Array.isArray(d%s))",i)("throw TypeError(%j)",f.fullName+": array expected")("m%s=[]",i)("for(var i=0;i<d%s.length;++i){",i),d(c,f,e,i+"[i]")("}")("}")):(f.resolvedType instanceof g||c("if(d%s!=null){",i),d(c,f,e,i),f.resolvedType instanceof g||c("}"))}return c("return m")},f.toObject=function(a){var b=a.fieldsArray.slice().sort(h.compareFieldsById);if(!b.length)return h.codegen()("return {}");for(var c=h.codegen(["m","o"],a.name+"$toObject")("if(!o)")("o={}")("var d={}"),d=[],f=[],i=[],j=0;j<b.length;++j)b[j].partOf||(b[j].resolve().repeated?d:b[j].map?f:i).push(b[j]);if(d.length){for(c("if(o.arrays||o.defaults){"),j=0;j<d.length;++j)c("d%s=[]",h.safeProp(d[j].name));c("}")}if(f.length){for(c("if(o.objects||o.defaults){"),j=0;j<f.length;++j)c("d%s={}",h.safeProp(f[j].name));c("}")}if(i.length){for(c("if(o.defaults){"),j=0;j<i.length;++j){var k=i[j],l=h.safeProp(k.name);if(k.resolvedType instanceof g)c("d%s=o.enums===String?%j:%j",l,k.resolvedType.valuesById[k.typeDefault],k.typeDefault);else if(k.long)c("if(util.Long){")("var n=new util.Long(%i,%i,%j)",k.typeDefault.low,k.typeDefault.high,k.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",l)("}else")("d%s=o.longs===String?%j:%i",l,k.typeDefault.toString(),k.typeDefault.toNumber());else if(k.bytes){var m="["+Array.prototype.slice.call(k.typeDefault).join(",")+"]";c("if(o.bytes===String)d%s=%j",l,String.fromCharCode.apply(String,k.typeDefault))("else{")("d%s=%s",l,m)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",l,l)("}")}else c("d%s=%j",l,k.typeDefault)}c("}")}var n=!1;for(j=0;j<b.length;++j){var k=b[j],o=a._fieldsArray.indexOf(k),l=h.safeProp(k.name);k.map?(n||(n=!0,c("var ks2")),c("if(m%s&&(ks2=Object.keys(m%s)).length){",l,l)("d%s={}",l)("for(var j=0;j<ks2.length;++j){"),e(c,k,o,l+"[ks2[j]]")("}")):k.repeated?(c("if(m%s&&m%s.length){",l,l)("d%s=[]",l)("for(var j=0;j<m%s.length;++j){",l),e(c,k,o,l+"[j]")("}")):(c("if(m%s!=null&&m.hasOwnProperty(%j)){",l,k.name),e(c,k,o,l),k.partOf&&c("if(o.oneofs)")("d%s=%j",h.safeProp(k.partOf.name),k.name)),c("}")}return c("return d")}},function(a,b,c){"use strict";var d=b,e=c(112);d[".google.protobuf.Any"]={fromObject:function(a){if(a&&a["@type"]){var b=this.lookup(a["@type"]);if(b){var c="."===a["@type"].charAt(0)?a["@type"].substr(1):a["@type"];return this.create({type_url:"/"+c,value:b.encode(b.fromObject(a)).finish()})}}return this.fromObject(a)},toObject:function(a,b){if(b&&b.json&&a.type_url&&a.value){var c=a.type_url.substring(a.type_url.lastIndexOf("/")+1),d=this.lookup(c);d&&(a=d.decode(a.value))}if(!(a instanceof this.ctor)&&a instanceof e){var f=a.$type.toObject(a,b);return f["@type"]=a.$type.fullName,f}return this.toObject(a,b)}}},function(a,b,c){"use strict";function d(a){g.call(this,"",a),this.deferred=[],this.files=[]}function e(){}function f(a,b){var c=b.parent.lookup(b.extend);if(c){var d=new k(b.fullName,b.id,b.type,b.rule,void 0,b.options);return d.declaringField=b,b.extensionField=d,c.add(d),!0}return!1}a.exports=d;var g=c(105);((d.prototype=Object.create(g.prototype)).constructor=d).className="Root";var h,i,j,k=c(106),l=c(98),m=c(108),n=c(100);d.fromJSON=function(a,b){return b||(b=new d),a.options&&b.setOptions(a.options),
b.addJSON(a.nested)},d.prototype.resolvePath=n.path.resolve,d.prototype.load=function a(b,c,d){function f(a,b){if(d){var c=d;if(d=null,l)throw a;c(a,b)}}function g(a,b){try{if(n.isString(b)&&"{"===b.charAt(0)&&(b=JSON.parse(b)),n.isString(b)){i.filename=a;var d,e=i(b,k,c),g=0;if(e.imports)for(;g<e.imports.length;++g)(d=k.resolvePath(a,e.imports[g]))&&h(d);if(e.weakImports)for(g=0;g<e.weakImports.length;++g)(d=k.resolvePath(a,e.weakImports[g]))&&h(d,!0)}else k.setOptions(b.options).addJSON(b.nested)}catch(a){f(a)}l||m||f(null,k)}function h(a,b){var c=a.lastIndexOf("google/protobuf/");if(c>-1){var e=a.substring(c);e in j&&(a=e)}if(!(k.files.indexOf(a)>-1)){if(k.files.push(a),a in j)return void(l?g(a,j[a]):(++m,setTimeout(function(){--m,g(a,j[a])})));if(l){var h;try{h=n.fs.readFileSync(a).toString("utf8")}catch(a){return void(b||f(a))}g(a,h)}else++m,n.fetch(a,function(c,e){if(--m,d)return c?void(b?m||f(null,k):f(c)):void g(a,e)})}}"function"==typeof c&&(d=c,c=void 0);var k=this;if(!d)return n.asPromise(a,k,b,c);var l=d===e,m=0;n.isString(b)&&(b=[b]);for(var o,p=0;p<b.length;++p)(o=k.resolvePath("",b[p]))&&h(o);if(l)return k;m||f(null,k)},d.prototype.loadSync=function(a,b){if(!n.isNode)throw Error("not supported");return this.load(a,b,e)},d.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(a){return"'extend "+a.extend+"' in "+a.parent.fullName}).join(", "));return g.prototype.resolveAll.call(this)};var o=/^[A-Z]/;d.prototype._handleAdd=function(a){if(a instanceof k)void 0===a.extend||a.extensionField||f(this,a)||this.deferred.push(a);else if(a instanceof l)o.test(a.name)&&(a.parent[a.name]=a.values);else if(!(a instanceof m)){if(a instanceof h)for(var b=0;b<this.deferred.length;)f(this,this.deferred[b])?this.deferred.splice(b,1):++b;for(var c=0;c<a.nestedArray.length;++c)this._handleAdd(a._nestedArray[c]);o.test(a.name)&&(a.parent[a.name]=a)}},d.prototype._handleRemove=function(a){if(a instanceof k){if(void 0!==a.extend)if(a.extensionField)a.extensionField.parent.remove(a.extensionField),a.extensionField=null;else{var b=this.deferred.indexOf(a);b>-1&&this.deferred.splice(b,1)}}else if(a instanceof l)o.test(a.name)&&delete a.parent[a.name];else if(a instanceof g){for(var c=0;c<a.nestedArray.length;++c)this._handleRemove(a._nestedArray[c]);o.test(a.name)&&delete a.parent[a.name]}},d._configure=function(a,b,c){h=a,i=b,j=c}},function(a,b){"use strict";function c(a){return a.replace(l,function(a,b){switch(b){case"\\":case"":return b;default:return m[b]||""}})}function d(a,b){function d(a){return Error("illegal "+a+" (line "+x+")")}function l(){var b="'"===D?g:f;b.lastIndex=v-1;var e=b.exec(a);if(!e)throw d("string");return v=b.lastIndex,r(D),D=null,c(e[1])}function m(b){return a.charAt(b)}function n(c,d){y=a.charAt(c++),A=x,B=!1;var e;e=b?2:3;var f,g=c-e;do{if(--g<0||"\n"===(f=a.charAt(g))){B=!0;break}}while(" "===f||"\t"===f);for(var k=a.substring(c,d).split(j),l=0;l<k.length;++l)k[l]=k[l].replace(b?i:h,"").trim();z=k.join("\n").trim()}function o(b){var c=p(b);return/^\s*\/{1,2}/.test(a.substring(b,c))}function p(a){for(var b=a;b<w&&"\n"!==m(b);)b++;return b}function q(){if(C.length>0)return C.shift();if(D)return l();var c,f,g,h,i;do{if(v===w)return null;for(c=!1;k.test(g=m(v));)if("\n"===g&&++x,++v===w)return null;if("/"===m(v)){if(++v===w)throw d("comment");if("/"===m(v))if(b){if(h=v,i=!1,o(v)){i=!0;do{if((v=p(v))===w)break;v++}while(o(v))}else v=Math.min(w,p(v)+1);i&&n(h,v),x++,c=!0}else{for(i="/"===m(h=v+1);"\n"!==m(++v);)if(v===w)return null;++v,i&&n(h,v-1),++x,c=!0}else{if("*"!==(g=m(v)))return"/";h=v+1,i=b||"*"===m(h);do{if("\n"===g&&++x,++v===w)throw d("comment");f=g,g=m(v)}while("*"!==f||"/"!==g);++v,i&&n(h,v-2),c=!0}}}while(c);var j=v;if(e.lastIndex=0,!e.test(m(j++)))for(;j<w&&!e.test(m(j));)++j;var q=a.substring(v,v=j);return'"'!==q&&"'"!==q||(D=q),q}function r(a){C.push(a)}function s(){if(!C.length){var a=q();if(null===a)return null;r(a)}return C[0]}function t(a,b){var c=s();if(c===a)return q(),!0;if(!b)throw d("token '"+c+"', '"+a+"' expected");return!1}function u(a){var c=null;return void 0===a?A===x-1&&(b||"*"===y||B)&&(c=z):(A<a&&s(),A!==a||B||!b&&"/"!==y||(c=z)),c}a=a.toString();var v=0,w=a.length,x=1,y=null,z=null,A=0,B=!1,C=[],D=null;return Object.defineProperty({next:q,peek:s,push:r,skip:t,cmnt:u},"line",{get:function(){return x}})}a.exports=d;var e=/[\s{}=;:[\],'"()<>]/g,f=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,g=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,h=/^ *[*\/]+ */,i=/^\s*\*?\/*/,j=/\n/g,k=/\s/,l=/\\(.?)/g,m={0:"\0",r:"\r",n:"\n",t:"\t"};d.unescape=c},function(a,b,c){"use strict";function d(a,b,c){function z(a,b,c){var e=d.filename;return c||(d.filename=null),Error("illegal "+(b||"token")+" '"+a+"' ("+(e?e+", ":"")+"line "+$.line+")")}function A(){var a,b=[];do{if('"'!==(a=_())&&"'"!==a)throw z(a);b.push(_()),ca(a),a=ba()}while('"'===a||"'"===a);return b.join("")}function B(a){var b=_();switch(b){case"'":case'"':return aa(b),A();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return D(b,!0)}catch(c){if(a&&x.test(b))return b;throw z(b,"value")}}function C(a,b){var c,d;do{!b||'"'!==(c=ba())&&"'"!==c?a.push([d=E(_()),ca("to",!0)?E(_()):d]):a.push(A())}while(ca(",",!0));ca(";")}function D(a,b){var c=1;switch("-"===a.charAt(0)&&(c=-1,a=a.substring(1)),a){case"inf":case"INF":case"Inf":return c*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(p.test(a))return c*parseInt(a,10);if(r.test(a))return c*parseInt(a,16);if(t.test(a))return c*parseInt(a,8);if(v.test(a))return c*parseFloat(a);throw z(a,"number",b)}function E(a,b){switch(a){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!b&&"-"===a.charAt(0))throw z(a,"id");if(q.test(a))return parseInt(a,10);if(s.test(a))return parseInt(a,16);if(u.test(a))return parseInt(a,8);throw z(a,"id")}function F(a,b){switch(b){case"option":return O(a,b),ca(";"),!0;case"message":return H(a,b),!0;case"enum":return M(a,b),!0;case"service":return S(a,b),!0;case"extend":return U(a,b),!0}return!1}function G(a,b,c){var e=$.line;if(a&&(a.comment=da(),a.filename=d.filename),ca("{",!0)){for(var f;"}"!==(f=_());)b(f);ca(";",!0)}else c&&c(),ca(";"),a&&"string"!=typeof a.comment&&(a.comment=da(e))}function H(a,b){if(!w.test(b=_()))throw z(b,"type name");var c=new g(b);G(c,function(a){if(!F(c,a))switch(a){case"map":K(c);break;case"required":case"optional":case"repeated":I(c,a);break;case"oneof":L(c,a);break;case"extensions":C(c.extensions||(c.extensions=[]));break;case"reserved":C(c.reserved||(c.reserved=[]),!0);break;default:if(!fa||!x.test(a))throw z(a);aa(a),I(c,"optional")}}),a.add(c)}function I(a,b,c){var d=_();if("group"===d)return void J(a,b);if(!x.test(d))throw z(d,"type");var e=_();if(!w.test(e))throw z(e,"name");e=ha(e),ca("=");var f=new h(e,E(_()),d,b,c);G(f,function(a){if("option"!==a)throw z(a);O(f,a),ca(";")},function(){R(f)}),a.add(f),fa||!f.repeated||void 0===n.packed[d]&&void 0!==n.basic[d]||f.setOption("packed",!1,!0)}function J(a,b){var c=_();if(!w.test(c))throw z(c,"name");var e=o.lcFirst(c);c===e&&(c=o.ucFirst(c)),ca("=");var f=E(_()),i=new g(c);i.group=!0;var j=new h(e,f,c,b);j.filename=d.filename,G(i,function(a){switch(a){case"option":O(i,a),ca(";");break;case"required":case"optional":case"repeated":I(i,a);break;default:throw z(a)}}),a.add(i).add(j)}function K(a){ca("<");var b=_();if(void 0===n.mapKey[b])throw z(b,"type");ca(",");var c=_();if(!x.test(c))throw z(c,"type");ca(">");var d=_();if(!w.test(d))throw z(d,"name");ca("=");var e=new i(ha(d),E(_()),b,c);G(e,function(a){if("option"!==a)throw z(a);O(e,a),ca(";")},function(){R(e)}),a.add(e)}function L(a,b){if(!w.test(b=_()))throw z(b,"name");var c=new j(ha(b));G(c,function(a){"option"===a?(O(c,a),ca(";")):(aa(a),I(c,"optional"))}),a.add(c)}function M(a,b){if(!w.test(b=_()))throw z(b,"name");var c=new k(b);G(c,function(a){switch(a){case"option":O(c,a),ca(";");break;case"reserved":C(c.reserved||(c.reserved=[]),!0);break;default:N(c,a)}}),a.add(c)}function N(a,b){if(!w.test(b))throw z(b,"name");ca("=");var c=E(_(),!0),d={};G(d,function(a){if("option"!==a)throw z(a);O(d,a),ca(";")},function(){R(d)}),a.add(b,c,d.comment)}function O(a,b){var c=ca("(",!0);if(!x.test(b=_()))throw z(b,"name");var d=b;c&&(ca(")"),d="("+d+")",b=ba(),y.test(b)&&(d+=b,_())),ca("="),P(a,d)}function P(a,b){if(ca("{",!0))do{if(!w.test(Z=_()))throw z(Z,"name");"{"===ba()?P(a,b+"."+Z):(ca(":"),"{"===ba()?P(a,b+"."+Z):Q(a,b+"."+Z,B(!0))),ca(",",!0)}while(!ca("}",!0));else Q(a,b,B(!0))}function Q(a,b,c){a.setOption&&a.setOption(b,c)}function R(a){if(ca("[",!0)){do{O(a,"option")}while(ca(",",!0));ca("]")}return a}function S(a,b){if(!w.test(b=_()))throw z(b,"service name");var c=new l(b);G(c,function(a){if(!F(c,a)){if("rpc"!==a)throw z(a);T(c,a)}}),a.add(c)}function T(a,b){var c=b;if(!w.test(b=_()))throw z(b,"name");var d,e,f,g,h=b;if(ca("("),ca("stream",!0)&&(e=!0),!x.test(b=_()))throw z(b);if(d=b,ca(")"),ca("returns"),ca("("),ca("stream",!0)&&(g=!0),!x.test(b=_()))throw z(b);f=b,ca(")");var i=new m(h,c,d,f,e,g);G(i,function(a){if("option"!==a)throw z(a);O(i,a),ca(";")}),a.add(i)}function U(a,b){if(!x.test(b=_()))throw z(b,"reference");var c=b;G(null,function(b){switch(b){case"required":case"repeated":case"optional":I(a,b,c);break;default:if(!fa||!x.test(b))throw z(b);aa(b),I(a,"optional",c)}})}b instanceof f||(c=b,b=new f),c||(c=d.defaults);for(var V,W,X,Y,Z,$=e(a,c.alternateCommentMode||!1),_=$.next,aa=$.push,ba=$.peek,ca=$.skip,da=$.cmnt,ea=!0,fa=!1,ga=b,ha=c.keepCase?function(a){return a}:o.camelCase;null!==(Z=_());)switch(Z){case"package":if(!ea)throw z(Z);!function(){if(void 0!==V)throw z("package");if(V=_(),!x.test(V))throw z(V,"name");ga=ga.define(V),ca(";")}();break;case"import":if(!ea)throw z(Z);!function(){var a,b=ba();switch(b){case"weak":a=X||(X=[]),_();break;case"public":_();default:a=W||(W=[])}b=A(),ca(";"),a.push(b)}();break;case"syntax":if(!ea)throw z(Z);!function(){if(ca("="),Y=A(),!(fa="proto3"===Y)&&"proto2"!==Y)throw z(Y,"syntax");ca(";")}();break;case"option":if(!ea)throw z(Z);O(ga,Z),ca(";");break;default:if(F(ga,Z)){ea=!1;continue}throw z(Z)}return d.filename=null,{package:V,imports:W,weakImports:X,syntax:Y,root:b}}a.exports=d,d.filename=null,d.defaults={keepCase:!1};var e=c(118),f=c(117),g=c(104),h=c(106),i=c(109),j=c(108),k=c(98),l=c(110),m=c(111),n=c(107),o=c(100),p=/^[1-9][0-9]*$/,q=/^-?[1-9][0-9]*$/,r=/^0[x][0-9a-fA-F]+$/,s=/^-?0[x][0-9a-fA-F]+$/,t=/^0[0-7]+$/,u=/^-?0[0-7]+$/,v=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,w=/^[a-zA-Z_][a-zA-Z_0-9]*$/,x=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,y=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/},function(a,b){"use strict";function c(a,b){d.test(a)||(a="google/protobuf/"+a+".proto",b={nested:{google:{nested:{protobuf:{nested:b}}}}}),c[a]=b}a.exports=c;var d=/\/|\./;c("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var e;c("duration",{Duration:e={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),c("timestamp",{Timestamp:e}),c("empty",{Empty:{fields:{}}}),c("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),c("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),c("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),c.get=function(a){return c[a]||null}},function(a,b,c){var d,e,f;(function(a){/**
	 * @license bytebuffer.js (c) 2015 Daniel Wirtz <dcode@dcode.io>
	 * Backing buffer: ArrayBuffer, Accessor: DataView
	 * Released under the Apache License, Version 2.0
	 * see: https://github.com/dcodeIO/bytebuffer.js for details
	 */
!function(g,h){c(122).amd?(e=[c(123)],d=h,void 0!==(f="function"==typeof d?d.apply(b,e):d)&&(a.exports=f)):"object"==typeof a&&a&&a.exports?a.exports=function(){var a;try{a=c(123)}catch(a){}return h(a)}():(g.dcodeIO=g.dcodeIO||{}).ByteBuffer=h(g.dcodeIO.Long)}(this,function(a){"use strict";function b(a){var b=0;return function(){return b<a.length?a.charCodeAt(b++):null}}function c(){var a=[],b=[];return function(){if(0===arguments.length)return b.join("")+g.apply(String,a);a.length+arguments.length>1024&&(b.push(g.apply(String,a)),a.length=0),Array.prototype.push.apply(a,arguments)}}var d=function(a,b,c){if(void 0===a&&(a=d.DEFAULT_CAPACITY),void 0===b&&(b=d.DEFAULT_ENDIAN),void 0===c&&(c=d.DEFAULT_NOASSERT),!c){if((a|=0)<0)throw RangeError("Illegal capacity");b=!!b,c=!!c}this.buffer=0===a?f:new ArrayBuffer(a),this.view=0===a?null:new DataView(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=a,this.littleEndian=b,this.noAssert=c};d.VERSION="5.0.1",d.LITTLE_ENDIAN=!0,d.BIG_ENDIAN=!1,d.DEFAULT_CAPACITY=16,d.DEFAULT_ENDIAN=d.BIG_ENDIAN,d.DEFAULT_NOASSERT=!1,d.Long=a||null;var e=d.prototype;e.__isByteBuffer__,Object.defineProperty(e,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var f=new ArrayBuffer(0),g=String.fromCharCode;d.accessor=function(){return DataView},d.allocate=function(a,b,c){return new d(a,b,c)},d.concat=function(a,b,c,e){"boolean"!=typeof b&&"string"==typeof b||(e=c,c=b,b=void 0);for(var f,g=0,h=0,i=a.length;h<i;++h)d.isByteBuffer(a[h])||(a[h]=d.wrap(a[h],b)),(f=a[h].limit-a[h].offset)>0&&(g+=f);if(0===g)return new d(0,c,e);var j,k=new d(g,c,e),l=new Uint8Array(k.buffer);for(h=0;h<i;)j=a[h++],(f=j.limit-j.offset)<=0||(l.set(new Uint8Array(j.buffer).subarray(j.offset,j.limit),k.offset),k.offset+=f);return k.limit=k.offset,k.offset=0,k},d.isByteBuffer=function(a){return!0===(a&&a.__isByteBuffer__)},d.type=function(){return ArrayBuffer},d.wrap=function(a,b,c,f){if("string"!=typeof b&&(f=c,c=b,b=void 0),"string"==typeof a)switch(void 0===b&&(b="utf8"),b){case"base64":return d.fromBase64(a,c);case"hex":return d.fromHex(a,c);case"binary":return d.fromBinary(a,c);case"utf8":return d.fromUTF8(a,c);case"debug":return d.fromDebug(a,c);default:throw Error("Unsupported encoding: "+b)}if(null===a||"object"!=typeof a)throw TypeError("Illegal buffer");var g;if(d.isByteBuffer(a))return g=e.clone.call(a),g.markedOffset=-1,g;if(a instanceof Uint8Array)g=new d(0,c,f),a.length>0&&(g.buffer=a.buffer,g.offset=a.byteOffset,g.limit=a.byteOffset+a.byteLength,g.view=new DataView(a.buffer));else if(a instanceof ArrayBuffer)g=new d(0,c,f),a.byteLength>0&&(g.buffer=a,g.offset=0,g.limit=a.byteLength,g.view=a.byteLength>0?new DataView(a):null);else{if("[object Array]"!==Object.prototype.toString.call(a))throw TypeError("Illegal buffer");g=new d(a.length,c,f),g.limit=a.length;for(var h=0;h<a.length;++h)g.view.setUint8(h,a[h])}return g},e.writeBitSet=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if(!(a instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}var d,e=b,f=a.length,g=f>>3,h=0;for(b+=this.writeVarint32(f,b);g--;)d=1&!!a[h++]|(1&!!a[h++])<<1|(1&!!a[h++])<<2|(1&!!a[h++])<<3|(1&!!a[h++])<<4|(1&!!a[h++])<<5|(1&!!a[h++])<<6|(1&!!a[h++])<<7,this.writeByte(d,b++);if(h<f){var i=0;for(d=0;h<f;)d|=(1&!!a[h++])<<i++;this.writeByte(d,b++)}return c?(this.offset=b,this):b-e},e.readBitSet=function(a){var b=void 0===a;b&&(a=this.offset);var c,d=this.readVarint32(a),e=d.value,f=e>>3,g=0,h=[];for(a+=d.length;f--;)c=this.readByte(a++),h[g++]=!!(1&c),h[g++]=!!(2&c),h[g++]=!!(4&c),h[g++]=!!(8&c),h[g++]=!!(16&c),h[g++]=!!(32&c),h[g++]=!!(64&c),h[g++]=!!(128&c);if(g<e){var i=0;for(c=this.readByte(a++);g<e;)h[g++]=!!(c>>i++&1)}return b&&(this.offset=a),h},e.readBytes=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+a>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+"+a+") <= "+this.buffer.byteLength)}var d=this.slice(b,b+a);return c&&(this.offset+=a),d},e.writeBytes=e.append,e.writeInt8=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=1;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=1,this.view.setInt8(b,a),c&&(this.offset+=1),this},e.writeByte=e.writeInt8,e.readInt8=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var c=this.view.getInt8(a);return b&&(this.offset+=1),c},e.readByte=e.readInt8,e.writeUint8=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=1;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=1,this.view.setUint8(b,a),c&&(this.offset+=1),this},e.writeUInt8=e.writeUint8,e.readUint8=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var c=this.view.getUint8(a);return b&&(this.offset+=1),c},e.readUInt8=e.readUint8,e.writeInt16=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=2;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=2,this.view.setInt16(b,a,this.littleEndian),c&&(this.offset+=2),this},e.writeShort=e.writeInt16,e.readInt16=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+2) <= "+this.buffer.byteLength)}var c=this.view.getInt16(a,this.littleEndian);return b&&(this.offset+=2),c},e.readShort=e.readInt16,e.writeUint16=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=2;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=2,this.view.setUint16(b,a,this.littleEndian),c&&(this.offset+=2),this},e.writeUInt16=e.writeUint16,e.readUint16=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+2) <= "+this.buffer.byteLength)}var c=this.view.getUint16(a,this.littleEndian);return b&&(this.offset+=2),c},e.readUInt16=e.readUint16,e.writeInt32=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=4;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=4,this.view.setInt32(b,a,this.littleEndian),c&&(this.offset+=4),this},e.writeInt=e.writeInt32,e.readInt32=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}var c=this.view.getInt32(a,this.littleEndian);return b&&(this.offset+=4),c},e.readInt=e.readInt32,e.writeUint32=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=4;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=4,this.view.setUint32(b,a,this.littleEndian),c&&(this.offset+=4),this},e.writeUInt32=e.writeUint32,e.readUint32=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}var c=this.view.getUint32(a,this.littleEndian);return b&&(this.offset+=4),c},e.readUInt32=e.readUint32,a&&(e.writeInt64=function(b,c){var d=void 0===c;if(d&&(c=this.offset),!this.noAssert){if("number"==typeof b)b=a.fromNumber(b);else if("string"==typeof b)b=a.fromString(b);else if(!(b&&b instanceof a))throw TypeError("Illegal value: "+b+" (not an integer or Long)");if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}"number"==typeof b?b=a.fromNumber(b):"string"==typeof b&&(b=a.fromString(b)),c+=8;var e=this.buffer.byteLength;return c>e&&this.resize((e*=2)>c?e:c),c-=8,this.littleEndian?(this.view.setInt32(c,b.low,!0),this.view.setInt32(c+4,b.high,!0)):(this.view.setInt32(c,b.high,!1),this.view.setInt32(c+4,b.low,!1)),d&&(this.offset+=8),this},e.writeLong=e.writeInt64,e.readInt64=function(b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+8) <= "+this.buffer.byteLength)}var d=this.littleEndian?new a(this.view.getInt32(b,!0),this.view.getInt32(b+4,!0),!1):new a(this.view.getInt32(b+4,!1),this.view.getInt32(b,!1),!1);return c&&(this.offset+=8),d},e.readLong=e.readInt64,e.writeUint64=function(b,c){var d=void 0===c;if(d&&(c=this.offset),!this.noAssert){if("number"==typeof b)b=a.fromNumber(b);else if("string"==typeof b)b=a.fromString(b);else if(!(b&&b instanceof a))throw TypeError("Illegal value: "+b+" (not an integer or Long)");if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}"number"==typeof b?b=a.fromNumber(b):"string"==typeof b&&(b=a.fromString(b)),c+=8;var e=this.buffer.byteLength;return c>e&&this.resize((e*=2)>c?e:c),c-=8,this.littleEndian?(this.view.setInt32(c,b.low,!0),this.view.setInt32(c+4,b.high,!0)):(this.view.setInt32(c,b.high,!1),this.view.setInt32(c+4,b.low,!1)),d&&(this.offset+=8),this},e.writeUInt64=e.writeUint64,e.readUint64=function(b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+8) <= "+this.buffer.byteLength)}var d=this.littleEndian?new a(this.view.getInt32(b,!0),this.view.getInt32(b+4,!0),!0):new a(this.view.getInt32(b+4,!1),this.view.getInt32(b,!1),!0);return c&&(this.offset+=8),d},e.readUInt64=e.readUint64),e.writeFloat32=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a)throw TypeError("Illegal value: "+a+" (not a number)");if("number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=4;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=4,this.view.setFloat32(b,a,this.littleEndian),c&&(this.offset+=4),this},e.writeFloat=e.writeFloat32,e.readFloat32=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}var c=this.view.getFloat32(a,this.littleEndian);return b&&(this.offset+=4),c},e.readFloat=e.readFloat32,e.writeFloat64=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a)throw TypeError("Illegal value: "+a+" (not a number)");if("number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}b+=8;var d=this.buffer.byteLength;return b>d&&this.resize((d*=2)>b?d:b),b-=8,this.view.setFloat64(b,a,this.littleEndian),c&&(this.offset+=8),this},e.writeDouble=e.writeFloat64,e.readFloat64=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+8) <= "+this.buffer.byteLength)}var c=this.view.getFloat64(a,this.littleEndian);return b&&(this.offset+=8),c},e.readDouble=e.readFloat64,d.MAX_VARINT32_BYTES=5,d.calculateVarint32=function(a){return a>>>=0,a<128?1:a<16384?2:a<1<<21?3:a<1<<28?4:5},d.zigZagEncode32=function(a){return((a|=0)<<1^a>>31)>>>0},d.zigZagDecode32=function(a){return a>>>1^-(1&a)|0},e.writeVarint32=function(a,b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+0) <= "+this.buffer.byteLength)}var e,f=d.calculateVarint32(a);b+=f;var g=this.buffer.byteLength;for(b>g&&this.resize((g*=2)>b?g:b),b-=f,a>>>=0;a>=128;)e=127&a|128,this.view.setUint8(b++,e),a>>>=7;return this.view.setUint8(b++,a),c?(this.offset=b,this):f},e.writeVarint32ZigZag=function(a,b){return this.writeVarint32(d.zigZagEncode32(a),b)},e.readVarint32=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var c,d=0,e=0;do{if(!this.noAssert&&a>this.limit){var f=Error("Truncated");throw f.truncated=!0,f}c=this.view.getUint8(a++),d<5&&(e|=(127&c)<<7*d),++d}while(0!=(128&c));return e|=0,b?(this.offset=a,e):{value:e,length:d}},e.readVarint32ZigZag=function(a){var b=this.readVarint32(a);return"object"==typeof b?b.value=d.zigZagDecode32(b.value):b=d.zigZagDecode32(b),b},a&&(d.MAX_VARINT64_BYTES=10,d.calculateVarint64=function(b){"number"==typeof b?b=a.fromNumber(b):"string"==typeof b&&(b=a.fromString(b));var c=b.toInt()>>>0,d=b.shiftRightUnsigned(28).toInt()>>>0,e=b.shiftRightUnsigned(56).toInt()>>>0;return 0==e?0==d?c<16384?c<128?1:2:c<1<<21?3:4:d<16384?d<128?5:6:d<1<<21?7:8:e<128?9:10},d.zigZagEncode64=function(b){return"number"==typeof b?b=a.fromNumber(b,!1):"string"==typeof b?b=a.fromString(b,!1):!1!==b.unsigned&&(b=b.toSigned()),b.shiftLeft(1).xor(b.shiftRight(63)).toUnsigned()},d.zigZagDecode64=function(b){return"number"==typeof b?b=a.fromNumber(b,!1):"string"==typeof b?b=a.fromString(b,!1):!1!==b.unsigned&&(b=b.toSigned()),b.shiftRightUnsigned(1).xor(b.and(a.ONE).toSigned().negate()).toSigned()},e.writeVarint64=function(b,c){var e=void 0===c;if(e&&(c=this.offset),!this.noAssert){if("number"==typeof b)b=a.fromNumber(b);else if("string"==typeof b)b=a.fromString(b);else if(!(b&&b instanceof a))throw TypeError("Illegal value: "+b+" (not an integer or Long)");if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}"number"==typeof b?b=a.fromNumber(b,!1):"string"==typeof b?b=a.fromString(b,!1):!1!==b.unsigned&&(b=b.toSigned());var f=d.calculateVarint64(b),g=b.toInt()>>>0,h=b.shiftRightUnsigned(28).toInt()>>>0,i=b.shiftRightUnsigned(56).toInt()>>>0;c+=f;var j=this.buffer.byteLength;switch(c>j&&this.resize((j*=2)>c?j:c),c-=f,f){case 10:this.view.setUint8(c+9,i>>>7&1);case 9:this.view.setUint8(c+8,9!==f?128|i:127&i);case 8:this.view.setUint8(c+7,8!==f?h>>>21|128:h>>>21&127);case 7:this.view.setUint8(c+6,7!==f?h>>>14|128:h>>>14&127);case 6:this.view.setUint8(c+5,6!==f?h>>>7|128:h>>>7&127);case 5:this.view.setUint8(c+4,5!==f?128|h:127&h);case 4:this.view.setUint8(c+3,4!==f?g>>>21|128:g>>>21&127);case 3:this.view.setUint8(c+2,3!==f?g>>>14|128:g>>>14&127);case 2:this.view.setUint8(c+1,2!==f?g>>>7|128:g>>>7&127);case 1:this.view.setUint8(c,1!==f?128|g:127&g)}return e?(this.offset+=f,this):f},e.writeVarint64ZigZag=function(a,b){return this.writeVarint64(d.zigZagEncode64(a),b)},e.readVarint64=function(b){var c=void 0===b;if(c&&(b=this.offset),!this.noAssert){if("number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: "+b+" (not an integer)");if((b>>>=0)<0||b+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+b+" (+1) <= "+this.buffer.byteLength)}var d=b,e=0,f=0,g=0,h=0;if(h=this.view.getUint8(b++),e=127&h,128&h&&(h=this.view.getUint8(b++),e|=(127&h)<<7,128&h&&(h=this.view.getUint8(b++),e|=(127&h)<<14,128&h&&(h=this.view.getUint8(b++),e|=(127&h)<<21,128&h&&(h=this.view.getUint8(b++),f=127&h,128&h&&(h=this.view.getUint8(b++),f|=(127&h)<<7,128&h&&(h=this.view.getUint8(b++),f|=(127&h)<<14,128&h&&(h=this.view.getUint8(b++),f|=(127&h)<<21,128&h&&(h=this.view.getUint8(b++),g=127&h,128&h&&(h=this.view.getUint8(b++),g|=(127&h)<<7,128&h))))))))))throw Error("Buffer overrun");var i=a.fromBits(e|f<<28,f>>>4|g<<24,!1);return c?(this.offset=b,i):{value:i,length:b-d}},e.readVarint64ZigZag=function(b){var c=this.readVarint64(b);return c&&c.value instanceof a?c.value=d.zigZagDecode64(c.value):c=d.zigZagDecode64(c),c}),e.writeCString=function(a,c){var d=void 0===c;d&&(c=this.offset);var e,f=a.length;if(!this.noAssert){if("string"!=typeof a)throw TypeError("Illegal str: Not a string");for(e=0;e<f;++e)if(0===a.charCodeAt(e))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}f=i.calculateUTF16asUTF8(b(a))[1],c+=f+1;var g=this.buffer.byteLength;return c>g&&this.resize((g*=2)>c?g:c),c-=f+1,i.encodeUTF16toUTF8(b(a),function(a){this.view.setUint8(c++,a)}.bind(this)),this.view.setUint8(c++,0),d?(this.offset=c,this):f},e.readCString=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var d,e=a,f=-1;return i.decodeUTF8toUTF16(function(){if(0===f)return null;if(a>=this.limit)throw RangeError("Illegal range: Truncated data, "+a+" < "+this.limit);return f=this.view.getUint8(a++),0===f?null:f}.bind(this),d=c(),!0),b?(this.offset=a,d()):{string:d(),length:a-e}},e.writeIString=function(a,c){var d=void 0===c;if(d&&(c=this.offset),!this.noAssert){if("string"!=typeof a)throw TypeError("Illegal str: Not a string");if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}var e,f=c;e=i.calculateUTF16asUTF8(b(a),this.noAssert)[1],c+=4+e;var g=this.buffer.byteLength;if(c>g&&this.resize((g*=2)>c?g:c),c-=4+e,this.view.setUint32(c,e,this.littleEndian),c+=4,i.encodeUTF16toUTF8(b(a),function(a){this.view.setUint8(c++,a)}.bind(this)),c!==f+4+e)throw RangeError("Illegal range: Truncated data, "+c+" == "+(c+4+e));return d?(this.offset=c,this):c-f},e.readIString=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+4) <= "+this.buffer.byteLength)}var c=a,e=this.readUint32(a),f=this.readUTF8String(e,d.METRICS_BYTES,a+=4);return a+=f.length,b?(this.offset=a,f.string):{string:f.string,length:a-c}},d.METRICS_CHARS="c",d.METRICS_BYTES="b",e.writeUTF8String=function(a,c){var d=void 0===c;if(d&&(c=this.offset),!this.noAssert){if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}var e,f=c;e=i.calculateUTF16asUTF8(b(a))[1],c+=e;var g=this.buffer.byteLength;return c>g&&this.resize((g*=2)>c?g:c),c-=e,i.encodeUTF16toUTF8(b(a),function(a){this.view.setUint8(c++,a)}.bind(this)),d?(this.offset=c,this):c-f},e.writeString=e.writeUTF8String,d.calculateUTF8Chars=function(a){return i.calculateUTF16asUTF8(b(a))[0]},d.calculateUTF8Bytes=function(a){return i.calculateUTF16asUTF8(b(a))[1]},d.calculateString=d.calculateUTF8Bytes,e.readUTF8String=function(a,b,e){"number"==typeof b&&(e=b,b=void 0);var f=void 0===e;if(f&&(e=this.offset),void 0===b&&(b=d.METRICS_CHARS),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal length: "+a+" (not an integer)");if(a|=0,"number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}var g,h=0,j=e;if(b===d.METRICS_CHARS){if(g=c(),i.decodeUTF8(function(){return h<a&&e<this.limit?this.view.getUint8(e++):null}.bind(this),function(a){++h,i.UTF8toUTF16(a,g)}),h!==a)throw RangeError("Illegal range: Truncated data, "+h+" == "+a);return f?(this.offset=e,g()):{string:g(),length:e-j}}if(b===d.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+a>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+"+a+") <= "+this.buffer.byteLength)}var k=e+a;if(i.decodeUTF8toUTF16(function(){return e<k?this.view.getUint8(e++):null}.bind(this),g=c(),this.noAssert),e!==k)throw RangeError("Illegal range: Truncated data, "+e+" == "+k);return f?(this.offset=e,g()):{string:g(),length:e-j}}throw TypeError("Unsupported metrics: "+b)},e.readString=e.readUTF8String,e.writeVString=function(a,c){var e=void 0===c;if(e&&(c=this.offset),!this.noAssert){if("string"!=typeof a)throw TypeError("Illegal str: Not a string");if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}var f,g,h=c;f=i.calculateUTF16asUTF8(b(a),this.noAssert)[1],g=d.calculateVarint32(f),c+=g+f;var j=this.buffer.byteLength;if(c>j&&this.resize((j*=2)>c?j:c),c-=g+f,c+=this.writeVarint32(f,c),i.encodeUTF16toUTF8(b(a),function(a){this.view.setUint8(c++,a)}.bind(this)),c!==h+f+g)throw RangeError("Illegal range: Truncated data, "+c+" == "+(c+f+g));return e?(this.offset=c,this):c-h},e.readVString=function(a){var b=void 0===a;if(b&&(a=this.offset),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+1) <= "+this.buffer.byteLength)}var c=a,e=this.readVarint32(a),f=this.readUTF8String(e.value,d.METRICS_BYTES,a+=e.length);return a+=f.length,b?(this.offset=a,f.string):{string:f.string,length:a-c}},e.append=function(a,b,c){"number"!=typeof b&&"string"==typeof b||(c=b,b=void 0);var e=void 0===c;if(e&&(c=this.offset),!this.noAssert){if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}a instanceof d||(a=d.wrap(a,b));var f=a.limit-a.offset;if(f<=0)return this;c+=f;var g=this.buffer.byteLength;return c>g&&this.resize((g*=2)>c?g:c),c-=f,new Uint8Array(this.buffer,c).set(new Uint8Array(a.buffer).subarray(a.offset,a.limit)),a.offset+=f,e&&(this.offset+=f),this},e.appendTo=function(a,b){return a.append(this,b),this},e.assert=function(a){return this.noAssert=!a,this},e.capacity=function(){return this.buffer.byteLength},e.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},e.clone=function(a){var b=new d(0,this.littleEndian,this.noAssert);return a?(b.buffer=new ArrayBuffer(this.buffer.byteLength),new Uint8Array(b.buffer).set(this.buffer),b.view=new DataView(b.buffer)):(b.buffer=this.buffer,b.view=this.view),b.offset=this.offset,b.markedOffset=this.markedOffset,b.limit=this.limit,b},e.compact=function(a,b){if(void 0===a&&(a=this.offset),void 0===b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,a<0||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}if(0===a&&b===this.buffer.byteLength)return this;var c=b-a;if(0===c)return this.buffer=f,this.view=null,this.markedOffset>=0&&(this.markedOffset-=a),this.offset=0,this.limit=0,this;var d=new ArrayBuffer(c);return new Uint8Array(d).set(new Uint8Array(this.buffer).subarray(a,b)),this.buffer=d,this.view=new DataView(d),this.markedOffset>=0&&(this.markedOffset-=a),this.offset=0,this.limit=c,this},e.copy=function(a,b){if(void 0===a&&(a=this.offset),void 0===b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,a<0||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}if(a===b)return new d(0,this.littleEndian,this.noAssert);var c=b-a,e=new d(c,this.littleEndian,this.noAssert);return e.offset=0,e.limit=c,e.markedOffset>=0&&(e.markedOffset-=a),this.copyTo(e,0,a,b),e},e.copyTo=function(a,b,c,e){var f,g;if(!this.noAssert&&!d.isByteBuffer(a))throw TypeError("Illegal target: Not a ByteBuffer");if(b=(g=void 0===b)?a.offset:0|b,c=(f=void 0===c)?this.offset:0|c,e=void 0===e?this.limit:0|e,b<0||b>a.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+b+" <= "+a.buffer.byteLength);if(c<0||e>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+c+" <= "+this.buffer.byteLength);var h=e-c;return 0===h?a:(a.ensureCapacity(b+h),new Uint8Array(a.buffer).set(new Uint8Array(this.buffer).subarray(c,e),b),f&&(this.offset+=h),g&&(a.offset+=h),this)},e.ensureCapacity=function(a){var b=this.buffer.byteLength;return b<a?this.resize((b*=2)>a?b:a):this},e.fill=function(a,b,c){var d=void 0===b;if(d&&(b=this.offset),"string"==typeof a&&a.length>0&&(a=a.charCodeAt(0)),void 0===b&&(b=this.offset),void 0===c&&(c=this.limit),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal value: "+a+" (not an integer)");if(a|=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal begin: Not an integer");if(b>>>=0,"number"!=typeof c||c%1!=0)throw TypeError("Illegal end: Not an integer");if(c>>>=0,b<0||b>c||c>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+b+" <= "+c+" <= "+this.buffer.byteLength)}if(b>=c)return this;for(;b<c;)this.view.setUint8(b++,a);return d&&(this.offset=b),this},e.flip=function(){return this.limit=this.offset,this.offset=0,this},e.mark=function(a){if(a=void 0===a?this.offset:a,!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal offset: "+a+" (not an integer)");if((a>>>=0)<0||a+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+a+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=a,this},e.order=function(a){if(!this.noAssert&&"boolean"!=typeof a)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!a,this},e.LE=function(a){return this.littleEndian=void 0===a||!!a,this},e.BE=function(a){return this.littleEndian=void 0!==a&&!a,this},e.prepend=function(a,b,c){"number"!=typeof b&&"string"==typeof b||(c=b,b=void 0);var e=void 0===c;if(e&&(c=this.offset),!this.noAssert){if("number"!=typeof c||c%1!=0)throw TypeError("Illegal offset: "+c+" (not an integer)");if((c>>>=0)<0||c+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+c+" (+0) <= "+this.buffer.byteLength)}a instanceof d||(a=d.wrap(a,b));var f=a.limit-a.offset;if(f<=0)return this;var g=f-c;if(g>0){var h=new ArrayBuffer(this.buffer.byteLength+g),i=new Uint8Array(h);i.set(new Uint8Array(this.buffer).subarray(c,this.buffer.byteLength),f),this.buffer=h,this.view=new DataView(h),this.offset+=g,this.markedOffset>=0&&(this.markedOffset+=g),this.limit+=g,c+=g}else var i=new Uint8Array(this.buffer);return i.set(new Uint8Array(a.buffer).subarray(a.offset,a.limit),c-f),a.offset=a.limit,e&&(this.offset-=f),this},e.prependTo=function(a,b){return a.prepend(this,b),this},e.printDebug=function(a){"function"!=typeof a&&(a=console.log.bind(console)),a(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},e.remaining=function(){return this.limit-this.offset},e.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},e.resize=function(a){if(!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal capacity: "+a+" (not an integer)");if((a|=0)<0)throw RangeError("Illegal capacity: 0 <= "+a)}if(this.buffer.byteLength<a){var b=new ArrayBuffer(a);new Uint8Array(b).set(new Uint8Array(this.buffer)),this.buffer=b,this.view=new DataView(b)}return this},e.reverse=function(a,b){if(void 0===a&&(a=this.offset),void 0===b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,a<0||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}return a===b?this:(Array.prototype.reverse.call(new Uint8Array(this.buffer).subarray(a,b)),this.view=new DataView(this.buffer),this)},e.skip=function(a){if(!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal length: "+a+" (not an integer)");a|=0}var b=this.offset+a
;if(!this.noAssert&&(b<0||b>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+a+" <= "+this.buffer.byteLength);return this.offset=b,this},e.slice=function(a,b){if(void 0===a&&(a=this.offset),void 0===b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,a<0||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}var c=this.clone();return c.offset=a,c.limit=b,c},e.toBuffer=function(a){var b=this.offset,c=this.limit;if(!this.noAssert){if("number"!=typeof b||b%1!=0)throw TypeError("Illegal offset: Not an integer");if(b>>>=0,"number"!=typeof c||c%1!=0)throw TypeError("Illegal limit: Not an integer");if(c>>>=0,b<0||b>c||c>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+b+" <= "+c+" <= "+this.buffer.byteLength)}if(!a&&0===b&&c===this.buffer.byteLength)return this.buffer;if(b===c)return f;var d=new ArrayBuffer(c-b);return new Uint8Array(d).set(new Uint8Array(this.buffer).subarray(b,c),0),d},e.toArrayBuffer=e.toBuffer,e.toString=function(a,b,c){if(void 0===a)return"ByteBufferAB_DataView(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof a&&(a="utf8",b=a,c=b),a){case"utf8":return this.toUTF8(b,c);case"base64":return this.toBase64(b,c);case"hex":return this.toHex(b,c);case"binary":return this.toBinary(b,c);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+a)}};var h=function(){for(var a={},b=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],c=[],d=0,e=b.length;d<e;++d)c[b[d]]=d;return a.encode=function(a,c){for(var d,e;null!==(d=a());)c(b[d>>2&63]),e=(3&d)<<4,null!==(d=a())?(e|=d>>4&15,c(b[63&(e|d>>4&15)]),e=(15&d)<<2,null!==(d=a())?(c(b[63&(e|d>>6&3)]),c(b[63&d])):(c(b[63&e]),c(61))):(c(b[63&e]),c(61),c(61))},a.decode=function(a,b){function d(a){throw Error("Illegal character code: "+a)}for(var e,f,g;null!==(e=a());)if(f=c[e],void 0===f&&d(e),null!==(e=a())&&(g=c[e],void 0===g&&d(e),b(f<<2>>>0|(48&g)>>4),null!==(e=a()))){if(void 0===(f=c[e])){if(61===e)break;d(e)}if(b((15&g)<<4>>>0|(60&f)>>2),null!==(e=a())){if(void 0===(g=c[e])){if(61===e)break;d(e)}b((3&f)<<6>>>0|g)}}},a.test=function(a){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(a)},a}();e.toBase64=function(a,b){if(void 0===a&&(a=this.offset),void 0===b&&(b=this.limit),a|=0,b|=0,a<0||b>this.capacity||a>b)throw RangeError("begin, end");var d;return h.encode(function(){return a<b?this.view.getUint8(a++):null}.bind(this),d=c()),d()},d.fromBase64=function(a,c){if("string"!=typeof a)throw TypeError("str");var e=new d(a.length/4*3,c),f=0;return h.decode(b(a),function(a){e.view.setUint8(f++,a)}),e.limit=f,e},d.btoa=function(a){return d.fromBinary(a).toBase64()},d.atob=function(a){return d.fromBase64(a).toBinary()},e.toBinary=function(a,b){if(void 0===a&&(a=this.offset),void 0===b&&(b=this.limit),a|=0,b|=0,a<0||b>this.capacity()||a>b)throw RangeError("begin, end");if(a===b)return"";for(var c=[],d=[];a<b;)c.push(this.view.getUint8(a++)),c.length>=1024&&(d.push(String.fromCharCode.apply(String,c)),c=[]);return d.join("")+String.fromCharCode.apply(String,c)},d.fromBinary=function(a,b){if("string"!=typeof a)throw TypeError("str");for(var c,e=0,f=a.length,g=new d(f,b);e<f;){if((c=a.charCodeAt(e))>255)throw RangeError("illegal char code: "+c);g.view.setUint8(e++,c)}return g.limit=f,g},e.toDebug=function(a){for(var b,c=-1,d=this.buffer.byteLength,e="",f="",g="";c<d;){if(-1!==c&&(b=this.view.getUint8(c),e+=b<16?"0"+b.toString(16).toUpperCase():b.toString(16).toUpperCase(),a&&(f+=b>32&&b<127?String.fromCharCode(b):".")),++c,a&&c>0&&c%16==0&&c!==d){for(;e.length<51;)e+=" ";g+=e+f+"\n",e=f=""}c===this.offset&&c===this.limit?e+=c===this.markedOffset?"!":"|":c===this.offset?e+=c===this.markedOffset?"[":"<":c===this.limit?e+=c===this.markedOffset?"]":">":e+=c===this.markedOffset?"'":a||0!==c&&c!==d?" ":""}if(a&&" "!==e){for(;e.length<51;)e+=" ";g+=e+f+"\n"}return a?g:e},d.fromDebug=function(a,b,c){for(var e,f,g=a.length,h=new d((g+1)/3|0,b,c),i=0,j=0,k=!1,l=!1,m=!1,n=!1,o=!1;i<g;){switch(e=a.charAt(i++)){case"!":if(!c){if(l||m||n){o=!0;break}l=m=n=!0}h.offset=h.markedOffset=h.limit=j,k=!1;break;case"|":if(!c){if(l||n){o=!0;break}l=n=!0}h.offset=h.limit=j,k=!1;break;case"[":if(!c){if(l||m){o=!0;break}l=m=!0}h.offset=h.markedOffset=j,k=!1;break;case"<":if(!c){if(l){o=!0;break}l=!0}h.offset=j,k=!1;break;case"]":if(!c){if(n||m){o=!0;break}n=m=!0}h.limit=h.markedOffset=j,k=!1;break;case">":if(!c){if(n){o=!0;break}n=!0}h.limit=j,k=!1;break;case"'":if(!c){if(m){o=!0;break}m=!0}h.markedOffset=j,k=!1;break;case" ":k=!1;break;default:if(!c&&k){o=!0;break}if(f=parseInt(e+a.charAt(i++),16),!c&&(isNaN(f)||f<0||f>255))throw TypeError("Illegal str: Not a debug encoded string");h.view.setUint8(j++,f),k=!0}if(o)throw TypeError("Illegal str: Invalid symbol at "+i)}if(!c){if(!l||!n)throw TypeError("Illegal str: Missing offset or limit");if(j<h.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+j+" < "+g)}return h},e.toHex=function(a,b){if(a=void 0===a?this.offset:a,b=void 0===b?this.limit:b,!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,a<0||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}for(var c,d=new Array(b-a);a<b;)c=this.view.getUint8(a++),c<16?d.push("0",c.toString(16)):d.push(c.toString(16));return d.join("")},d.fromHex=function(a,b,c){if(!c){if("string"!=typeof a)throw TypeError("Illegal str: Not a string");if(a.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var e,f=a.length,g=new d(f/2|0,b),h=0,i=0;h<f;h+=2){if(e=parseInt(a.substring(h,h+2),16),!c&&(!isFinite(e)||e<0||e>255))throw TypeError("Illegal str: Contains non-hex characters");g.view.setUint8(i++,e)}return g.limit=i,g};var i=function(){var a={};return a.MAX_CODEPOINT=1114111,a.encodeUTF8=function(a,b){var c=null;for("number"==typeof a&&(c=a,a=function(){return null});null!==c||null!==(c=a());)c<128?b(127&c):c<2048?(b(c>>6&31|192),b(63&c|128)):c<65536?(b(c>>12&15|224),b(c>>6&63|128),b(63&c|128)):(b(c>>18&7|240),b(c>>12&63|128),b(c>>6&63|128),b(63&c|128)),c=null},a.decodeUTF8=function(a,b){for(var c,d,e,f,g=function(a){a=a.slice(0,a.indexOf(null));var b=Error(a.toString());throw b.name="TruncatedError",b.bytes=a,b};null!==(c=a());)if(0==(128&c))b(c);else if(192==(224&c))null===(d=a())&&g([c,d]),b((31&c)<<6|63&d);else if(224==(240&c))(null===(d=a())||null===(e=a()))&&g([c,d,e]),b((15&c)<<12|(63&d)<<6|63&e);else{if(240!=(248&c))throw RangeError("Illegal starting byte: "+c);(null===(d=a())||null===(e=a())||null===(f=a()))&&g([c,d,e,f]),b((7&c)<<18|(63&d)<<12|(63&e)<<6|63&f)}},a.UTF16toUTF8=function(a,b){for(var c,d=null;;){if(null===(c=null!==d?d:a()))break;c>=55296&&c<=57343&&null!==(d=a())&&d>=56320&&d<=57343?(b(1024*(c-55296)+d-56320+65536),d=null):b(c)}null!==d&&b(d)},a.UTF8toUTF16=function(a,b){var c=null;for("number"==typeof a&&(c=a,a=function(){return null});null!==c||null!==(c=a());)c<=65535?b(c):(c-=65536,b(55296+(c>>10)),b(c%1024+56320)),c=null},a.encodeUTF16toUTF8=function(b,c){a.UTF16toUTF8(b,function(b){a.encodeUTF8(b,c)})},a.decodeUTF8toUTF16=function(b,c){a.decodeUTF8(b,function(b){a.UTF8toUTF16(b,c)})},a.calculateCodePoint=function(a){return a<128?1:a<2048?2:a<65536?3:4},a.calculateUTF8=function(a){for(var b,c=0;null!==(b=a());)c+=b<128?1:b<2048?2:b<65536?3:4;return c},a.calculateUTF16asUTF8=function(b){var c=0,d=0;return a.UTF16toUTF8(b,function(a){++c,d+=a<128?1:a<2048?2:a<65536?3:4}),[c,d]},a}();return e.toUTF8=function(a,b){if(void 0===a&&(a=this.offset),void 0===b&&(b=this.limit),!this.noAssert){if("number"!=typeof a||a%1!=0)throw TypeError("Illegal begin: Not an integer");if(a>>>=0,"number"!=typeof b||b%1!=0)throw TypeError("Illegal end: Not an integer");if(b>>>=0,a<0||a>b||b>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+a+" <= "+b+" <= "+this.buffer.byteLength)}var d;try{i.decodeUTF8toUTF16(function(){return a<b?this.view.getUint8(a++):null}.bind(this),d=c())}catch(c){if(a!==b)throw RangeError("Illegal range: Truncated data, "+a+" != "+b)}return d()},d.fromUTF8=function(a,c,e){if(!e&&"string"!=typeof a)throw TypeError("Illegal str: Not a string");var f=new d(i.calculateUTF16asUTF8(b(a),!0)[1],c,e),g=0;return i.encodeUTF16toUTF8(b(a),function(a){f.view.setUint8(g++,a)}),f.limit=g,f},d})}).call(b,c(67)(a))},function(a,b){a.exports=function(){throw new Error("define cannot be used indirect")}},function(a,b,c){var d,e,f;(function(a){/**
	 * @license long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
	 * Released under the Apache License, Version 2.0
	 * see: https://github.com/dcodeIO/long.js for details
	 */
!function(g,h){c(122).amd?(e=[],d=h,void 0!==(f="function"==typeof d?d.apply(b,e):d)&&(a.exports=f)):"object"==typeof a&&a&&a.exports?a.exports=h():(g.dcodeIO=g.dcodeIO||{}).Long=h()}(this,function(){"use strict";function a(a,b,c){this.low=0|a,this.high=0|b,this.unsigned=!!c}function b(a){return!0===(a&&a.__isLong__)}function c(a,b){var c,d,f;return b?(a>>>=0,(f=0<=a&&a<256)&&(d=i[a])?d:(c=e(a,(0|a)<0?-1:0,!0),f&&(i[a]=c),c)):(a|=0,(f=-128<=a&&a<128)&&(d=h[a])?d:(c=e(a,a<0?-1:0,!1),f&&(h[a]=c),c))}function d(a,b){if(isNaN(a)||!isFinite(a))return b?p:o;if(b){if(a<0)return p;if(a>=l)return u}else{if(a<=-m)return v;if(a+1>=m)return t}return a<0?d(-a,b).neg():e(a%k|0,a/k|0,b)}function e(b,c,d){return new a(b,c,d)}function f(a,b,c){if(0===a.length)throw Error("empty string");if("NaN"===a||"Infinity"===a||"+Infinity"===a||"-Infinity"===a)return o;if("number"==typeof b?(c=b,b=!1):b=!!b,(c=c||10)<2||36<c)throw RangeError("radix");var e;if((e=a.indexOf("-"))>0)throw Error("interior hyphen");if(0===e)return f(a.substring(1),b,c).neg();for(var g=d(j(c,8)),h=o,i=0;i<a.length;i+=8){var k=Math.min(8,a.length-i),l=parseInt(a.substring(i,i+k),c);if(k<8){var m=d(j(c,k));h=h.mul(m).add(d(l))}else h=h.mul(g),h=h.add(d(l))}return h.unsigned=b,h}function g(b){return b instanceof a?b:"number"==typeof b?d(b):"string"==typeof b?f(b):e(b.low,b.high,b.unsigned)}a.prototype.__isLong__,Object.defineProperty(a.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),a.isLong=b;var h={},i={};a.fromInt=c,a.fromNumber=d,a.fromBits=e;var j=Math.pow;a.fromString=f,a.fromValue=g;var k=4294967296,l=k*k,m=l/2,n=c(1<<24),o=c(0);a.ZERO=o;var p=c(0,!0);a.UZERO=p;var q=c(1);a.ONE=q;var r=c(1,!0);a.UONE=r;var s=c(-1);a.NEG_ONE=s;var t=e(-1,2147483647,!1);a.MAX_VALUE=t;var u=e(-1,-1,!0);a.MAX_UNSIGNED_VALUE=u;var v=e(0,-2147483648,!1);a.MIN_VALUE=v;var w=a.prototype;return w.toInt=function(){return this.unsigned?this.low>>>0:this.low},w.toNumber=function(){return this.unsigned?(this.high>>>0)*k+(this.low>>>0):this.high*k+(this.low>>>0)},w.toString=function(a){if((a=a||10)<2||36<a)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(v)){var b=d(a),c=this.div(b),e=c.mul(b).sub(this);return c.toString(a)+e.toInt().toString(a)}return"-"+this.neg().toString(a)}for(var f=d(j(a,6),this.unsigned),g=this,h="";;){var i=g.div(f),k=g.sub(i.mul(f)).toInt()>>>0,l=k.toString(a);if(g=i,g.isZero())return l+h;for(;l.length<6;)l="0"+l;h=""+l+h}},w.getHighBits=function(){return this.high},w.getHighBitsUnsigned=function(){return this.high>>>0},w.getLowBits=function(){return this.low},w.getLowBitsUnsigned=function(){return this.low>>>0},w.getNumBitsAbs=function(){if(this.isNegative())return this.eq(v)?64:this.neg().getNumBitsAbs();for(var a=0!=this.high?this.high:this.low,b=31;b>0&&0==(a&1<<b);b--);return 0!=this.high?b+33:b+1},w.isZero=function(){return 0===this.high&&0===this.low},w.isNegative=function(){return!this.unsigned&&this.high<0},w.isPositive=function(){return this.unsigned||this.high>=0},w.isOdd=function(){return 1==(1&this.low)},w.isEven=function(){return 0==(1&this.low)},w.equals=function(a){return b(a)||(a=g(a)),(this.unsigned===a.unsigned||this.high>>>31!=1||a.high>>>31!=1)&&(this.high===a.high&&this.low===a.low)},w.eq=w.equals,w.notEquals=function(a){return!this.eq(a)},w.neq=w.notEquals,w.lessThan=function(a){return this.comp(a)<0},w.lt=w.lessThan,w.lessThanOrEqual=function(a){return this.comp(a)<=0},w.lte=w.lessThanOrEqual,w.greaterThan=function(a){return this.comp(a)>0},w.gt=w.greaterThan,w.greaterThanOrEqual=function(a){return this.comp(a)>=0},w.gte=w.greaterThanOrEqual,w.compare=function(a){if(b(a)||(a=g(a)),this.eq(a))return 0;var c=this.isNegative(),d=a.isNegative();return c&&!d?-1:!c&&d?1:this.unsigned?a.high>>>0>this.high>>>0||a.high===this.high&&a.low>>>0>this.low>>>0?-1:1:this.sub(a).isNegative()?-1:1},w.comp=w.compare,w.negate=function(){return!this.unsigned&&this.eq(v)?v:this.not().add(q)},w.neg=w.negate,w.add=function(a){b(a)||(a=g(a));var c=this.high>>>16,d=65535&this.high,f=this.low>>>16,h=65535&this.low,i=a.high>>>16,j=65535&a.high,k=a.low>>>16,l=65535&a.low,m=0,n=0,o=0,p=0;return p+=h+l,o+=p>>>16,p&=65535,o+=f+k,n+=o>>>16,o&=65535,n+=d+j,m+=n>>>16,n&=65535,m+=c+i,m&=65535,e(o<<16|p,m<<16|n,this.unsigned)},w.subtract=function(a){return b(a)||(a=g(a)),this.add(a.neg())},w.sub=w.subtract,w.multiply=function(a){if(this.isZero())return o;if(b(a)||(a=g(a)),a.isZero())return o;if(this.eq(v))return a.isOdd()?v:o;if(a.eq(v))return this.isOdd()?v:o;if(this.isNegative())return a.isNegative()?this.neg().mul(a.neg()):this.neg().mul(a).neg();if(a.isNegative())return this.mul(a.neg()).neg();if(this.lt(n)&&a.lt(n))return d(this.toNumber()*a.toNumber(),this.unsigned);var c=this.high>>>16,f=65535&this.high,h=this.low>>>16,i=65535&this.low,j=a.high>>>16,k=65535&a.high,l=a.low>>>16,m=65535&a.low,p=0,q=0,r=0,s=0;return s+=i*m,r+=s>>>16,s&=65535,r+=h*m,q+=r>>>16,r&=65535,r+=i*l,q+=r>>>16,r&=65535,q+=f*m,p+=q>>>16,q&=65535,q+=h*l,p+=q>>>16,q&=65535,q+=i*k,p+=q>>>16,q&=65535,p+=c*m+f*l+h*k+i*j,p&=65535,e(r<<16|s,p<<16|q,this.unsigned)},w.mul=w.multiply,w.divide=function(a){if(b(a)||(a=g(a)),a.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?p:o;var c,e,f;if(this.unsigned){if(a.unsigned||(a=a.toUnsigned()),a.gt(this))return p;if(a.gt(this.shru(1)))return r;f=p}else{if(this.eq(v)){if(a.eq(q)||a.eq(s))return v;if(a.eq(v))return q;return c=this.shr(1).div(a).shl(1),c.eq(o)?a.isNegative()?q:s:(e=this.sub(a.mul(c)),f=c.add(e.div(a)))}if(a.eq(v))return this.unsigned?p:o;if(this.isNegative())return a.isNegative()?this.neg().div(a.neg()):this.neg().div(a).neg();if(a.isNegative())return this.div(a.neg()).neg();f=o}for(e=this;e.gte(a);){c=Math.max(1,Math.floor(e.toNumber()/a.toNumber()));for(var h=Math.ceil(Math.log(c)/Math.LN2),i=h<=48?1:j(2,h-48),k=d(c),l=k.mul(a);l.isNegative()||l.gt(e);)c-=i,k=d(c,this.unsigned),l=k.mul(a);k.isZero()&&(k=q),f=f.add(k),e=e.sub(l)}return f},w.div=w.divide,w.modulo=function(a){return b(a)||(a=g(a)),this.sub(this.div(a).mul(a))},w.mod=w.modulo,w.not=function(){return e(~this.low,~this.high,this.unsigned)},w.and=function(a){return b(a)||(a=g(a)),e(this.low&a.low,this.high&a.high,this.unsigned)},w.or=function(a){return b(a)||(a=g(a)),e(this.low|a.low,this.high|a.high,this.unsigned)},w.xor=function(a){return b(a)||(a=g(a)),e(this.low^a.low,this.high^a.high,this.unsigned)},w.shiftLeft=function(a){return b(a)&&(a=a.toInt()),0==(a&=63)?this:a<32?e(this.low<<a,this.high<<a|this.low>>>32-a,this.unsigned):e(0,this.low<<a-32,this.unsigned)},w.shl=w.shiftLeft,w.shiftRight=function(a){return b(a)&&(a=a.toInt()),0==(a&=63)?this:a<32?e(this.low>>>a|this.high<<32-a,this.high>>a,this.unsigned):e(this.high>>a-32,this.high>=0?0:-1,this.unsigned)},w.shr=w.shiftRight,w.shiftRightUnsigned=function(a){if(b(a)&&(a=a.toInt()),0===(a&=63))return this;var c=this.high;if(a<32){return e(this.low>>>a|c<<32-a,c>>>a,this.unsigned)}return 32===a?e(c,0,this.unsigned):e(c>>>a-32,0,this.unsigned)},w.shru=w.shiftRightUnsigned,w.toSigned=function(){return this.unsigned?e(this.low,this.high,!1):this},w.toUnsigned=function(){return this.unsigned?this:e(this.low,this.high,!0)},w.toBytes=function(a){return a?this.toBytesLE():this.toBytesBE()},w.toBytesLE=function(){var a=this.high,b=this.low;return[255&b,b>>>8&255,b>>>16&255,b>>>24&255,255&a,a>>>8&255,a>>>16&255,a>>>24&255]},w.toBytesBE=function(){var a=this.high,b=this.low;return[a>>>24&255,a>>>16&255,a>>>8&255,255&a,b>>>24&255,b>>>16&255,b>>>8&255,255&b]},a})}).call(b,c(67)(a))}]);
//# sourceMappingURL=lmvworker.min.js.map